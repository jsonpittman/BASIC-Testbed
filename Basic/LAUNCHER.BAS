1 'LAUNCHER
2 'BY GEOFF FRIESEN
3 'COPYRIGHT (C) 1992
4 'BY FALSOFT, INC
5 'RAINBOW MAGAZINE
110 'INITIALIZE
115 '
120 CLEAR 2000
125 DIM BF$(67),SB$(1)
130 LC=1
135 RC=LC+30
140 TR=3
145 ON BRK GOTO 760
150 HBUFF 1,300
155 PALETTE 0,0
160 PALETTE 15,63
165 HCOLOR 15,0
170 HSCREEN 2
175 '
180 'READ BAS FILE NAMES
185 '
190 D=0: N=0
195 FOR S=3 TO 12
200 DSKI$ D,17,S,SB$(0),SB$(1)
205 P=1: SB=0
210 EN$=MID$(SB$(SB),P,11)
215 X$=LEFT$(EN$,1)
220 IF X$=CHR$(0) THEN 250
225 IF X$=CHR$(255) THEN 270
230 X$=MID$(EN$,9,3)
235 IF X$<>"BAS" THEN 250
240 BF$(N)=LEFT$(EN$,8)
245 N=N+1
250 P=P+32
255 IF P>97 THEN P=1: SB=SB+1
260 IF SB<2 THEN 210
265 GOTO 275
270 S=13
275 NEXT S
280 IF N<>0 THEN 315
285 WIDTH 32
290 PRINT "NO AVAILABLE FILES"
295 END
300 '
305 'SPEED UP & SORT FILENAMES
310 '
315 POKE &HFFD9,0
320 IF N=1 THEN 375
325 FOR P=0 TO N-2
330 FOR I=0 TO N-P-2
335 IF BF$(I)<=BF$(I+1) THEN 355
340 T$=BF$(I)
345 BF$(I)=BF$(I+1)
350 BF$(I+1)=T$
355 NEXT I,P
360 '
365 'DRAW SCREEN
370 '
375 HPRINT (16,0),"LAUNCHER"
380 HPRINT (0,23),"ENTER  H"
385 HPRINT (15,23),"ARROW KEYS"
390 HPRINT (32,23),"E  BREAK"
395 HLINE (0,9)-(319,181),PSET,B
400 '
405 'DISPLAY FILENAMES
410 '
415 C=LC: R=TR
420 FOR I=0 TO N-1
425 HPRINT (C,R),BF$(I)
430 C=C+10
435 IF C>RC THEN C=LC: R=R+1
440 NEXT I
445 '
450 'HILITE UPPER/LEFT FILENAME
455 '
460 CF=0
465 GOSUB 710
470 '
475 'MAIN LOOP
480 '
485 K$=INKEY$: IF K$="" THEN 485
490 IF K$=CHR$(8) THEN 535
495 IF K$=CHR$(9) THEN 575
500 IF K$="H" THEN 615
505 IF K$="E" THEN 650
510 IF K$=CHR$(13) THEN 685
515 GOTO 485
520 '
525 'LEFT
530 '
535 GOSUB 710
540 CF=CF-1
545 IF CF<0 THEN CF=N-1
550 GOSUB 710
555 GOTO 485
560 '
565 'RIGHT
570 '
575 GOSUB 710
580 CF=CF+1
585 IF CF=N THEN CF=0
590 GOSUB 710
595 GOTO 485
600 '
605 'HOME
610 '
615 GOSUB 710
620 CF=0
625 GOSUB 710
630 GOTO 485
635 '
640 'END
645 '
650 GOSUB 710
655 CF=N-1
660 GOSUB 710
665 GOTO 485
670 '
675 'ENTER (SLOWDOWN & LAUNCH)
680 '
685 POKE &HFFD8,0
690 LOAD BF$(CF),R
695 '
700 'HILITE/UNHILITE FILENAME
705 '
710 X1=(LC+(CF AND 3)*10)*8
715 X2=X1+7*8+7
720 Y1=(TR+INT(CF/4))*8
725 Y2=Y1+7
730 HGET (X1,Y1)-(X2,Y2),1
735 HPUT (X1,Y1)-(X2,Y2),1,NOT
740 RETURN
745 '
750 'ON BRK DESTINATION
755 '
760 WIDTH 32
765 POKE &HFFD8,0
