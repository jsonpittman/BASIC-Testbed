0 ON BRK GOTO 5000
10 POKE65497,0:CLS0:PRINT@99,"les";CHR$(128);"lutins";CHR$(128);"du";CHR$(128);"mont";CHR$(128);"rigaud";:PRINT@238,"par";:PRINT@329,"louis";CHR$(128);"parson";:PRINT@459,"(C) 1986";:FORX=1TO3000:NEXTX
12 PCLEAR2:CLEAR800:HSCREEN2
13 PALETTECMP
14 HCOLOR2,4
20 X=14:Y=15:DIML$(X+1):DIMLO$(Y+1):DIMO$(Y+1):DIMC$(22):DIMT(4,X+1):DIMC(27):DIMO(Y+1):DIMG$(Y+1)
70 DATA in the green woods,in the green woods,among the rocks,among the rocks,in the dead woods,in the dead woods
80 DATA in the dead woods,in a swamp,in the secret caves,in the green woods,among the rocks
90 DATA nowhere...,in the leprechaun's place,nowhere...
100 DATAan urn,WIND,7,butterfly wings,WINGS,2,...,*,9,a key,KEY,5,a parchment,PARCHMENT,3
110 DATAa mushroom,MUSHROOM,14,a shovel,SHOVEL,1,a tube,TUBE,4,a torch,TORCH,6,a box,BOX,10
120 DATAa strange boulder,*,11,...a swamp,*,4,...a swamp,*,5,signs on a tree,*,6,...a swamp,*,6
130 DATA 2,0,10,11
140 DATA4,1,5,3
150 DATA4,-7,2,0
160 DATA1000,2,-2,3
170 DATA1000,10,6,2
180 DATA1000,7,0,5
190 DATA6,0,0,10
200 DATA1000,1000,1000,1000
210 DATA-3,-4,0,-2
220 DATA5,0,7,1
230 DATA-7,0,1,0
240 DATA0,-1,-5,0
250 DATA0,1000,-6,0
260 DATA0,-3,0,-6
270 DATATAKE,1,GET,1,PUT,2,DROP,2,GO,3,LOOK,4,EXAM,4,READ,4,USE,5,GLUE,6,RUB,7,STRIKE,7,UNLOCK,8,OPEN,9,EAT,10,DIG,11,LIGHT,12,SWIM,13,FLY,14,PUSH,15,DRINK,16,INV,17
280 FORC=1TOX:READL$(C):NEXTC
290 FORC=1TOY:READLO$(C),O$(C),O(C):NEXTC
300 FORC=1TOX:READT(1,C),T(2,C),T(3,C),T(4,C):NEXTC
310 T$(1)="north":T$(2)="south":T$(3)="east":T$(4)="west"
320 N=22
330 FOR C=1 TO N:READC$(C),C(C):NEXTC
340 L=11
350 GOSUB3530
370 HCLS4:HCOLOR2,4
375 ON BRK GOTO5000
380 HCLS:ON L GOSUB1930,2400,2560,2630,2790,3000,3040,3090,3100,3160,3250,3330,3380,3460
390 FORC=1TOY:IFO(C)=L THEN GOSUB3530:HCOLOR4,4:HDRAWG$(C)
400 NEXTC
405 HCOLOR2,4
410 IFL=9ANDWM=1ANDO(9)=1000THENGOSUB3120
420 IFL=11ANDZA=1THENGOSUB3320
430 IFL=14ANDVL=1THENGOSUB3520LIST4620
440 N$="You are "+L$(L):HPRINT(2,13),N$
450 N$="Obvious exit(s): "
460 FORC=1TO4:IFT(C,L)>0THENN$=N$+T$(C)+" "
470 NEXTC
480 HPRINT(2,15),N$
490 N$="You see "
500 FORC=1TOY:IFO(C)=LTHENN$=N$+LO$(C)+" "
510 NEXTC
520 IFLEN(N$)<39THENGOTO550
530 IFLEN(N$)>38GOTO6100
550 IFN$="You see "THENN$="You see nothing interesting..."
560 HPRINT(2,17),N$:GOTO680
680 N$="And now? ":HPRINT(1,20),N$
690 HCOLOR1,4:HLINE(16,172)-(304,188),PSET,B:HCOLOR2,4:SOUND250,1
710 A$="":GOSUB1800
720 IFA$="CALM"ANDL=6ANDZE=1THENGOTO3670
730 IFZE=1ANDL=6ANDA$<>"CALM"THEN3580
740 FORC=1TOLEN(A$):IFMID$(A$,C,1)=" "THENA1$=LEFT$(A$,C-1):B$=MID$(A$,C+1,LEN(A$)-C):GOTO760ELSENEXTC
750 A1$=A$
760 FORC=1TO N
770 IF C$(C)=A1$ THEN A=C(C):GOTO800
780 NEXTC
790 N$="What...?":GOSUB3590:GOSUB3600:GOTO710
800 ON A GOTO810,890,950,1000,1200,1220,1240,1280,1300,1340,1360,1390,1410,1420,1440,1460,1480
810 IFB$="URN"THENB$="WIND"
820 IFB$="MATCHES"THENB$="BOX"
830 IFVV<4THEN840ELSEGOTO880
840 FORC=1TOY
850 IF B$=O$(C) AND O(C)=L AND O$(C)<>"*" THEN O(C)=1000:GOSUB3515:HDRAW G$(C):HCOLOR2,4:N$="Done...you have it!":VV=VV+1:GOSUB3590:GOSUB3600:GOSUB3620:GOTO490
860 NEXTC
870 N$="You can't!":GOSUB3590:GOSUB3600:GOTO710
880 N$="Your hands are full":GOSUB3590:GOSUB3600:GOTO710
890 IFB$="MATCHES"THENB$="BOX"
900 IFB$="URN"THENB$="WIND"
905 IFB$="TORCH"THENWM=0
907 IFB$="TORCH"ANDL=9THENHCOLOR8,4:GOSUB3120:HCOLOR2,4
910 FORC=1TOY
920 IF B$=O$(C) AND O(C)=1000 THEN O(C)=L:VV=VV-1:GOSUB3530:HCOLOR4,4:HDRAWG$(C):HCOLOR2,4:N$="done...!":GOSUB3590:GOSUB3600
930 NEXTC
940 GOSUB3620:GOTO490
950 IFB$="HOLE"ANDL=11ANDZA=1THENL=3:GOTO380
952 IFB$="NORTH"THENB$="north"
954 IFB$="SOUTH"THENB$="south"
956 IFB$="EAST"THENB$="east"
958 IFB$="WEST"THENB$="west"
960 FORC=1TO4:IFB$=T$(C)THENDR=C:GOTO980
970 NEXTC:GOTO710
980 IFT(DR,L)>0THENL=T(DR,L):IFL=1000THEN N$="You are sinking...too bad.":GOSUB3590:GOTO3140
990 GOTO370
1000 IFA$=A1$THENGOSUB3630:GOTO380
1020 IFB$="WIND"THENB$="URN"
1030 IFB$="BOX"THENB$="MATCHES"
1040 IFB$="URN"ANDO(1)=1000THENN$="It is pressurized wind":GOSUB3590:GOSUB3600:GOTO710
1050 IFB$="RING"ANDO(3)=1000THENN$="a gold ring...magic?":GOSUB3590:GOSUB3600:GOTO710
1060 IFB$="WINGS"ANDO(2)=1000THENN$="Huge...and very strong":GOSUB3590:GOSUB3600:GOTO710
1070 IFB$="KEY"ANDO(4)=1000THENN$="Made of silver...precious.":GOSUB3590:GOSUB3600:GOTO710
1080 IFB$="PARCHMENT"ANDO(5)=1000THENN$="...With calm you will succeed...":GOSUB3590:GOSUB3600:GOTO710
1090 IFB$="MUSHROOM"ANDO(6)=1000THENN$="Bizarre...might be edible":GOSUB3590:GOSUB3600:GOTO710
1100 IFB$="SHOVEL"ANDO(7)=1000THENN$="Made of steel with a wood handle":GOSUB3590:GOSUB3600:GOTO710
1110 IFB$="TUBE"ANDO(8)=1000THENN$="Looks like strong glue":GOSUB3590:GOSUB3600:GOTO710
1120 IFB$="TORCH"ANDO(9)=1000ANDWM<>1THENN$="Of resin...actually off":GOSUB3590:GOSUB3600:GOTO710
1130 IFB$="TORCH"ANDWM=1THENN$="...it is aflame.":GOSUB3590:GOSUB3600:GOTO710
1140 IFB$="MATCHES"ANDO(10)=1000THENN$="...matches, dry and well preserved.":GOSUB3590:GOSUB3600:GOTO710
1150 IFB$="HOLE"ANDL=11THENN$="Big enough for you to enter...":GOSUB3590:GOSUB3600:GOTO710
1160 IFB$="BOULDER"ANDL=11THENN$="seems a little unstable.":GOSUB3590:GOSUB3600:GOTO710
1170 IFB$="TREE"THENB$="SIGNS"
1180 IFB$="SIGNS"ANDL=6ANDO(5)=1000THENN$="The password ?":GOSUB3590:FORX=1TO600:NEXTX:GOSUB3600:ZE=1:GOTO710
1190 N$="You don't have it.":GOSUB3590:GOSUB3600:GOTO710
1200 IFB$="WIND"ANDO(1)=1000ANDVG=1ANDL=4THEN N$="You are flying over the swamp.":GOSUB3590:GOSUB3600:GOSUB3150:L=14:GOTO380
1210 N$="  Nothing to do...":GOSUB3590:GOSUB3600:GOTO710
1220 IFB$="WINGS"ANDO(2)=1000ANDO(8)=1000ANDVK=1THEN N$="  done !":VG=1:GOSUB3590:GOSUB3600:GOTO710
1230 N$="  Nothing to do":GOSUB3590:GOSUB3600:GOTO710
1240 IFB$="MATCH"ANDO(10)=1000THENN$=" It is lit.":VH=1:GOSUB3590:GOSUB3600:GOTO710
1250 IFB$="RING"ANDO(3)=1000ANDL=14THENN$="  There is now a way...":VL=1:GOSUB3590:GOSUB3600
1260 IFVL=1THENT(4,14)=12:T(1,12)=14:GOSUB3520:GOSUB3640:GOTO450
1270 N$=" Nothing to do":GOSUB3590:GOSUB3600:GOTO710
1280 IFB$="DOOR"ANDL=9ANDO(4)=1000ANDWM=1THENN$="It is unlocked.":VJ=1:GOSUB3590:GOSUB3600:GOTO710
1290 N$="Impossible":GOSUB3590:GOSUB3600:GOTO710
1300 IFB$="DOOR"ANDL=9ANDVJ=1THENGOSUB3130:HDRAW"BM155,38;C8"+AB$:N$="You are given something...":O(3)=1000:LO$(3)="a ring":HCOLOR3,4:GOSUB3590:HCOLOR2,4:GOSUB3600:GOSUB3640:GOSUB3620:GOTO450
1310 IFB$="TUBE"ANDO(8)=1000THENN$="  done !":VK=1:GOSUB3590:GOSUB3600:GOTO710
1320 IFB$="URN"THENB$="WIND":GOTO1200
1330 N$="  IMPOSSIBLE":GOSUB3590:GOSUB3600:GOTO710
1340 IFB$="MUSHROOM"ANDL=12ANDO(6)=1000THENN$="you hallucinate...":GOSUB3590:GOSUB3600:GOSUB3143:T(3,12)=13:T(4,13)=12:GOSUB3640:O(6)=100:GOTO450
1345 IFB$="mushroom"ANDO(6)=1000THENN$="Not bad...":GOSUB3590:GOSUB3600:O(6)=100:GOTO710
1350 N$="You can't.":GOSUB3590:GOSUB3600:GOTO710
1360 IFA$=A1$ANDL=4ANDO(7)=1000THENT(3,4)=9:T(4,9)=4:N$="...An underground passage appears":GOSUB3590:GOSUB3600:GOSUB3640:GOTO450
1370 IFA$=A1$ANDO(7)<>1000THENN$="Too hard...!":GOSUB3590:GOSUB3600:GOTO710
1380 IFA$=A1$THENN$="Not here":GOSUB3590:GOSUB3600:GOTO710
1390 IFB$="TORCH"ANDO(9)=1000ANDVH=1THENN$=" One sees clearly now...":WM=1:GOSUB3590:GOSUB3600:IFL=9ANDWM=1THEN HCOLOR0,8:GOSUB3120:HCOLOR2,4:GOSUB3600:GOTO710
1400 N$="         ?  ?  ?  ?":GOSUB3590:GOSUB3600:GOTO710
1410 IFA$=A1$ANDL=4ORL=5ORL=6THENN$="You are sinking...too bad.":GOSUB3590:GOTO3140
1420 IFA$=A1$ANDL=4ANDVG=1THENN$="It's not windy enough":GOSUB3590:GOSUB3600:GOTO710
1430 N$="You can'T.":GOSUB3590:GOSUB3600:GOTO710
1440 IFB$="BOULDER"ANDL=11THENN$="It moves...":GOSUB3590:GOSUB3600:T(1,11)=3:T(2,3)=11:LO$(11)="a dark hole":GOSUB3620:GOSUB3640:ZA=1:GOSUB3320:GOTO450
1450 N$="You  can'T.":GOSUB3590:GOSUB3600:GOTO710
1460 IFA$=A1$THENN$=" WHAT ?":GOSUB3590:GOSUB3600:GOTO710
1470 IFB$="WATER"ANDL=4ORL=5ORL=6THENN$="Water paralyses you...":GOSUB3590:GOSUB3600:GOSUB3140
1475 N$="Nothing to drink...":GOSUB3590:GOSUB3600:GOTO710
1480 IFA$=A1$THEN GOSUB3630:N$="YOU ARE CARRYING: ":HPRINT(2,13),N$:HO=13
1490 FORV=1TOY
1500 IF O(V)=1000 THEN N$=LO$(V):HPRINT(20,HO),N$:HO=HO+1
1510 NEXTV
1520 FORX=1TO3000:NEXTX:GOSUB3630:GOTO440
1800 HLINE(80,160)-(320,168),PRESET,BF:A$="":W=11:GOTO1820
1820 I$=INKEY$
1830 IFI$=""THEN1820
1840 SOUND230,1
1850 IFI$=CHR$(13)THENRETURN
1880 IFI$=CHR$(8)ANDLEN(A$)>0THENA$=LEFT$(A$,LEN(A$)-1):HCOLOR4,4:HLINE((W*8)-8,152)-(W*8,168),PRESET,BF:HCOLOR2,4:W=W-1:GOTO1820
1890 A$=A$+I$
1900 HPRINT(W,20),I$:W=W+1
1910 IFLEN(A$)>30THENRETURN
1920 GOTO1820
1930 GOSUB3560
1940 IFL=2THENGOTO1970
1950 HLINE(25,60)-(40,26),PSET
1960 IFL=10THENGOTO2020
1970 HLINE(40,28)-(25,22),PSET
1980 HLINE(45,12)-(20,4),PSET
1990 HLINE(25,6)-(25,0),PSET
2000 HLINE(45,12)-(50,0),PSET
2010 IFL=2THENGOTO2110
2020 HLINE(95,80)-(95,68),PSET
2030 HLINE(95,68)-(120,64),PSET
2040 HLINE(120,64)-(120,52),PSET
2050 IFL=10THENGOTO2080
2060 HLINE(120,52)-(100,52),PSET
2070 HLINE(100,52)-(115,0),PSET
2080 HLINE(95,80)-(120,96),PSET
2090 HLINE(25,64)-(25,22),PSET
2100 IFL=10THENGOTO2140
2110 HDRAW"BM15,96;E13F6E15F15E10F10E6F13"
2120 HLINE(155,0)-(140,16),PSET
2130 HLINE(140,16)-(180,16),PSET
2140 HLINE(180,16)-(150,44),PSET
2150 HLINE(150,44)-(180,48),PSET
2160 HLINE(180,48)-(175,56),PSET
2170 HLINE(175,56)-(210,62),PSET
2180 HLINE(210,62)-(220,72),PSET
2190 HLINE(220,72)-(280,44),PSET
2200 HLINE(280,44)-(305,60),PSET
2210 HLINE(280,44)-(305,28),PSET:HLINE(305,28)-(290,16),PSET:HLINE(290,16)-(305,0),PSET
2220 HLINE(305,60)-(320,60),PSET
2230 IFL=2THENGOTO2270
2240 IFL=10THENRETURN
2250 HLINE(200,60)-(195,96),PSET:HLINE(225,96)-(223,72),PSET:HLINE(240,61)-(235,96),PSET:HLINE(225,81)-(237,82),PSET:HLINE(290,82)-(300,84),PSET
2260 HLINE(280,44)-(293,95),PSET
2270 HLINE(313,60)-(293,95),PSET
2280 IFL=2THENRETURN
2300 HCIRCLE(127,132),128,2,.5,.71,.85:HCIRCLE(132,132),225,2,.5,.74,.79
2330 PALETTE15,4:PALETTE11,62:HPAINT(75,4),15,2:HPAINT(40,4),11,2:HPAINT(130,4),11,2:HPAINT(215,80),15,2:HPAINT(270,80),15,2:HPAINT(315,80),15,2:HPAINT(50,94),0,2
2340 PALETTE3,15:PALETTE12,34:PALETTE15,4:HPAINT(30,32),3,2:HPAINT(230,76),3,2:HPAINT(295,72),3,2:HPAINT(200,4),0,2:HPAINT(315,4),5,2:HPAINT(150,90),0,2:HPAINT(230,95),0,2:HPAINT(295,90),0,2:HPAINT(130,48),3,2
2360 HLINE(265,82)-(268,92),PSET
2370 IFL=10THENRETURN
2380 FORLL=1TO75:XX=RND(55)+20:YY=RND(12)+80:HSET(XX,YY):NEXTLL
2390 RETURN
2400 GOSUB1930
2410 HLINE(205,61)-(205,96),PSET:HLINE(225,69)-(225,96),PSET:HLINE(250,58)-(250,96),PSET:HLINE(285,96)-(285,47),PSET:IFL=10THENRETURN
2420 HLINE(151,51)-(178,53),PSET:HLINE(45,12)-(50,24),PSET:HLINE(50,24)-(40,28),PSET
2430 HLINE(114,23)-(115,0),PSET:HLINE(183,88)-(188,90),PSET:HLINE(225,76)-(250,80),PSET
2440 HLINE(45,12)-(65,2),PSET:HLINE(65,2)-(75,10),PSET:HLINE(75,10)-(105,4),PSET:HLINE(105,4)-(95,16),PSET:HLINE(95,16)-(130,28),PSET:HLINE(130,28)-(130,40),PSET:HLINE(130,40)-(150,48),PSET:HLINE(150,48)-(155,60),PSET:HLINE(155,60)-(185,88),PSET
2450 HLINE(47,26)-(84,42),PSET:HLINE(85,39)-(47,23),PSET:HLINE(158,77)-(179,86),PSET:HLINE(105,51)-(126,61),PSET:HLINE(76,18)-(59,27),PSET:HLINE(55,34)-(53,56),PSET:HLINE(91,64)-(83,41),PSET
2460 HLINE(120,57)-(135,54),PSET:HLINE(120,62)-(129,76),PSET:HLINE(83,37)-(114,34),PSET:HLINE(155,61)-(184,88),PSET
2470 HLINE(40,80)-(20,52),PSET:HLINE(20,52)-(40,28),PSET
2480 HLINE(185,88)-(150,92),PSET:HLINE(150,92)-(130,92),PSET:HLINE(130,92)-(125,88),PSET:HLINE(125,88)-(115,88),PSET:HLINE(115,88)-(110,76),PSET:HLINE(110,76)-(95,80),PSET:HLINE(130,92)-(140,96),PSET
2490 HLINE(140,96)-(95,80),PSET:HLINE(95,80)-(54,72),PSET:HLINE(54,72)-(40,80),PSET:HLINE(285,80)-(305,80),PSET:HLINE(25,22)-(25,48),PSET
2500 HCIRCLE(132,132),225,2,.5,.74,.79
2510 PALETTE15,4:PALETTE11,62:PALETTE3,15:HPAINT(10,2),15,2:HPAINT(215,85),15,2:HPAINT(265,85),15,2:HPAINT(315,85),15,2:HPAINT(80,4),15,2:HPAINT(60,80),15,2:HPAINT(98,80),15,2
2520 HPAINT(40,4),11,2:HPAINT(130,4),11,2:HPAINT(140,28),3,2:HPAINT(30,32),3,2:HPAINT(240,76),3,2:HPAINT(295,76),3,2:PALETTE6,49:HPAINT(185,80),6,2:HPAINT(245,94),6,2:HPAINT(290,94),6,2
2530 HPAINT(75,60),0,2:HPAINT(315,4),0,2:HPAINT(50,94),0,2
2540 HPAINT(250,4),5,2:
2550 RETURN
2560 GOSUB3560:GOSUB2630:HLINE(100,96)-(120,84),PSET:HLINE(120,84)-(112,96),PSET:HLINE(120,84)-(105,68),PSET:HLINE(105,68)-(80,64),PSET:HLINE(140,42)-(150,96),PSET
2570 HLINE(142,52)-(175,36),PSET:HLINE(175,36)-(215,40),PSET:HLINE(215,40)-(230,64),PSET:HLINE(230,64)-(253,76),PSET:HLINE(230,64)-(225,72),PSET:HLINE(225,72)-(205,78),PSET:HLINE(0,48)-(45,62),PSET:HLINE(45,62)-(80,64),PSET
2580 IFL=7THENRETURN
2590 PALETTE15,4:PALETTE14,30:PALETTE3,15:PALETTE11,62:PALETTE13,14:HPAINT(50,4),3,2:HPAINT(30,80),0,2:HPAINT(80,40),13,2:HPAINT(300,40),13,2:HPAINT(200,60),14,2:HPAINT(200,4),11,2:HPAINT(110,92),15,2
2605 HLINE(265,53)-(285,56),PSET:HLINE(250,60)-(275,60),PSET
2610 'POKE178,1:FORLL=1TO30:XX=RND(76)+12:YY=RND(14)+72:PSET(XX,YY):NEXTLL
2620 RETURN
2630 GOSUB3560:HLINE(0,0)-(65,20),PSET:HLINE(65,20)-(85,20),PSET:HLINE(85,20)-(100,26),PSET:HLINE(100,26)-(130,12),PSET:HLINE(130,12)-(105,0),PSET
2640 IFL=3THENGOTO2660
2650 HLINE(25,96)-(60,80),PSET:HLINE(60,80)-(70,68),PSET:HLINE(70,68)-(108,52),PSET:HLINE(108,52)-(125,43),PSET:HLINE(125,43)-(145,40),PSET
2660 HLINE(130,12)-(140,41),PSET:HDRAW"BM65,20;D7L2D7BD8BL2D4L1D4BR40BU23D5L1D5BD4D5L1D4"
2670 HLINE(0,0)-(65,20),PSET:HLINE(65,20)-(85,20),PSET:HLINE(85,20)-(100,26),PSET:HLINE(100,26)-(130,12),PSET:HLINE(130,12)-(105,0),PSET
2680 HLINE(300,0)-(275,12),PSET:HLINE(275,12)-(265,53),PSET:HLINE(265,53)-(250,60),PSET:HLINE(250,60)-(255,96),PSET:HDRAW"BM250,60;R23BL8BU7R5D1R5D1R5D1R5D1"
2690 IFL=3THENRETURN
2700 HDRAW"BM60,80;R5D1R5D1R5D1R5D1F6R5D1R5D1R5D1BR55BU24E13R5U1R5U2R4U2E6R3U2"
2710 HLINE(145,40)-(180,40),PSET:HLINE(180,40)-(195,44),PSET:HLINE(195,44)-(205,60),PSET:HLINE(205,60)-(215,68),PSET:HLINE(215,68)-(245,80),PSET:HLINE(245,80)-(255,96),PSET
2720 HLINE(22,36)-(20,76),PSET
2740 HCIRCLE(215,44),65,,.25,.56,.92:HLINE(189,32)-(187,0),PSET:HLINE(249,33)-(252,0),PSET
2750 PALETTE3,15:PALETTE13,14:PALETTE14,30:PALETTE9,32:HPAINT(75,40),13,2:HPAINT(300,40),13,2:HPAINT(150,24),9,2:HPAINT(200,24),9,2:HPAINT(260,24),9,2:HPAINT(220,48),2,2:HPAINT(150,80),14,2:HPAINT(80,4),3,2
2780 RETURN
2790 GOSUB3560
2800 IFL=7THENRETURN
2810 IFL=6THENRETURN
2820 SO$="U24E40R15D4R15F13R15F9H2D4L5G4H4L20U4H6L10U4H13;BR63BD23L2R2D38;F19D3L30H22L20H4L49"
2830 IFL=6THENRETURN
2840 HDRAW"S4;BM0,76;"+SO$
2850 EP$="U4L25E25L25E25U4L20E20U4L20E20U8;R5D4F18E8U4E3F3D4F10L10D4F10E15U4L15E15U4R5F15L15D4F20L20D4F25L25F25L25D10;L5U4L25E25U4L25F15L15D8L5U4L15;F13L25D8L5U6"
2860 IFL=6THENRETURN
2870 IFL=6THENRETURN
2880 HDRAW"S3;BM138,84;"+EP$
2890 TR$="D7F4E10L8E3L8":HDRAW"BM148,42;R9D3G3H6":HDRAW"BM144,49;R6G5L3U5":HDRAW"BM143,63;R5G5U4":IFL=6THENRETURN
2900 HDRAW"BM164,45;R15G8H8"
2910 HDRAW"BM143,30;"+TR$
2920 AR$="D32E35D8R5G40D32;E30D4R5G15R10D2L13G18D7;L35U19H13L8U2R5H10E5U4F20;U28H30U4E5F25U25R37"
2930 IFL=6THENRETURN
2940 IFL=7THENRETURN
2950 HDRAW"S4;BM280,0;"+AR$
2960 PALETTE2,14
2970 HLINE(106,61)-(121,61),PSET:HLINE(203,69)-(242,76),PSET:HLINE(282,84)-(320,88),PSET:HLINE(106,54)-(136,48),PSET:HLINE(191,40)-(242,40),PSET:HLINE(286,40)-(320,38),PSET
2980 HDRAW"BM96,40;H4L14H9L4H4BR16BD4D5F8"
2990 PALETTE5,59:PALETTE9,32:PALETTE3,58:PALETTE13,14:PALETTE6,20:PALETTE15,4:HPAINT(50,60),8,2:HPAINT(270,5),8,2:HPAINT(135,15),15,2:HPAINT(30,88),13,2:HPAINT(180,88),13,2:HPAINT(300,88),13,2:HPAINT(52,20),9,2:HPAINT(4,4),6,2:HPAINT(215,48),5,2
2995 HPAINT(148,32),6,2:HPAINT(151,43),6,2:HPAINT(110,60),5,2:HPAINT(144,51),5,2:HPAINT(170,48),5,2:HPAINT(173,55),5,2:HPAINT(300,48),5,2:HPAINT(240,4),6,2:HPAINT(300,4),6,2:HPAINT(318,2),6,2:HPAINT(315,30),6,2
2997 FORLL=1TO20:XX=RND(60)+4:YY=RND(10)+80:HSET(XX,YY,8):NEXTLL
2999 HCOLOR2,4:RETURN
3000 HCOLOR8,4:GOSUB2790:GOSUB2820:HDRAW"S3;BM208,76;C8;"+SO$:GOSUB2920:HDRAW"S4;BM195,0;"+AR$:GOSUB2850:HDRAW"S4;BM40,99;"+EP$:HDRAW"BM208,76;D1R2":HDRAW"BM208,62;G24R24E15":HDRAW"BM208,80;C4;U16":HLINE(20,97)-(140,112),PRESET,BF
3010 HCOLOR8,4:HLINE(0,41)-(38,46),PSET:HLINE(118,54)-(140,60),PSET:HLINE(290,76)-(320,75),PSET:HCIRCLE(217,48),107,8,.11,.53,.78:HCIRCLE(217,48),107,8,.11,.85,1
3020 PALETTE6,20:PALETTE15,4:PALETTE9,32:PALETTE13,14:PALETTE5,59:HPAINT(250,4),6,8:HPAINT(210,2),6,8:HPAINT(150,2),6,8:HPAINT(110,2),6,8:HPAINT(70,2),6,8:HPAINT(2,2),6,8:HPAINT(108,67),15,8:HPAINT(169,67),8,8:HPAINT(211,67),8,8:HPAINT(169,4),8,8
3025 HPAINT(154,48),5,8:HPAINT(205,48),5,8:HPAINT(298,52),5,8:HPAINT(300,94),13,8:HPAINT(140,94),13,8:HPAINT(4,94),13,8:HPAINT(75,95),13,8:HPAINT(90,80),13,8:HPAINT(270,45),9,8:FORLL=1TO25:XX=RND(75)+200:YY=RND(12)+78:HSET(XX,YY,2):NEXT
3030 RETURN
3040 HCOLOR8,4:GOSUB2790:HCOLOR1,4:HLINE(1,1)-(319,95),PSET,B:HLINE(0,56)-(320,28),PSET:HCOLOR8,4:PALETTE6,20:PALETTE15,10:PALETTE5,52:PALETTE13,14:HPAINT(2,60),13,1:HPAINT(2,2),6,1
3045 GOSUB2850:HDRAW"S4;BM40,99;"+EP$:GOSUB2850:HDRAW"S3;BM138,84;"+EP$:GOSUB2920:HDRAW"S4;BM280,0;"+AR$:HLINE(20,97)-(140,112),PRESET,BF
3050 HLINE(290,0)-(290,96),PSET:HLINE(314,0)-(314,96),PSET:HCOLOR4,4:HLINE(300,2)-(300,94),PSET:HCOLOR8,4:HPAINT(300,90),8,8:HPAINT(263,13),8,8:HPAINT(179,39),15,8:HPAINT(95,39),15,8:HPAINT(316,10),8,8:HPAINT(179,65),15,8:HPAINT(95,65),15,8
3052 HPAINT(263,65),8,8
3060 FORLL=1TO50:XX=RND(113)+118:YY=RND(12)+73:HSET(XX,YY):NEXTLL
3080 RETURN
3090 RETURN
3100 GOSUB3560
3110 HPAINT(100,2),8,2:RETURN
3120 GOSUB3130:HDRAW"BM100,80;U32BR15U8D32BR35BU16BL5L5BR10U32R30D32BR4R6":HDRAW"BM155,38;"+AB$:HLINE(80,96)-(100,80),PSET:HLINE(100,48)-(115,40),PSET:HLINE(118,70)-(135,56),PSET:HLINE(195,56)-(250,96),PSET
3130 AB$="D6BD12R10BR5R5":RETURN
3140 FORP=220TO1STEP-1:HCIRCLE(160,96),P,2,1,.5:NEXTP:FORP=1TO1500:NEXT:POKE65496,0:PALETTECMP:END
3143 PALETTECMP:FORV=1TO800:NEXTV:PALETTE15,10:PALETTE6,10:FORV=1TO800:NEXTV:PALETTECMP:FORV=1TO800:NEXTV:PALETTE6,21:PALETTE15,4:FORV=1TO800:NEXTV:RETURN
3150 HCLS6:FORC=1TO10:HCLS2:FORP=1TO30:NEXTP:HCLS4:FORP=1TO30:NEXTP:HCLS0:FORP=1TO30:NEXTP:NEXTC:HCLS4:RETURN
3160 GOSUB2400
3170 HLINE(0,8)-(15,20),PSET:HLINE(15,20)-(38,22),PSET:HLINE(38,22)-(60,44),PSET:HLINE(60,44)-(85,36),PSET:HLINE(85,36)-(100,52),PSET:HLINE(100,52)-(118,52),PSET:HLINE(150,45)-(179,16),PSET
3180 HLINE(118,52)-(140,40),PSET:HLINE(140,40)-(150,44),PSET:HLINE(145,96)-(205,88),PSET:HLINE(225,88)-(245,96),PSET:HLINE(300,96)-(300,55),PSET:HLINE(190,0)-(180,8),PSET:HLINE(180,8)-(180,16),PSET
3190 HDRAW"BM0,64;E10F20E5F10E10F25E5F7"
3200 PALETTE15,4:PALETTE11,62:PALETTE3,15:PALETTE6,49:HPAINT(4,4),0,2:HPAINT(250,4),5,2:HPAINT(315,4),3,2:HPAINT(10,40),15,2:HPAINT(215,80),15,2:HPAINT(270,80),15,2:HPAINT(315,80),15,2
3210 HPAINT(10,72),0,2:HPAINT(200,94),6,2:HPAINT(230,94),6,2:HPAINT(150,60),11,2:HPAINT(30,28),11,2:HPAINT(240,72),11,2:HPAINT(290,80),11,2
3230 FORLL=1TO30:XX=RND(32)+20:YY=RND(12)+64:HSET(XX,YY):NEXTLL
3240 RETURN
3250 GOSUB3560:HLINE(0,24)-(40,40),PSET:HLINE(40,0)-(50,42),PSET:HLINE(40,40)-(85,48),PSET:HLINE(85,48)-(100,96),PSET:HLINE(88,52)-(0,76),PSET
3260 HLINE(88,56)-(115,60),PSET:HLINE(115,60)-(136,44),PSET:HLINE(143,44)-(168,46),PSET:HLINE(170,48)-(200,56),PSET:HLINE(165,24)-(178,14),PSET:HLINE(185,14)-(215,24),PSET:HLINE(215,24)-(225,36),PSET
3270 HDRAW"BM170,48;U2L1U2L1U2L1U2L2U4L1U4U4R2U4R2":HDRAW"BM178,14;R2U1R3D1R2":HDRAW"BM200,56;R5U1R5U1R5U2R5U1R3"
3280 HLINE(230,20)-(220,64),PSET:HLINE(220,64)-(220,72),PSET:HLINE(220,72)-(240,86),PSET:HLINE(240,86)-(270,88),PSET:HLINE(270,88)-(280,96),PSET:HLINE(265,88)-(275,56),PSET:HLINE(230,20)-(245,8),PSET:HLINE(245,8)-(290,0),PSET
3290 HDRAW"BM130,56;E5U24G12U4E12U12G5U4E5U9R7D17F6D4H6D32R2D1R2D1R3D1R3D1L5L2U1L3U1L2U1L3U1G6L5E4":HLINE(275,56)-(280,93),PSET:HLINE(230,20)-(275,28),PSET:HLINE(275,28)-(320,24),PSET:HLINE(275,56)-(280,96),PSET
3300 PALETTE9,32:PALETTE13,14:PALETTE15,4:PALETTE14,30:HPAINT(40,80),13,2:HPAINT(140,4),15,2:HPAINT(300,4),5,2:HPAINT(20,44),5,2:HPAINT(8,8),9,2:HPAINT(100,20),9,2:HPAINT(200,8),9,2:HPAINT(200,40),9,2:HPAINT(100,80),14,2:HPAINT(250,60),13,2
3310 HPAINT(275,84),8,2:FORLL=1TO60:XX=RND(120)+100:YY=RND(36)+60:HSET(XX,YY,13):NEXTLL:RETURN
3320 HPAINT(200,40),8,2:RETURN
3330 GOSUB3560
3340 GOSUB3370
3350 HCIRCLE(160,146),110,,1,.59,.93:PALETTE6,21:PALETTE15,4:HPAINT(140,4),6,2:HPAINT(160,92),15,2:HDRAW"BM106,51;U2L1U5L1U12R1U8R1U5R1U4R3U3BR109U2D2R3D6R3D7R3D10L1D7L1D5L1D3":GOSUB3370
3360 HDRAW"BM151,66;D1U66BR18D3L16D8R16U8D16L16D8R16U8D16L16D8R16U8D16L16D8R16U8D15":HCOLOR2,4:FORLL=1TO30:XX=RND(100)+115:YY=RND(16)+68:HSET(XX,YY,6):NEXTLL
3365 HPAINT(4,4),8,2:HPAINT(300,4),8,2:FORP=1TO15:S=RND(55):T=RND(95):HSET(S,T):HSET(S+1,T):HSET(S-1,T):HSET(S,T-1):HSET(S,T+1):NEXTP:FORP=1TO15:S=RND(55)+265:T=RND(95):HSET(S,T):HSET(S-1,T):HSET(S+1,T):HSET(S,T+1):HSET(S,T-1):NEXTP
3369 RETURN
3370 HCIRCLE(200,40),147,,1,.44,.60:HCIRCLE(120,40),147,,1,.93,.07:HDRAW"BM74,95;U3R1BR170U1L1BD4R3":RETURN
3380 GOSUB3560
3390 HCIRCLE(160,96),155,2,.8,.5:HCIRCLE(160,136),188,2,.5,.60,.92:HCIRCLE(160,70),100,2,.80,.54,.98:HCIRCLE(160,58),50,,1.5,.54,.98:HDRAW"BM149,43;C4;R1E1R14F1":HCOLOR2,4
3400 HDRAW"BM147,88;L1U7E1U13E1U13E1U8R1U1L1U3E1U6D6G1L1U2H1U2H1U8R1E1R2E1R2E1R1BD2BR2R1U1L1H4U5E1U2E1U3E1U2E1U2D2F1D3F1D3F1D2L2G1L1H1L2BR8D5G4E2F1R1F1R2F1R2F1R1D8G1D2G1D2L1H1U6BD7BR1D4L1D1R1D8F1D13F1D13F1D7L1G1L2G1L2G1L2G1L2H1L2H1L2H1L2H1L1"
3410 HCIRCLE(66,74),8,,.3:HCIRCLE(107,61),8,,.3:HCIRCLE(120,75),9,,.3:HCIRCLE(193,60),8,,.3:HCIRCLE(209,76),9,,.3:HCIRCLE(251,73),9,,.3
3415 HPAINT(66,74),4,2:HPAINT(107,61),1,2:HPAINT(120,75),1,2:HPAINT(193,60),3,2:HPAINT(209,76),4,2:HPAINT(251,73),7,2
3430 HDRAW"BM155,18;R1BR2R1BD2BL2L1":HPAINT(2,2),8,2:HPAINT(315,2),8,2:HPAINT(50,40),3,2:HPAINT(270,40),3,2:HPAINT(210,35),2,2:HPAINT(110,32),2,2:HPAINT(160,2),4,2:HPAINT(158,10),0,2:PALETTE6,55:HPAINT(160,40),6,2:HPAINT(170,4),1,2
3435 PALETTE5,14:HPAINT(40,94),5,2:FORLL=1TO7:S=RND(35):T=RND(36):HSET(S,T):HSET(S-1,T):HSET(S+1,T):HSET(S,T+1):HSET(S,T-1):NEXTLL:FORLL=1TO7:S=RND(35)+285:T=RND(35):HSET(S,T):HSET(S-1,T):HSET(S+1,T):HSET(S,T-1):HSET(S,T+1):NEXTLL
3440 N$="You are in the leprechaun's place.":HPRINT(2,13),N$:N$="He is glad to meet you, lucky adventurer!":HPRINT(0,15),N$:N$="  Your quest is now over!!!":HPRINT(5,22),N$
3445 HCOLOR3,4
3450 HDRAW"BM52,160;S8;BUFR3L3HU4ER3BD6BR3;BUU4ER2FD4GL2HFBR6;U6DF2F2DU6BD6BR3;BUFR2EUHLBL2D2U4ER3BRBD6BR3;U6R3FDGL3R2F2DBR3;U4E2F2D2L4R4D2BR3;BU6R4L2D6BR5;BU6D5FR2EU5BD6BR3;BU6D6R4BLBR3;U4E2F2D2L4R4D2BR3;BU6R4L2D6BR5;R4L2U6L2R4BD6BR3BUU4ER2FD4GL2HFBR3"
3455 HDRAW"BM+3,0;U6DF2F2DU6BD6BR3;BUFR2EUHL2HEUR2FBD5":FORX=1TO3200:NEXT:PALETTECMP:FORR=175TO1STEP-2:HCIRCLE(160,96),R,4,1,.5:NEXT:GOSUB5500:POKE65496,0:PALETTECMP:END
3460 GOSUB3560:HCIRCLE(0,32),100,2,1,.80,.08:HCIRCLE(27,0),114,2,.80,.161,.5:HDRAW"BM69,81U2R1U3R1U3R1U3R1U3R1U4R1U4R1U5R1U5R1U12L6D1L5D1L5D1L9D1L8D5L1D4L1D5L1D5L1D4L1D6L1D4L1D5L1D6L1D3BU27BR13D3L1"
3470 HCIRCLE(191,192),335,2,.54,.720,.78:HLINE(98,15)-(126,14),PSET:HLINE(284,18)-(320,24),PSET
3480 CH$="U2L1U3L1U8R1U5R1U2L1U1L4U1L4U1L3U1L1U1L1U1L1U3R1U3R1E7R1U1R2U1R5U1R10D1R5D1R2D1R2D1R2D1R1D1R2F3R1D2R1D2R1D2R1D3L2D1L3D1L5D1L4D1L3D1L13U1L3BR17D2R1D1R1D5R1D7L1D3L1D2L5D1L9U1L4U1"
3490 HDRAW"S8;BM236,90;"+CH$:HDRAW"S4;BM152,60;"+CH$:PALETTE15,38:PALETTE12,4:HPAINT(160,94),8,2:HPAINT(4,4),15,2:HPAINT(160,2),8,2:HPAINT(50,50),12,2:HPAINT(160,32),6,2:HPAINT(160,54),3,2:PALETTE10,27:HPAINT(260,30),10,2:PALETTE11,42
3495 HPAINT(260,80),11,2:FORLL=1TO35:S=RND(120)+110:T=RND(32)+64:HSET(S,T):NEXTLL:FORLL=1TO15:S=RND(40)+98:T=RND(25)+24:HSET(S,T):NEXTLL:FORLL=1TO20:S=RND(50)+280:T=RND(50)+50:HSET(S,T):NEXTLL
3510 RETURN
3515 PALETTE15,4:PALETTE13,14:PALETTE11,62:PALETTE12,34:PALETTE10,30
3516 IFO(C)=O(7)THENS=82:T=69:GOSUB4000:RETURN
3517 IFO(C)=O(1)THENS=300:T=94:GOSUB4000:RETURN
3518 IFO(C)=O(2)THENS=4:T=64:GOSUB4000:RETURN
3519 IFO(C)=O(4)THENS=98:T=94:GOSUB4000:RETURN
3520 IFO(C)=O(5)THENS=46:T=67:GOSUB4000:RETURN
3521 IFO(C)=O(6)THENS=301:T=30:GOSUB4000:RETURN
3522 IFO(C)=O(8)THENS=50:T=85:GOSUB4000:RETURN
3523 IFO(C)=O(9)THENS=245:T=78:GOSUB4000:RETURN
3524 IFO(C)=O(10)THENS=90:T=83:GOSUB4000:RETURN
3530 G$(7)="BM82,69;R4L2D20U5L1R3D3BL1BD1L2BRD1BU2BL2U3":G$(2)="BM4,64;D6F3R2L5D10E5U11H5BR15G5D11F5U10L4R2E3U7BD14BL3U1BL10D1":G$(5)="BM46,67;L8BD1L1R8BD1BL1L8R1BD1R8BDR1L8BD1L1R8BD1BL1L8":G$(1)="BM300,94;U9R4U1L2U1R2D2R2D9L
3540 G$(4)="BM98,94;U4R2D4U2R12D2U2R1":G$(6)="BM301,80;U4L4R7L1U1L5":G$(10)="BM90,83;R7F3L7H3D2F3R7U2":G$(8)="BM50,85;R13U1R2L15U1R13":G$(9)="BM245,78;U13L1R2U1L2U1R2":RETURN
3550 RETURN
3560 PALETTECMP:HLINE(0,0)-(320,96),PSET,B:RETURN
3570 N$="You're welcome.":GOTO3590
3580 N$="My magic is carrying you...":L=RND(7):GOSUB3590:GOSUB3600:ZE=0:GOTO370
3590 HPRINT(3,22),N$:RETURN
3600 FORX=1TO2000:NEXTX:HLINE(17,174)-(302,186),PRESET,BF:HCOLOR1,4:HLINE(16,172)-(304,188),PSET,B:HCOLOR2,4
3610 RETURN
3620 HLINE(0,134)-(320,159),PRESET,BF:RETURN
3630 HLINE(0,100)-(320,191),PRESET,BF:RETURN
3640 HLINE(80,120)-(320,128),PRESET,BF
3650 RETURN:DRAW"BM10,190;":RETURN
3660 N$="Right! Good luck!!!":GOSUB3590:L=6:RETURN
3670 N$="Right! Good luck!":GOSUB3590:GOSUB3600:T(1,6)=9:T(2,9)=6:L=9:ZE=0:GOTO370
4000 IFHPOINT(S,T)=4ORHPOINT(S+1,T)=4ORHPOINT(S,T+1)=4 THENHCOLOR15,4:GOTO3530
4001 IFHPOINT(S,T)=14ORHPOINT(S+1,T)=14ORHPOINT(S,T+1)=14 THENHCOLOR13,14:GOTO3530
4002 IFHPOINT(S,T)=62ORHPOINT(S+1,T)=62ORHPOINT(S,T+1)=62 THENHCOLOR11,62:GOTO3530
4003 IFHPOINT(S,T)=34ORHPOINT(S+1,T)=34ORHPOINT(S,T+1)=34 THENHCOLOR12,34:GOTO3530
4004 IFHPOINT(S,T)=8ORHPOINT(S+1,T)=8ORHPOINT(S,T+1)=8 THENHCOLOR8,4:GOTO3530
4005 IFHPOINT(S,T)=0ORHPOINT(S+1,T)=0ORHPOINT(S,T+1)=0THENHCOLOR0,0:GOTO3530
4006 IFHPOINT(S,T)=5ORHPOINT(S+1,T)=5ORHPOINT(S,T+1)=5THENHCOLOR5,5:RETURN
4007 IFHPOINT(S,T)=30ORHPOINT(S+1,T)=30ORHPOINT(S,T+1)=30THENHCOLOR10,30:GOTO3530
4010 HCOLOR13,4:GOTO3530
5000 PALETTECMP:POKE65496,0:END
5499 'THE FOLLOWING TUNE FROM R.S. BOOK "EXTENTED BASIC"
5500 A$=";T5;C;E;F;L1;G;P4;L4;C;E;F;L1;G":B$="P4;L4;C;E;F;L2;G;E;C;E;L1;D":C$="P8;L4;E;E;D;L2;C;L4;C;L2;E":D$="L4;G;G;G;L1;F;L4;E;F":E$="L2;G;E;L4;C;L8;D;D+;E;G;L4;A;L1;O3;C":X$=A$+B$+C$+D$+E$:PLAYX$:X$="V6;"+A$+B$+C$+D$+E$:PLAYX$:RETURN
6100 CX$=CHR$(32)
6130 FORCX=38TO1STEP-1
6140 IFMID$(N$,CX,1)=CX$THENCV=CX:ZB$=LEFT$(N$,CV-1):HPRINT(2,17),ZB$+CX$:GOTO6200
6150 NEXTCX
6200 PP=39+CV
6210 FOR CX=PP TO 1 STEP-1
6220 IFMID$(N$,CX,1)=CX$THENCC=CX:ZC$=MID$(N$,CV+1,CC-LEN(ZB$)-2):HPRINT(1,18),ZC$+CX$:GOTO6235
6230 NEXTCX
6235 IFLEN(N$)<PP+1THEN680
6240 ZD$=MID$(N$,CC+1,LEN(N$)-CC):HPRINT(1,19),ZD$:GOTO680
