100 ' WORM DRIVER PROGRAM FOR COCO 1, 2, OR 3 IN 256 BY 192 MODE
110 WIDTH 32
120 PMODE 4,1
130 PCLS 1
140 SCREEN 1,0
150 LINE (0,0)-(255,195),PRESET,B
160 GOSUB 360
170 IF DI$="U" THEN A$=U$ ELSE IF DI$="R" THEN A$=R$ ELSE IF DI$="D" THEN A$=D$     ELSE IF DI$="L" THEN A$=L$ ELSE IF DI$="E" THEN A$=E$ ELSE IF DI$="F" THEN      A$=F$ ELSE IF DI$="G" THEN A$=G$ ELSE A$=H$
180 J=VAL(MID$(A$,1,2))
190 FOR I=1 TO J:ND$=MID$(A$,I*2+1,1):NF=VAL(MID$(A$,I*2+2,1))
200 IF ND$="U" THEN IF FU>=NF THEN XD=0: YD=-1: GOTO 300
210 IF ND$="E" THEN IF FE>=NF THEN XD=1: YD=-1: GOTO 300
220 IF ND$="R" THEN IF FR>=NF THEN XD=1: YD=0: GOTO 300
230 IF ND$="F" THEN IF FF>=NF THEN XD=1: YD=1: GOTO 300
240 IF ND$="D" THEN IF FD>=NF THEN XD=0: YD=1: GOTO 300
250 IF ND$="G" THEN IF FG>=NF THEN XD=-1: YD=1: GOTO 300
260 IF ND$="L" THEN IF FL>=NF THEN XD=-1: YD=0: GOTO 300
270 IF ND$="H" THEN IF FH>=NF THEN XD=-1: YD=-1: GOTO 300
280 NEXT
290 XD=0: YD=0
300 DI$=ND$
310 FOR I=1 TO NF
320 X=X+XD: Y=Y+YD
330 PRESET(X,Y)
340 NEXT
350 GOTO 160
360 'FIND FOOD
370 FU=0:FOR I=1 TO LA:YN=Y-I:IF YN<1 THEN GOTO 390 ELSE FU=FU+PPOINT(X,YN)
380 NEXT
390 FE=0:FOR I=1 TO LA:XN=X+I:YN=Y-I:IF (XN>254 OR YN<1) THEN GOTO 410 ELSE FE=     FE+PPOINT(XN,YN)
400 NEXT
410 FR=0:FOR I=1 TO LA:XN=X+I:IF X>254 THEN GOTO 430 ELSE FR=FR+PPOINT(XN,Y)
420 NEXT
430 FF=0:FOR I=1 TO LA:XN=X+I:YN=Y+I:IF (XN>254 OR YN>190) THEN GOTO 450 ELSE       FF=FF+PPOINT(XN,YN)
440 NEXT
450 FD=0:FOR I=1 TO LA:YN=Y+I:IF Y>190 THEN GOTO 470 ELSE FD=FD+PPOINT(X,YN)
460 NEXT
470 FG=0:FOR I=1 TO LA:XN=X-I:YN=Y+I:IF (XN<1 OR YN>190) THEN GOTO 490 ELSE FG=     FG+PPOINT(XN,YN)
480 NEXT
490 FL=0:FOR I=1 TO LA:XN=X-I:IF XN<1 THEN GOTO 510 ELSE FL=FL+PPOINT(XN,Y)
500 NEXT
510 FH=0:FOR I=1 TO LA:XN=X-I:YN=Y-I:IF (XN<1 OR YN<1) THEN GOTO 530 ELSE FH=FH+    PPOINT(XN,YN)
520 NEXT
530 RETURN
