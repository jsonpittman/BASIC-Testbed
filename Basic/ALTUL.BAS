13856 L2=1:P=176:DIMF$(84),M(84)
42 HBUFF4,3200:HBUFF5,2104:HGET(0,0)-(639,19),4:HBUFF6,1520:HBUFF2,650
72 IFK=32THENZ=L+S:IFL+8<W THENHLINE(L,T)-(L+7,T+D),PRESET,BF:L=L+S:GOTO518
73 IFK=32THENHLINE(L,T)-(L+1,T+D),PRESET,BF:L=U:IFT<P AND T<191-2*D THENT=T+1+D:GOTO50ELSEFL=0:GOTO444
76 IFK=13 AND T<P THENT=T+1+D:GOTO54ELSEIFK=13THENIFSCI=2THENSK$="":SK=0:GOTO430ELSE54
80 IFK=93 AND SCI<>2THENIFH=1THENSOUND60,9:GOTO50ELSEZ=U:HLINE(L,T)-(L+1,T+D),PRESET,BF:IFL+DX-1<W THENL=8*INT(.125*L):HPUT(L,T)-(L+DX-1,T+DY-1),5:L=L+DX:GOTO50ELSESOUND60,9:GOTO50
128 HSCREEN0:CLS:ATTR0,4:LOCATE10,4:PRINT"A: ART-DESIGNS":LOCATE10,5:PRINT"B: BACK TO SCREEN":LOCATE10,6:PRINT"C: CONVERT WPF":LOCATE10,7:PRINT"D: DIR":LOCATE10,8:PRINT"F: FONT SELECT":LOCATE10,9:PRINT"G: GENERATE DESIGN
130 LOCATE10,10:PRINT"H: HOUSEKEEPING":LOCATE10,11:PRINT"I: INPUT":LOCATE10,12:PRINT"K: KEYS LISTED":LOCATE10,13:PRINT"M: MARGIN SET":LOCATE10,14:PRINT"O: OUTPUT":LOCATE10,15:PRINT"P: PRESENT STATUS
132 LOCATE10,16:PRINT"R: RESOLUTION CHANGE":LOCATE10,17:PRINT"S: SCREEN DUMP":LOCATE10,18:PRINT"T: TAB SET":LOCATE10,19:PRINT"X: EXIT UltraLace":LOCATE10,20:PRINT"Z= ZAP (KILL FILE)":LOCATE14,19:POKE&H23,A1:POKE&H24,A2:POKE&HFFD8,0
135 IFK$="Z" OR K$="z"THEN524
137 IFK$="G" OR K$="g"THEN528
324 CLS:LOCATE8,10:PRINT"1: 1COLUMN/4SCREEN":LOCATE8,11:PRINT"2: 2COLUMN/8SCREEN":LOCATE8,12:PRINT"3: 3COLUMN/12SCREEN":LOCATE8,13:PRINT"4: CANCEL ANY OF ABOVE":RETURN
348 CLS:LOCATE8,10:PRINT"1: SAVE FULL SCREEN":LOCATE8,12:PRINT"2: SAVE HALF SCREEN":LOCATE8,14:PRINT"3: SAVE DESIGN MENU
350 GOSUB322:IFK$="1"THENGOSUB404:GOSUB26:GOTO128ELSEIFK$="2"THENGOSUB404:GOSUB28:GOTO128ELSEIFK$="3"THEN536ELSESOUND60,9:GOTO128
396 GOSUB322:IFK$<"1" OR K$>"4"THENSOUND60,8:GOTO128ELSEIFK$="4"THEN522ELSEHF=1:HR=1:HS=76:IFK$="1"THENHK=1:U=0:W=640ELSEIFK$="2"THENHK=2:U=64:W=472ELSEHK=3:U=32:W=320
518 IFSCI<>0THEN50ELSEIFH=3THENB2=8:B3=.125ELSEB2=4:B3=.25
520 LQ=L-S:B3=B2*FIX(B3*L):L=B2+B3:Z=L:HLINE(LQ,T)-(L-1,T+D),PRESET,BF:IFL>=W THENL=LQ:HLINE(L,T)-(L+1,T+D),PRESET,BF:L=640:Z=U:GOTO50ELSE50
522 HK=0:CC=0:GOTO128
524 CLS:LOCATE0,5:PRINT"DO YOU REALLY WANT TO KILL A FILE? (Y,N)"
526 K$=INKEY$:IFK$=""THEN526ELSEIFK$="Y" OR K$="y"THENCLS:LOCATE2,5:PRINT"ENTER FILENAME, EXTENSION, & DRIVE NO.":LINEINPUTK$:KILLK$:GOTO128ELSE128
528 IFH=1THENSOUND60,9:GOTO128ELSEGOSUB534:HGET(L,T)-(L+95,T+47),2:EXEC&HF00:GOSUB534
530 K$=INKEY$:IFK$=""THEN530ELSEK=ASC(K$):IFK<50 OR K>51THENSOUND60,9:GOTO530ELSEIFK$="2"THENMY=96ELSEMY=144
532 K$=INKEY$:IFK$=""THEN532ELSEK=ASC(K$):IFK<97 OR K>106THENSOUND60,9:GOTO532ELSEK=K-97:MX=32+K*48:HPUT(MX,MY)-(MX+95,MY+47),2:HSCREEN0:EXEC&HF00:GOTO128
534 POKE&HE6E4,&HE6:HSCREEN3:POKE&HE6E4,&HE7:RETURN
536 EXEC&HF00:KILL"DMENU/HR1":KILL"DMENU/HR2":GOSUB212:F$="DMENU":GOSUB26:EXEC&HF00:GOTO128

