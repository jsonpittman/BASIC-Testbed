1 'CHESS SET                       BY JOEL F. KLEIN             16K ECB, 1 JOYSTICK REQUIRED    ADDRESS CORRESPONDANCE TO       K&R ELECTRONICS,4815 MARRISON   PL., INDPLS.,IN 46226
2 CLS:CLEAR255:PCLEAR4:PMODE4,1:PCLS1:DIMA$(5),A(.,2),B(8,8),C(1,15),BT(.,15),WT(.,15):D$="        "
3 B$="C0BM4,0G2DNG2D6GE2U7BR3D4NRD3G2EU7ERERDRDRDLG2FRFLFLDLGL2BR7EU7END7EBF4NRG2D2FNU3FERU4FD3FBE5BR2LULGND3GD2FRDRE2BF2EU7E2GD7UE2REBG3RDRDRD"
4 W$="C0BM0,1ERD9FNU9RERNU5RDREU7END7EBR3DGD8EU6D4E3RDRD4FU4BE4HEDRBD4HD5GHRU4BEBR3NR5R2NU3D4FNU9ED2E2BFBR7GL2ULULNU3ENR3U3R3DRD2"
5 T$="C0BM70,0D9HU4NU3L2R5BD5NGNLNHEBE2BU2ND5RD6RE3ND2U3RD6REBEBU3ERD6EU4RURF2BEBRERD6RU5RURF2ND3RD4REC1"
6 C$="C0BM189,7G3L4ULNU6HU5E3GFDNGFEUNHEFREBF3D2F2HU4ERFD4NLRNU3FBFBDEU6NHRD5ERE2UGU2LULBR5NR5R2NUD4FNU7ED2E2BE3NUD4FNU6RE3ND2U3RD6REBEBU3ERD6EU4RURF2BF3BR5GL2ULU2NR3U2LND3ER3DRD2BF4DLUBU2U7RD7"
7 PRINT@107,"CHESS  SET":PRINT:PRINT:PRINTD$"BY JOEL F. KLEIN":PRINT:PRINTD$"   MARCH 1988":PRINT:PRINT:PRINT:PRINT"     ONE MOMENT, PLEASE ..."
8 FORJ=.TO7:FORK=.TO7:A=-(A=.):COLORA:LINE(48+K*20,16+J*20)-(66+K*20,35+J*20),PSET,BF:NEXT:A=-(A=.):NEXT:DRAW"C0BM42,12R172NM-6,+3D168L172U168M+6,+3R160D161L160NM-5,+4U162":PAINT(212,44),.,.
9 DRAW"C1":LINE(.,.)-(42,11),PSET,BF:DRAW"C0BM46,5ENH2U2LURBF3BD5RDR2EULUL2ULUER2DR":DRAW"XB$;XT$;":GET(.,.)-(42,10),BT,G:LINE(.,.)-(42,11),PSET,BF:DRAW"XW$;":GET(.,.)-(42,10),WT,G
10 RESTORE:FORJ=.TO5:READA$(J):NEXT:FORJ=.TO7:READB(J,.),B(J,1),B(J,6),B(J,7):NEXT:FORJ=.TO7:FORK=2TO5:B(J,K)=12:NEXT:NEXT:FORJ=.TO15:C(.,J)=48+J:C(1,J)=8*((J>7)-(J<8))+J:NEXT:JN=1:BN=65280
11 FORP=.TO1:FORPN=.TO15:GOSUB30:NEXT:NEXT:SCREEN1,.:SOUND200,2
12 'MAIN GAME LOOP
13 P=-(P=.):IFP=.THENPUT(.,.)-(42,10),WT,PSETELSEPUT(.,.)-(42,10),BT,PSET
14 GOSUB26:IF(P+1)*6>B(X,Y)ANDP*6-1<B(X,Y)THENSX=X:SY=Y:GOTO15ELSESOUND1,3:GOTO14
15 GOSUB26:IFB(X,Y)>P*6-1ANDB(X,Y)<P*6+6THENSOUND1,3:GOTO15 ELSE DX=X:DY=Y
16 PP=-(P=.):IFB(DX,DY)>PP*6-1ANDB(X,Y)<PP*6+6THENDRAW"XC$;C1":PLAY"T3V21L12O3CEGL8O4CL12O3AL4O4C":LINE(180,.)-(244,11),PSET,BF:X=DX:Y=DY:PP=P:P=-(P=.):GOSUB31:P=PP:C(-(P=.),PN)=72:B(DX,DY)=12
17 IFY+P=P*8ANDINT(B(SX,SY)/6)=B(SX,SY)/6THEN20
18 SOUND150,1:C=-((INT(SX/2)=SX/2)=(INT(SY/2)=SY/2)):COLORC:LINE(49+SX*20,16+SY*20)-(66+SX*20,35+SY*20),PSET,BF:C=-((INT(DX/2)=DX/2)=(INT(DY/2)=DY/2)):COLORC:LINE(49+DX*20,16+DY*20)-(66+DX*20,35+DY*20),PSET,BF
19 X=SX:Y=SY:GOSUB31:B(DX,DY)=B(SX,SY):B(SX,SY)=12:C(P,PN)=DX+DY*8:GOSUB30:GOTO12
20 PLAY"T2V31O3L12DDDP32L2A":CLS:PRINT@128,D$"  PAWN AT EIGHTH",D$"RANK.YOU MAY NOW",D$"PROMOTE  IT TO A",D$"PIECE  OF HIGHER",D$"VALUE. PRESS ANY",D$"KEY TO DO SO.":GOSUB25:CLS:SCREEN1,.
21 FORJ=1TO4:X=2:Y=26+J*20:DRAW"BM0,0BR=X;BD=Y;C0XA$(J);":PAINT(X+10,Y+10),-(P=.),.:NEXT
22 J=JOYSTK(.):J=INT(JOYSTK(-2*(JN=2ANDP=1)+1)/16):H=2:V=46+J*20:IFPEEK(BN)=126ORPEEK(BN)=254ORPEEK(BN)=253THEN24
23 GET(H,V+11)-(H+7,V+19),A,G:DRAW"BM0,0BR=H;BD=V;BRBD18C1E3FEU2EULGL2GFG3RC0E5GND2L2":PUT(H,V+11)-(H+7,V+19),A,PSET:IFPEEK(BN)=126ORPEEK(BN)=254ORPEEK(BN)=253THEN24ELSE22
24 J=J+1:B(SX,SY)=J+P*6:DRAW"C1":LINE(.,26)-(21,126),PSET,BF:GOTO18
25 K$=INKEY$:IFK$=""THEN25ELSERETURN
26 X=INT(JOYSTK(-2*(JN=2ANDP=1))/8):Y=INT(JOYSTK(-2*(JN=2ANDP=1)+1)/8)
27 H=48+X*20:V=16+Y*20:GET(H,V+11)-(H+7,V+19),A,G:DRAW"BM0,0BR=H;BD=V;BRBD18C1E3FEU2EULGL2GFG3RC0E5GND2L2"
28 K$=INKEY$:IFK$=""THEN29ELSESOUND100,1:IFK$="Q"THENCLS:ENDELSEIFK$="N"THENPUT(H,V+11)-(H+7,V+19),A,PSET:GOTO13ELSEIFK$="R"THEN7ELSEIFK$="1"THENJN=1ELSEIFK$="2"THENJN=2ELSESOUND1,1:PUT(H,V+11)-(H+7,V+19),A,PSET:GOTO27
29 IFPEEK(BN)=126ORPEEK(BN)=254ORPEEK(BN)=253THENPUT(H,V+11)-(H+7,V+19),A,PSET:SOUND100,1:RETURNELSEJ=X:K=Y:X=INT(JOYSTK(-2*(JN=2ANDP=1))/8):Y=INT(JOYSTK(-2*(JN=2ANDP=1)+1)/8):IFX=J ANDY=K THEN28ELSEPUT(H,V+11)-(H+7,V+19),A,PSET:GOTO27
30 PO=C(P,PN):Y=INT(PO/8):X=PO-Y*8:NP=B(X,Y)+6*(P=1):C=-((INT(X/2)=X/2)=(INT(Y/2)=Y/2)):C=-(C=.):X=48+X*20:Y=16+Y*20:DRAW"BM0,0BR=X;BD=Y;C=C;XA$(NP);":PAINT(X+10,Y+10),-(P=.),C:RETURN
31 FORJ=.TO15:IFX+Y*8=C(P,J)THEN32ELSENEXT:STOP
32 PN=J:FORJ=.TO.:NEXT:RETURN
33 DATA BF6D2F2D5G2DR7UH2U5E2U2H2L3G,BF2BR3D6R2FD6G2DR7UH2U6ER2U6DGL2HULDGL2,BF5R2ER2E2FDFD6L2GD3F2DL7UE2U5HL3HLUER
34 DATA BR9BD2DGDGD3FD5G2DR7UH2U5EU3HUHU,BR9BD2DG2LGDF3D5G2DR7UH2U5E3UHLH2U,BR9BD2DG2HD4F2D5G2DR7UH2U5E2U4GH2U
35 DATA 7,6,0,1,8,6,0,2,9,6,0,3,10,6,0,4,11,6,0,5,9,6,0,3,8,6,0,2,7,6,0,1
