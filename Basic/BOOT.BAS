10 PCLEAR4:CLS
20 PRINT TAB(9);"* COLOR TEXT *"
30 PRINT:PRINT "SELECT LOAD TYPE...":PRINT
40 X=0:RESTORE
50 READ A$:IF A$<>"." THEN X=X+1:PRINT TAB(7);X;") ";A$:GOTO 50
60 DATA TOP OF 16K,TOP OF 32K,UPPER RAM,.
100 A=VAL(INKEY$):IF A<1 OR A>X THEN 100
110 ON A GOTO 200,300,400
120 NEW
200 CLEAR 200,&H34FF:LOADM "COLRTEXT":EXEC:GOTO 120
300 CLEAR 200,&H74FF:LOADM "COLRTEXT",&H4000:EXEC:GOTO 120
400 CLEAR 200,&H7F00
405 READ A$:IF A$<>"." THEN 405
410 FOR X=&H7F00 TO &H7F19:READ A$:A=VAL("&H"+A$):POKE X,A:NEXT
420 DATA 34,01,1A,50,8E,80,0,10,8E,FF,DE,A6,84,6F,21,A7,80,6F,20,8C,FF,0,25,F3,35,81
430 EXEC &H7F00:POKE &HFFDF,0
440 LOADM "COLRTEXT",&HAB00:EXEC
450 CLEAR 200,&H7FFF
460 GOTO 120
10 '--------------------
15 '  bbs-board system
20 '  preload bootfile
25 '--------------------
30 PCLEAR1:CLS
35 PRINT@33,"** BBS-BORD BULLETIN SYSTEM **"
40 CLEAR 512,&H7D00
45 LOADM "REMOTE2/SYS":EXEC
50 PRINT@33,"** BY:  MIKE JORGENSON 1986 **":FORX=1TO750:NEXT
55 PRINT@33,"*** BBS-BORD PRELOAD SETUP ***":PRINT:PRINT
60 LINEINPUT" DISABLE BREAK:     <Y/N> ?  ";Q$
65 IF Q$<>"N"THEN75
70 POKE &H7D00,0
75 LINEINPUT" CORNER DISPLAY:    <Y/N> ?  ";Q$
80 IF Q$<>"N"THEN90
85 POKE &H7D01,0
90 LINEINPUT" LINEFEEDS / CR:    <Y/N> ?  ";Q$
95 IF Q$<>"N"THEN105
100 POKE &H7D02,0
105 LINEINPUT" LOWERCASE INPUT:   <Y/N> ?  ";Q$
110 IF Q$<>"Y"THEN120
115 POKE &H7D04,2
120 LINEINPUT" UPPERCASE OUTPUT:  <Y/N> ?  ";Q$
125 IF Q$<>"Y"THEN135
130 POKE &H7D05,1
135 LINEINPUT" SCROLL TOP LINE:   <Y/N> ?  ";Q$
140 IF Q$<>"Y"THEN150
145 POKE &H7D08,32
150 PRINT:PRINT" CURSOR COLOR:   <ENTER=YELLOW>"
155 PRINT:PRINT"  1. YELLOW":PRINT"  2. GREEN       <INVISIBLE>":PRINT"  3. DARK BLUE":PRINT"  4. LIGHT BLUE":PRINT"  5. PURPLE":PRINT"  6. ORANGE":PRINT"  7. WHITE":PRINT"  8. RED":PRINT:PRINT:PRINT:PRINT
160 Q$=INKEY$:ON VAL(Q$)GOTO205,170,175,180,185,190,195,200
165 IFQ$=CHR$(13)THEN205 ELSE160
170 POKE &H7D06,143:GOTO205
175 POKE &H7D06,175:GOTO205
180 POKE &H7D06,223:GOTO205
185 POKE &H7D06,239:GOTO205
190 POKE &H7D06,255:GOTO205
195 POKE &H7D06,207:GOTO205
200 POKE &H7D06,191
205 RUN "BBS-BORD/SYS"
0 'DISK MASTER 3                   WRITTEN BY MIKE JORGENSON       COPYRIGHT (C) JANUARY 1991      BY FALSOFT, INC.
10 ' Disk Master 3
15 ' Boot Load File
20 ' Coco 3 Utility
25 ' Mike Jorgenson
30 '
35 PCLEAR1:CLEAR2500
40 RGB:WIDTH32:CLS0:P=1
45 IF PEEK(32762)=1THEN60
50 CLEAR2500,32762:POKE113,0
55 POKE32762,1:VERIFYOFF
60 D1=PEEK(2394):IFP=1THEN120
65 DSKI$ D1,17,18,Y$,Z$:V=VAL(MID$(Y$,1,1)):IFV=2THEN POKE57395,16:POKE57404,19:POKE57413,19
70 IFV<1 OR V>2THEN550
75 FORX=32763 TO 32767:K=K+2:POKEX,VAL(MID$(Y$,K,2)):NEXT
80 POKE32768,VAL(MID$(Y$,12,1))
85 VF = VAL(MID$(Y$,13,1))
90 LC = VAL(MID$(Y$,14,1))
95 TK = VAL(MID$(Y$,15,1))
100 SR = VAL(MID$(Y$,16,1))
105 DS = VAL(MID$(Y$,17,1))
110 PB = VAL(MID$(Y$,18,1))
115 '
120 X=32763:B1=PEEK(X)
125 F1=PEEK(X+1):FD=PEEK(X+2)
130 B2=PEEK(X+3):F2=PEEK(X+4)
135 TW=PEEK(X+5):PALETTE8,0:DIM FL$(78),GR(78):F$=STRING$(32,191):G$=STRING$(32,175):H$=CHR$(175)+STRING$(30,32)+CHR$(175)
140 ON ERR GOTO560:ON BRK GOTO580:PALETTE12,FD:PALETTE13,0:CLS
145 PRINT@0,F$:PRINT@32,F$:PRINT@3,"  <<< DISK MASTER 3 >>>  ";:PRINT@64,G$:FORX=96TO384 STEP32:PRINT@X,H$:NEXT:PRINT@416,G$;:PRINT@448,F$;:PRINT@482,"COPYRIGHT  <C>  JANUARY 1988";
150 '
155 IF P=1THEN355
160 IF VF=1THENVERIFYON
165 IF LC<>1THEN180
170 POKE &H167,57
175 POKE &HFF22,21
180 IF DS<>1THEN205
185 POKE &HD89D,1
190 POKE &HD89E,2
195 POKE &HD89F,65
200 POKE &HD8A0,66
205 IF SR=1THENSP=23:ST=3
210 IF SR=2THENSP=22:ST=2
215 IF SR=3THENSP=21:ST=1
220 IF SR=4THENSP=20:ST=0
225 IF SP<1THEN240
230 POKE &HD7C0,ST
235 POKE &HD816,SP
240 IF PB=1THENBP=87
245 IF PB=2THENBP=40
250 IF PB=3THENBP=18
255 IF PB=4THENBP=7
260 IF PB=5THENBP=3
265 IF PB=6THENBP=1
270 IF BP<1THEN280
275 POKE &H96,BP
280 IF TK<>1THEN355
285 TK=40:GR=TK*2-2
290 POKE &HD29D,TK
295 POKE &HD65F,TK
300 POKE &HD682,TK
305 POKE &HD44D,GR
310 POKE &HC735,GR
315 POKE &HC7BB,GR
320 POKE &HC7D0,GR
325 POKE &HC7EF,GR
330 POKE &HCD26,GR
335 POKE &HCEB5,GR
340 POKE &HD534,TK-1
345 POKE &HC75A,1
350 '
355 D$(1)="<1>  =  LOAD: Copy Master 3":D$(2)="<2>  =  LOAD: Edit Master 3":D$(3)="<3>  =  LOAD: Kill Master 3":D$(4)="<4>  =  LOAD: List Master 3"
360 D$(5)="<5>  =  LOAD: Sort Master 3":D$(6)="<6>  =  LOAD: Test Master 3":D$(7)="<7>  =  LOAD: Trak Master 3"
365 POKE65497,0:Q=0:FORX= 129TO321 STEP32:Q=Q+1:FORY= 1TO27:PRINT@X+Y,MID$(D$(Q),Y,1);:NEXTY,X
370 POKE65496,0:X=0:PRINT@391,"Enter A Choice ...";:PRINT@482,"  <F1>  <ALT>  <ESC>  <F2>  ";
375 Q$=INKEY$:IFQ$=""THEN520
380 A=ASC(Q$):IFA=4THEN405
385 IFA=103 OR A=226THEN410
390 IFA=64THEN430
395 Q=VAL(Q$):ON Q GOTO605,610,615,620,625,630,635
400 SOUND5,3:GOTO375
405 IF PEEK(2439)=255THENVERIFY OFF:PRINT@482,"Disk Verification Is Now Off";:GOTO420 ELSEVERIFY ON:PRINT@482,"Disk Verification Is Now On.";:GOTO420
410 IFTW=1THENTW=0 ELSETW=1
415 PRINT@482,"Text Display Width Is Now"TW*40+40;:POKE32768,TW
420 SOUND100,6:FORX=1TO1000
425 NEXT:GOTO370
430 PRINT@482,"View Disk Of What Drive: 0/3";:GOSUB540
435 Q=VAL(Q$):IFQ>3THEN370
440 PRINT@482,"Reading Directory Of Drive"Q;:DSKI$ Q,17,2,X$,Y$
445 DF=0:FORX=3TO9:DSKI$ Q,17,X,Y$,Z$:FORK=1TO128 STEP32:GOSUB450:NEXTK:Y$=Z$:FORK=1TO128 STEP32:GOSUB450:NEXTK,X:GOTO465
450 SB$=MID$(Y$,K,14):L$=LEFT$(SB$,1):IF ASC(SB$)>127 OR L$=CHR$(0)THENRETURN ELSEIFL$=CHR$(255)THEN465 ELSEDF=DF+1:Y=ASC(RIGHT$(SB$,1))+1:FL$(DF)=LEFT$(SB$,8)+"."+MID$(SB$,9,3)
455 GR(DF)=GR(DF)+1:Z=ASC(MID$(X$,Y,1)):IFZ<78THENY=Z+1:GOTO455
460 RETURN
465 IFDF<1THENPRINT@482,"NO FILES IN DISK'S DIRECTORY";:SOUND5,7:FORX=1TO1500:NEXT:GOTO370
470 K=1:F=FREE(Q)
475 POKE65497,0:ON ERR GOTO555
480 PALETTE0,B2:PALETTE8,F2
485 IFTW=1THENT$=STRING$(23,32):WIDTH80 ELSET$="   ":WIDTH40
490 CLS1:PRINTT$"      <<< Directory Of"Q">>>":LOCATE0,6
495 FORX=1TO DF:IF GR(X)<10THENFL$(X)=FL$(X)+" "+STR$(GR(X))ELSEFL$(X)=FL$(X)+STR$(GR(X))
500 IFK=1THENK=0:PRINTT$;FL$(X)" "; ELSEK=1:PRINT"   "FL$(X)
505 NEXT:IFK=1THENPRINTT$"Free ="F ELSEPRINT"   Free ="F:PRINT
510 PRINT:Q$=INKEY$:POKE65496,0
515 PRINTT$"  Press Any Key When Ready ... ";:GOSUB540:RUN
520 IFX=0THENX=1:PRINT@406,"   ";ELSEX=0:PRINT@406,"...";
525 FORK=1TO30:NEXT:GOTO375
530 SOUND5,7:FORX=1TO1650
535 NEXT:RETURN
540 Q$=INKEY$:IFQ$=""THEN540
545 RETURN
550 PRINT" << DISK MUST BE CONFIGURED! >>";:GOSUB530:EXEC40999
555 POKE65496,0:GOSUB530:GOTO570
560 POKE65496,0:IF ERNO=26THENPRINT@482,"File Not In Disk's Directory";:GOSUB530:RUN
565 PRINR@481,"System Function Error Detected";:GOSUB530
570 WIDTH32:PALETTE12,F1
575 PALETTE13,B1:END
580 WIDTH32:POKE65496,0
585 PALETTE12,F1:PALETTE13,B1
590 CLEAR200,32768:PRINT"  ENHANCED DISK EXTENDED BASIC    DISK MASTER 3 UTILITY SYSTEM    Mike Jorgenson / JAN 01 1988"
595 PCLEAR4:PRINT:PRINT:NEW
600 '
605 LOAD "COPY/SYS",R
610 LOAD "EDIT/SYS",R
615 LOAD "KILL/SYS",R
620 LOAD "LIST/SYS",R
625 LOAD "SORT/SYS",R
630 LOAD "TEST/SYS",R
635 LOAD "TRAK/SYS",R
640 ' *** END ***
1 'MASTER LIST                  ** WRITTEN BY PETER MASTERSON
2 'COPYRIGHT (C) FEBRUARY 1992  ** BY FALSOFT, INC.             ** RAINBOW MAGAZINE
3 CLEAR3000,29999
5 ST$=CHR$(202)+STRING$(30,32)+CHR$(197):LOADM"MLIST"
6 DATA NAME,NAME,CORP,ADRS,CITY,PROV,MISC,TEL#
7 FOR X=1TO8:READ F$(X):NEXT
10 DEFUSR0=30017:DEFUSR1=30113:    DEFUSR2=30091:DEFUSR3=30132:    DEFUSR4=30000:DEFUSR5=30057
12 M$(2,1)="aDD dEL eDIT fIND pRINT rEC sOR"
16 POKE150,41
18 CLS:PRINTTAB(10)"MASTER LIST":PRINT:PRINTTAB(1)"PROGRAMMED BY PETER MASTERSON":PRINTSTRING$(32,195);
19 EXEC30165:X=128
20 FOR Z=1TO8
22 PRINT@X,CHR$(202)F$(Z)CHR$(202)STRING$(25,32)CHR$(197);:X=X+32
23 NEXT:PRINT@383,CHR$(197);
30 PRINTSTRING$(32,195);:PRINT@416,ST$;:PRINTSTRING$(32,195);:SET(0,24,5):SET(63,24,5):SET(0,28,5):SET(63,28,5):SET(10,24,5)
32 PRINT@480,M$(2,1);:POKE1535,84:POKE7999,1
40 PRINT@417,"FILE"CHR$(202);
41 SET(10,28,5):EXEC30192
50 CLOSE:RUN"MLIST"
