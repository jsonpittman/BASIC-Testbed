10 '*****************************
20 '*      CASTLE ZHAGWHAR      *
30 '*     BY: KEITH SCHULER     *
40 '*                           *
50 '*     COPYRIGHT (C)1989     *
60 '*    FALSOFT INCORPORATED   *
70 '*****************************
80 POKE65495,0:X=RND(-TIMER):CLEAR150:PCLEAR2:PMODE1,1:PCLS:DIMRR(11,15),RL(11,15),ST(11,15),DU(11,15),FB(11,5),FL(40,8),BA(11,6),MA(5),MB(5),MO$(5),BL(11,15),PA(10),PB(10):CLS0:PRINT@192,"  ** PLEASE WAIT ONE MOMENT **  ";
90 DRAW"C3BM3,14E2U2RF2ND2H2LU4L2G2NDE2R2DNR4U4C2U2R2D2C3BM28,14H2U2LG2ND2E2RU4R2F2NDH2L2DNL4U4C2U2L2D2BM3,31C3U2E2F2ND2H2U4L2NG2R2R2NF2L2U2C2H2E2F2G2NU2":GET(31,0)-(20,15),RL,G:GET(0,0)-(11,15),RR,G:GET(0,16)-(11,31),ST,G
100 DRAW"C3BM1,47E4L2C2U2L2D2R2R2C3R4D2G2R4BM18,32D3G2H2NU3F2D4R2NE2L2L2NH2R2D2C2G2F2E2H2D2BM100,100NR11R2U2NR4D4NR4":GET(0,32)-(11,47),DU,G:GET(100,98)-(111,103),FB,G
110 LA$="C3D24NR8U4NR8U4NR8U4NR8U4NR8U4R8NU4D20":COLOR4:LINE(0,0)-(40,6),PSET,B:COLOR2:LINE(0,2)-(40,4),PSET,BF:FORT=0TO40STEP4:PSET(T,2,4):PSET(T+2,4,4):NEXTT:GET(0,0)-(40,6),FL,G
120 DRAW"C3BM100,50U2R4ND4R2ND4R4D2":GET(100,48)-(111,54),BA,G:PCLS:M$(1)="T8O3CDEFG":M$(2)="O1T100FGFGABABCD":M$(3)="O1T3L4CP96CL3FL4P24CFAP64CFAP64CFAFAO2CO1AFCP64CP96CL3F":M$(4)="O3T6CDEGP8DT5G"
130 DRAW"S4":PCLS3:FORT=80TO82:CIRCLE(T,60),18,2,1,.15,.65:CIRCLE(T+25,72),6,2,1,.15,.70:NEXTT:DRAW"BM80,60C2NU14ND14BL3BD4NU11L2NU11NM-3,+5R2U15E4R5NR5M+5,+4U2BM105,66NM-4,-6M+6,+4D5NM-6,+4NF4RNF4U12L2ND12NE4L2NE4NH2UH2NL4D2L8"
140 DRAW"BM122,78NM+18,-19E2R4UNL4R4D2NR6D2R4E4NU4L2U4NM-3,-2R2M-4,-2L6NL4U2L6NU4R2U6R2D2NL2U4NR4D2R8BE6BR8ND20G2ND18D2G2NR8G2NR10R4D12F4U2NH4NE2U2H4BU18BR14ND22R2ND22NE4L2NE4NH2D22F4U2NH4E2BR20BD2G2L8UNR6H2R2ND2NL4NU16L2U16M+4,-2NM+8,+4D2M+8,+4M-10,+8"
150 DRAW"BM30,90E4NM+6,+2D2M+6,+2M+18,-2NM-10,+12NM-14,+12M-12,+12BL8NG4NR16G2R16NE4L8NM-14,+12L2NM-12,+12M-10,+12NG2NM+18,-2M+18,-4L2F2NM+4,+4M+4,+2E4BF4NR6F2RNU24R2U24NE2L2NH2R2D10E6NM+4,+5D2M+4,+5ND16R2D16NM-8,+2U2M-8,+4"
160 FORT=91TO93:CIRCLE(T,111),6,2,1,.15,.70:NEXTT:DRAW"BM91,104NM-4,-6M+6,+4D5NM-6,+4NF4RNF4U12L2ND12NE4L2NE4NH2UH2NL4D2L8BR24BU2ND10R2ND10NR8E2R6ND15F2ND17R2NE2R2NE2L4D17M+4,+4L2NM-4,-4R2D4G2NL2U2L13NG2E2NR10R2BU12M+6,+3BR16U15M-2,-4NM+2,-4R2M+2,+4D15
170 DRAW"NM+6,+4L2M+8,+4E2U12NM-2,-4R2NM-2,-4D10NM+6,+4L2M+8,+4E2U12NM-2,-4R2NM-2,-4D10BR5BD2NR6F2RNU24R2U24NE2L2NH2R2D10E6NM+4,+5D2M+4,+5ND16R2D16NM-8,+2U2M-8,+4":FORT=190TO193:CIRCLE(T,111),6,2,1,.15,.70:NEXTT
180 DRAW"BM191,104NM-4,-6M+6,+4D5NM-6,+4NF4RNF4U12L2ND12NE4L2NE4NH2UH2NL4D2L8BR26ND15NH4R2NH4D15NF4D2NL2U15M+6,-5NF4ND2C1S8BM18,4NR4D2R4D2NL4BR2U4R4D2NL4BD2BR2U2E2F2NL4D2BR2NR4U4R4BR2NR4D2NR2D2R4BR2NR4U4R4BR2NR4D4R4NU4BR2U2E2F2NL4D2BR2R4U2L4U2R4BR2R4L2"
190 DRAW"D4BU4BR6BD4R4U2L4U2R4BR2ND4R4D4NL4BR2U2NR2U2R4BR2R4L2D4BR4NU4R2NU2R2NU4BR2U2NR4E2F2D2BR2U4R4D2L4R2F2BR2NR4U2NR2U2R4BM83,16ND4R4D2NL4U2BR2ND4R4D2L4R2F2BR2NR4U2NR2U2R4BR2NR4D2R4D2NL4BR2NR4U2NR2U2R4BR2ND4F4U4BR2R4L2D4BR4R4U2L4U2R4"
200 DRAW"BM36,150U4R3FGNL3FGNL3BR5U2NH2E2BR6D4U2R2NE2F2BR2NR4U2NR2U2R4BR2R4L2D4NL2R2BR4U4NL2R2BR2D4U2R4NU2D2BR6R4U2L4U2R4BR2NR4D4R4BR2U4D2R4NU2D2BR2NU4R4U4BR2D4R4BR2NR4U2NR2U2R4BR2ND4R4D2L4R2F2BM90,154GD2FBR2NR4U4R4BR2FD2GBR9U4BR2ND2R4D2NL4D2BR2"
210 DRAW"NR4U2NR4U2R4ND4BR2R4G2D2C4BM53,178ND4R4D2NL4U2BR2ND4R4D2L4R2F2BR2NR4U2NR2U2R4BR2NR4D2R4D2NL4BR2R4U2L4U2R4BR6BD4U2NR4E2F2D2BR2U4F4U4BR2F2NE2D2BR10U4D2R2NE2F2BR2NR4U2NR2U2R4BR2F2NE2D2":SCREEN1,1
220 FORT=1TO2500:A$=INKEY$:IFA$=""THENNEXTT
230 SCREEN0,0:DRAW"S4":SC=0:ST=250:S=1:WR=10:L1=63:L2=102:L3=143:L4=182:FF=0:WW=1:FG=0
240 IF(S=5 OR S=10)AND TI>1 THENST=250
250 TR=0:ON S GOTO 270,290,310,370,270,320,340,320,370,360,420
260 PMODE1,1:PCLS:SCREEN0,0:FORT=6TO220STEP40:PUT(T,61)-(T+40,67),FL,PSET:PUT(T,100)-(T+40,106),FL,PSET:PUT(T,141)-(T+40,147),FL,PSET:PUT(T,180)-(T+40,186),FL,PSET:NEXTT:COLOR2:LINE(0,0)-(255,20),PSET,B:PAINT(10,10),3,2:RETURN
270 GOSUB260:FORT=1TO3:READLX,LY:DRAW"BM"+STR$(LX)+","+STR$(LY)+LA$:NEXTT:DATA230,139,10,98,210,58,60,139,8,98,62,58,30,139,90,139,190,139,234,99,148,99,10,58,200,139,10,98,210,58
280 LINE(118,30)-(131,160),PRESET,BF:GOTO510
290 GOSUB260:FORT=1TO3:READLX,LY:DRAW"BM"+STR$(LX)+","+STR$(LY)+LA$:DRAW"BM"+STR$(LX+170)+","+STR$(LY)+LA$:NEXTT
300 LINE(82,70)-(166,190),PRESET,BF:GOTO510
310 GOSUB260:LINE(61,98)-(72,147),PRESET,BF:LINE(46,179)-(84,191),PRESET,BF:LINE(110,139)-(140,147),PRESET,BF:FORT=1TO6:READLX,LY:DRAW"BM"+STR$(LX)+","+STR$(LY)+LA$:NEXTT:LINE(169,99)-(200,110),PRESET,BF:GOTO510
320 GOSUB260:COLOR2:LINE(42,141)-(207,141),PSET:COLOR1:LINE(45,174)-(59,191),PSET,BF:LINE(90,174)-(98,191),PSET,BF:LINE(106,174)-(118,191),PSET,BF:LINE(170,174)-(158,191),PSET,BF:LINE(192,174)-(206,191),PSET,BF:LINE(55,136)-(195,147),PSET,BF
330 LINE(195,107)-(115,100),PSET,BF:LINE(50,58)-(70,68),PSET,BF:FOR T=1TO5:READLX,LY:DRAW"BM"+STR$(LX)+","+STR$(LY)+LA$:NEXTT:GOTO510:DATA230,139,10,98,38,58,230,58,74,58
340 GOSUB260:COLOR1:LINE(40,175)-(255,191),PSET,BF:LINE(45,134)-(59,151),PSET,BF:LINE(90,134)-(98,151),PSET,BF:LINE(106,134)-(118,151),PSET,BF:LINE(170,134)-(158,151),PSET,BF:LINE(192,134)-(206,151),PSET,BF:LINE(70,54)-(200,70),PSET,BF
350 LINE(135,90)-(200,120),PSET,BF:DRAW"C2BM245,100L12":FORT=1TO3:READLX,LY:DRAW"BM"+STR$(LX)+","+STR$(LY)+LA$:NEXTT:GOTO510:DATA205,58,220,98,10,139,230,139,10,98,38,58,230,58,74,58
360 GOSUB260:COLOR1:LINE(135,58)-(195,191),PSET,BF:LINE(65,58)-(79,160),PSET,BF:DRAW"C3BM37,180R14BM65,180R14BM88,180R14C2BM215,180R14":FORT=1TO3:READLX,LY:DRAW"BM"+STR$(LX)+","+STR$(LY)+LA$:NEXTT:GOTO510:DATA12,99,121,58,121,139
370 PCLS1:DRAW"S8BM70,90C3NR3D4R3EHNL3EHBR3NR4D4R4NU4BR2U4F4U4BR2D4R4U4BR2NR4D2R4D2NL4BR6U4R4D2L4R2F2BR2NR4U4R4D4BR2NR4U4R4D4BR2U4F2E2D4BR2BU4D2BD2RC1D":FORT=1TO65STEP4:COLOR2:LINE(T,T)-(256-T,192-T),PSET,B:COLOR4
380 LINE(T+2,T+2)-(256-(T-2),192-(T-2)),PSET,B:NEXTT:SCREEN1,0:PLAY"T4L4V31O3L16.;1;L32;1;L16.;1;L32;1;L16.;1;L32;1;L16.;1;L32;5;L16.;8;L32;5;L16.;8;L32;5;L16.;8;L32;5;L4;1":FORT=1TO500:NEXTT:LF=ST:TI=82:GOSUB260
390 DRAW"S4":COLOR4:LINE(0,24)-(80,24),PSET:COLOR1:LINE(100,139)-(130,147),PSET,BF:LINE(45,179)-(80,191),PSET,BF:LINE(148,90)-(200,147),PSET,BF:DRAW"BM11,139"+LA$:DRAW"BM136,139"+LA$:DRAW"BM86,139"+LA$:DRAW"BM136,99"+LA$:DRAW"BM204,99"+LA$
400 LINE(0,99)-(70,106),PRESET,BF:DRAW"BM236,59"+LA$:DRAW"BM74,59"+LA$
410 GOTO 510
420 GOSUB260:LINE(0,22)-(255,191),PRESET,BF:DRAW"S8C2BM36,34NR4D4R4BR2NR4U4R4D4BR2U4F4U4BR2BD4R4U2NL2D2L4U4R4BR2ND4R4D2L4R2F2BR2U2NR4E2F2D2BR4U4NL2R2BR2D4R4U4BR2D4R4BR2U2NR4E2F2D2BR4U4NL2R2BR2R4L2D4NL2R2BR2NR4U4R4D4BR2U4F4U4BR2BD4R4U2L4U2R4BR2D2BD2UC1R"
430 GOSUB660:PLAY"O2T5V31L1GCL2EGL3.AL4EL1AO3CL2DO2GO3L1C":DRAW"C4S8BM20,65R4L2D4BR4U4D2R4NU2D2BR2NR4U2NR2U2R4BR6D4R2NU2R2U4BR2R4L2D4NL2R2BR2NR4E4NL4BR2BD4U2NR4E2F2D2BR2U4R4D2L4R2F2BR2U4R3FD2GNL3BR7U4D2R4U2D4BR2U2NR4E2F2D2BR2R4U2L4U2R4BR6D4R3EHNL3EH
440 DRAW"NL3BR3NR4D2NR2D2R4BR2NR4U2NR2U2R4BR2ND4F4U4BM0,80NR4D2R4D2NL4BR2NU4R4U4BR2NR4D4R4BR2NR4U4R4BR2NR4D2NR2D2R4BR2R4U2L4U2R4BR2NR4D2R4D2NL4BR2U2NR2U2R4BR2D4R4U4BR2D4R4BR2NU4R4BR3U2NH2E2BR5D4R3EU2HNL3BR3NR4D2NR2D2R4BR2R4U2L4U2R4BR2R4L2D4BR4U4R4D2L4"
450 DRAW"R2F2BR2NR4U4R4D4BR4U2NH2E2BR2NR4D2NR2D2R4BR2NU4R3EU2HNL3C3":PLAY"O2AL2O3CO2AGABO3CO2F#AO3DCL4O2BP4L2GFD":DRAW"BM4,110U2NR4E2F2D2BR2U4F4U4BR2NR3D4R3EU2NHBUBR6F2NE2D2BR4NR4U4R4D4BR2NU4R4U4BR6NR4D2R4D2NL4"
460 DRAW"BR2U2NR4E2F2D2BR2U2NR2U2R4BR2NR4D2NR2D2R4BR2BU4D4R4BR4U2NH2E2BR4NR4D2NR2D2R4BR2R4U2L4U2R4BR2NR4D4R4BR2U2NR4E2F2D2BR2U4R4D2NL4U2BR2NR4D2NR2D2R4BR2NU4R3EU2HL3BM38,118NR4D4R4BR2U2NR4E2F2D2BR2R4U2L4U2R4BR2R4L2D4BR4NU4R4BR2NR4U2NR2U2R4BR6"
470 DRAW"R4G4R4BR2U4D2R4NU2D2BR2U2NR4E2F2D2BR2R4U2NL2D2L4U4R4BR2D4R2NU2R2U4BR2D4U2R4NU2D2BR2U2NR4E2F2D2BR2U4R4D2L4R2F2":PLAY"O3L1CL2EGL3AP4EL1AO4L1CL2DO3GO4L1C":DRAW"C4BM34,140D4R4BR2R4L2U4NL2R2BR2R4L2D4BR4U4D2R4NU2D2BR2U2NR4E2F2D2BR2U4F4U4BR2BD4U2NR4E2
480 DRAW"F2D2BR6R4L2U4NL2R2BR2NR4D2R4D2NL4BR6R4U2L4U2R4BR2BD4U2NR4E2F2D2BR2BU4D2F2E2U2BR2NR4D2NR2D2R4BR2NU4R3EU2HL3BR6D4UC1R":COLOR3:LINE(34,152)-(218,152),PSET:PLAY"O3AL2O4CO3AGABO4CL4EP8L8GL4F#GO4DP8O3L8GL4F#GL1O4CCC"
490 DRAW"C2BM85,170R4L2D4BR4U4D2R4NU2D2BR2NR4U2NR2U2R4BR6NR4D2NR2D2R4BR2U4F4U4BR2NR3D4R3EU2"
500 FORT=1TO6000:IF INKEY$="" THEN NEXT T:CLS:END ELSE CLS:END
510 PN=2:TR=0:ON S GOSUB 530,540,550,590,530,560,580,560,590,570:PB$="S2C3NR10U2L2NR14U2L2NR18U2L2NR22U2NR22U2NR22U2NR22U2NR22BU2BR2C2R18L2U2L14R2U2R10":FORT=1TO PN:DRAW"BM"+STR$(PA(T))+","+STR$(PB(T))+PB$:NEXTT
520 GOTO 600
530 TN(1)=0:TN(2)=0:TN(3)=0:PA(1)=100:PB(1)=179:PA(2)=190:PB(2)=99:X=10:Y=164:KA=20:KB=53:LA=235:LB=43:RETURN
540 PA(1)=40:PB(1)=99:PA(2)=184:PB(2)=99:X=10:Y=164:KA=128:KB=53:LA=190:LB=163:RETURN
550 PA(1)=50:PB(1)=139:PA(2)=128:PB(2)=99:X=10:Y=164:KA=210:KB=93:LA=235:LB=43:RETURN
560 RA=45:RB=124:PA(1)=100:PB(1)=99:PA(2)=10:PB(2)=59:X=10:Y=164:KA=140:KB=53:LA=198:LB=83:RETURN
570 PA(1)=238:PB(1)=99:PA(2)=238:PB(2)=139:X=10:Y=44:LA=7:LB=164:KB=53:KA=235:WY=Y:RETURN
580 PA(1)=238:PB(1)=99:PA(2)=238:PB(2)=139:X=35:Y=164:KA=50:KB=53:LA=235:LB=43:RA=12:RB=44:RETURN
590 PN=10:PA(1)=58:PB(1)=139:PA(2)=220:PB(2)=139:PA(3)=238:PB(3)=179:PA(4)=220:PB(4)=99:PA(5)=198:PB(5)=179:PA(6)=12:PB(6)=59:PA(7)=42:PB(7)=59:PA(8)=102:PB(8)=99:PA(9)=108:PB(9)=59:PA(10)=190:PB(10)=59:X=34:Y=164:LA=232:LB=123:KA=115:KB=173:RETURN
600 DRAW"S4BM"+STR$(KA)+","+STR$(KB)+"C2D4L2U2NU2R8D2":DRAW"BM"+STR$(LA)+","+STR$(LB)+"C3BD2ND13E2R7F2D13L9":PAINT(LA+2,LB+2),3,3:DRAW"BM"+STR$(LA+2)+","+STR$(LB+8)+"C1R2C3D":RN=0:BN=0:ON S GOTO 660,610,620,660,620,660,640,620,660,630
610 BN=2:BX(1)=10:BY(1)=44:BD(1)=1:BX(2)=230:BY(2)=44:BD(2)=0:GOTO650
620 BN=2:BX(1)=10:BY(1)=124:BD(1)=0:BX(2)=100:BY(2)=44:BD(2)=0:IF S=4 THEN BX(1)=31:GOTO650 ELSEIF S=7 THEN BY(1)=84:GOTO650 ELSE GOTO650
630 BN=4:BX(1)=70:BY(1)=84:BD(1)=1:BX(2)=120:BY(2)=44:BD(2)=0:BX(3)=100:BY(3)=124:BD(3)=1:BX(4)=100:BY(4)=164:BD(4)=1:GOTO650
640 BN=2:BX(1)=120:BY(1)=44:BD(1)=0:BX(2)=100:BY(2)=124:BD(2)=1:GOTO650
650 IFBN>0THENFORT=1TOBN:PUT(BX(T),BY(T))-(BX(T)+11,BY(T)+6),BA,PSET:NEXTT
660 DRAW"BM6,6C1S8NR4D2R4D2NL4BR2NR4U4R4BR2ND4R4D4NL4BR2U4R4D2L4R2F2BR2NR4U2NR2U2R4BR2BDRBD2LRC3U3BR40C1D4R4BR2R4L2U4NL2R2BR2NR4D2NR2D2BR6NR4U2NR2U2R4BR2BDRBD2LRC3U4":SCREEN1,0:FORT=200TOST:DRAW"BM"+STR$(T)+",13C1S4NU4":PLAY"T255L255O3A":PLAY"T4L4"
670 NEXTT:IFS=1THENDRAW"C2S8BM73,30NR4D4R4U2NL2D2BR2U4R4D4NL4BR2NR4U4R4D4BR2RU4NLR2FD2GNL2BR7NU4R4BR2NU4R4NU4BR2NR4U4R4BR2D4U2R2NE2F2BR3UBUU2D3C1R":PLAY"O2L4T20CP10DP10EP10P10CP10DP10EP10P10CP10DP10EP10P10T2GG":FORT=1TO1000:NEXTT
680 IFS=1 THEN LINE(73,30)-(200,40),PRESET,BF
690 PO=0:KC=0:GOSUB1180:IF S=11THEN RETURN ELSETIMER=0
700 A=JOYSTK(0):B=JOYSTK(1):IFA>10ANDA<53 AND B>10ANDB<53 AND PO=0AND PEEK(65280)<>126 AND PEEK(65280)<>256 THEN750
710 IF PEEK(65280)=254 OR PEEK(65280)=126 THEN780 ELSE 720
720 IFA<5 ANDX>7THENX=X-9:ST=ST-.2:GOSUB1220:PUT(X+9,Y)-(X+20,Y+15),BL,PSET:PUT(X,Y)-(X+11,Y+15),RL,PSET:PO=1:GOTO840
730 IFA<10 ANDX>2 THENX=X-4:PUT(X+4,Y)-(X+15,Y+15),BL,PSET:PUT(X,Y)-(X+11,Y+15),RL,PSET:PO=1:GOTO840
740 IFA>10ANDB>10ANDA<53ANDB<53THENPUT(X,Y)-(X+11,Y+15),ST,PSET:PO=0:GOTO840
750 IFA>58 AND X<233AND S<>4THEN X=X+9:ST=ST-.2:GOSUB1220:PUT(X-10,Y)-(X+5,Y+15),BL,PSET:PUT(X,Y)-(X+11,Y+15),RR,PSET:PO=2:GOTO840
760 IFA>53 ANDX<253-15THENX=X+4:PUT(X-4,Y)-(X+11,Y+15),BL,PSET:PUT(X,Y)-(X+11,Y+15),RR,PSET:PO=2:GOTO840
770 GOTO810
780 IF A<10 OR A>53 THEN 790 ELSEPUT(X,Y)-(X+11,Y+15),BL,PSET:PUT(X,Y-15)-(X+11,Y),ST,PSET:ST=ST-1:GOSUB1220:PLAY"T255O3;12;1":PUT(X,Y-15)-(X+11,Y),BL,PSET:PUT(X,Y)-(X+11,Y+15),ST,PSET:IFS=4 ORS=9 THENST=ST+1:GOTO840 ELSEGOTO840
790 IFA<10 THEN800ELSEIFX>217THEN860 ELSEPUT(X,Y)-(X+11,Y+15),BL,PSET:PUT(X+15,Y-15)-(X+26,Y),RR,PSET:ST=ST-1:GOSUB1220:PLAY"T255O3;12;1":PUT(X+13,Y-15)-(X+24,Y),BL,PSET:X=X+25:PUT(X,Y)-(X+11,Y+15),RR,PSET:IFS=4 ORS=9 THENST=ST+1:GOTO840ELSE840
800 IFX<29THEN 860 ELSEPUT(X,Y)-(X+11,Y+15),BL,PSET:PUT(X-26,Y-15)-(X-15,Y),RL,PSET:ST=ST-1:GOSUB1220:PLAY"T255O3;12;1":PUT(X-26,Y-15)-(X-15,Y),BL,PSET:X=X-25:PUT(X,Y)-(X+11,Y+15),RL,PSET:IFS=4 OR S=9 THEN ST=ST+1:GOTO840 ELSE840
810 IFB<10 AND PPOINT(X+5,Y-2)=3 THEN PUT(X,Y)-(X+11,Y+15),BL,PSET:Y=Y-40:PUT(X,Y)-(X+11,Y+15),ST,PSET:GOTO840
820 IFB>53 AND PPOINT(X+5,Y+19)=3THEN PUT(X,Y)-(X+11,Y+15),BL,PSET:Y=Y+40:PUT(X,Y)-(X+11,Y+15),ST,PSET:GOTO840
830 IFB>53 THEN PUT(X,Y)-(X+11,Y+15),BL,PSET:PUT(X,Y)-(X+11,Y+15),DU,PSET:PO=3:GOTO 840
840 IFST<243ANDRND(17+INT(L*1.5))=1 THEN DRAW"BM"+STR$(X+12)+","+STR$(Y+15)+"C4NU6R2NU10R2U6":PLAYM$(4):DRAW"C1D6L2NU10L2U6":ST=ST+INT(7/S):FORT=200TOST:DRAW"BM"+STR$(T)+",13NU4":NEXTT
850 IF S=4 ORS=9 THEN TI=TI-1:PSET(TI,24,1):IF TI<1 THEN TI=1
860 FOR T=1TO PN:IF(Y=PB(T)-15AND X=>PA(T)-3)AND(Y=PB(T)-15AND X=<PA(T)+7)THEN 870 ELSE NEXTT:GOTO890
870 TR=TR+1:DRAW"BM"+STR$(PA(T))+","+STR$(PB(T))+"S2C1NR10H2NR14H2NR18H2NR22U2NR22U2NR22U2NR22BE2R18H2L14E2R10":DRAW"BM"+STR$(PA(T))+","+STR$(PB(T)-2)+"S4C2U6BR4D6R4U6NL4BR4D6R4U6L4":PLAYM$(1):PA(T)=0:PB(T)=0:SC=SC+100:DRAW"C1R4D6L4U6L4NR4D6L4U6BL4D6"
880 GOSUB1180:GOTO700
890 IF Y+15=KB+6AND X=>KA-3AND Y+15=KB+6 AND X<=KA+7THEN 900ELSE910
900 KC=1:LINE(KA-2,KB)-(KA+12,KB+6),PRESET,BF:DRAW"C2BM"+STR$(KA)+","+STR$(KB)+"NR6F6NL6BR4U6R4D6NL4":PLAYM$(1):DRAW"C1NR4U6L4D6L4NL10H6R6":KA=0:KB=0:SC=SC+50:GOSUB1180:DRAW"C2BM136,4R4D2G2H2NU2F2D8NL2U2NL2":GOTO700
910 IFPPOINT(X+5,Y+19)=1 AND Y<160 THEN FORY=Y TO Y+40 STEP4:PUT(X,Y-8)-(X+11,Y+7),BL,PSET:PUT(X,Y)-(X+11,Y+15),ST,PSET:PLAY"T255O2C":NEXTY:PUT(X,Y-8)-(X+11,Y+7),BL,PSET:Y=Y-4:PUT(X,Y)-(X+11,Y+15),DU,PSET:FA=1:ST=ST-10:GOTO910
920 IF SC>3999 AND SC<4351 THEN FG=1
930 A$=INKEY$:IF FG=1AND A$=" "THENPLAYM$(4):PLAYM$(1):FG=0 ELSEGOTO950
940 FORT=1TO20:SCREEN1,1:PLAY"L255T255O3A":SCREEN1,0:NEXTT:RESTORE:FORT=1TO15:READLX,LY:NEXTT:S=6:ST=250:PCLS1:FORT=1TO20:SCREEN1,1:PLAY"A":SCREEN1,0:NEXTT:PLAY"L4T4":GOTO240
950 IFFA=1 ANDPPOINT(X+5,Y+19)<>1THEN FA=0:PLAY M$(2):GOSUB1220:GOTO700
960 IFPPOINT(X+5,Y+19)=1 AND Y>160 THEN ST=200:FORT=Y TO200 STEP4:PUT(X,T-4)-(X+11,T+11),BL,PSET:PUT(X,T)-(X+11,T+15),ST,PSET:NEXTT:PUT(X,T-4)-(X+11,T+11),BL,PSET:GOSUB1220:GOTO700
970 IFX=>LA ANDY=LB+1ANDX=<LA+11ANDKC=1THENPLAYM$(4):SC=SC+350:GOSUB1180:DRAW"S4":S=S+1:FORAA=1TO500:NEXTAA:IFST<245THENST=ST+5:GOTO240 ELSE240
980 IF(S=6ANDX>195ANDX<201AND Y=124) OR(S=7ANDX>233ANDX<246AND Y=84) OR(S=8ANDX>195ANDX<201AND Y=124)THEN 990 ELSE 1000
990 FORT=Y+15 TO Y STEP-2:PUT(X,Y)-(X+11,T),ST,PSET:PUT(RA,RB)-(RA+11,RB+15),ST,PRESET:PUT(RA,RB)-(RA+11,RB+15),ST,PSET:PLAY"L255T255O2A":NEXTT:LINE(X,Y)-(X+11,Y+15),PRESET,BF:X=RA:Y=RB:PLAY"L4T4"
1000 IFS<>WR OR WW=0THEN 1020 ELSEIF RND(3)<>1 THEN 1020 ELSE R=RND(4):RR=RND(115)+5:IFR=1 THEN RA=L1 ELSEIFR=2 THEN RA=L2 ELSEIFR=3 THEN RA=L3 ELSEIF R=4 THENRA=L4 ELSE1000
1010 CIRCLE(RR,RA),5,1:PAINT(RR,RA),1,1
1020 IF S=WR AND WW=1  AND FF=0 THEN FF=1:PUT(218,WY)-(229,WY+15),RL,PSET:COLOR2:LINE(231,WY)-(231,WY+15),PSET:FX=210:FY=Y+9
1030 IF S=WR AND FF=1 THEN PUT(FX,FY)-(FX+11,FY+5),BL,PSET:FX=FX-8:IF FX<=12 THEN FF=0 ELSEPUT(FX,FY)-(FX+11,FY+5),FB,PSET
1040 IF S=WR AND FF=1 AND Y=FY-9 AND X>=FX-4 AND X+11<=FX+15 THEN PLAY"T255L255O1FGT4L4":ST=ST-12:GOSUB1220:PUT(FX,FY)-(FX+11,FY+5),BL,PSET:FF=0
1050 IF S=WR AND WW=1 AND RND(6)=1 THEN ST=ST-RND(3):SCREEN1,1:PLAY"O5T255L255GL4T4":SCREEN1,0:GOSUB1220
1060 IFWW=1 AND S=WR THEN PUT(218,WY)-(229,WY+15),BL,PSET:LINE(216,WY)-(216,WY+15),PRESET:LINE(231,WY)-(231,WY+15),PRESET
1070 IFWW=1 AND S=WR THEN PUT(218,Y)-(229,Y+15),ST,PSET:COLOR2:LINE(216,Y)-(216,Y+15),PSET:WY=Y
1080 IFS<>WR ORY<>164THEN1100 ELSEIFX>53 ANDX=<74 THEN1090 ELSE IFX>=30 ANDX<=45 THEN1090 ELSE IFX=>84 ANDX=<100 THEN1090 ELSE 1100
1090 ST=200:FORT=1TO15:PUT(X,Y)-(X+11,Y+15),ST,PRESET:PLAY"L255T255O4D":PUT(X,Y)-(X+11,Y+15),RL,PRESET:PLAY"E":PUT(X,Y)-(X+11,Y+15),RR,PRESET:PLAY"F":PUT(X,Y)-(X+11,Y+15),BL,PSET:NEXTT:PLAY"T4L4":GOSUB1220
1100 IFY=164 ANDWW=1 AND S=WR THEN 1110 ELSE1130
1110 FORT=1TO7:PUT(218,Y)-(229,Y+15),BL,PSET:PUT(66,Y)-(77,Y+15),ST,PRESET:PUT(66,Y)-(77,Y+15),BL,PSET:PLAY"L255T255O2A":NEXTT:PLAY"L4T4":FORT=1TO15:PUT(66,Y)-(77,Y+15),ST,PRESET:PUT(66,Y)-(77,Y+15),RL,PRESET:PUT(66,Y)-(77,Y+15),RR,PRESET
1120 PUT(66,Y)-(77,Y+15),BL,PSET:PLAY"L255T255O4DEF":NEXTT:WW=0:PLAY"L4T4":COLOR4:LINE(132,63)-(195,61),PSET,B:LINE(132,103)-(195,101),PSET,B:LINE(132,143)-(195,141),PSET,B:LINE(216,Y)-(216,Y+15),PRESET
1130 TM=4100-S*85:IFTIMER>TM ANDWW=1 ANDS<>4 AND S<>9 THENGOSUB1290
1140 IFBN=0THEN700 ELSEFOR T=1 TOBN:IF X<BX(T)+13 AND X+13>BX(T) AND PO<>3 AND Y=BY(T) THEN ST=ST-5:PLAY"T255O4A":GOSUB1220:NEXTT:GOTO1150 ELSE NEXTT:GOTO1150
1150 FORT=1TO BN:IFBD(T)=1THENBX(T)=BX(T)+4:PUT(BX(T)-4,BY(T))-(BX(T)+7,BY(T)+6),BL,PSET:GOTO1160ELSE BX(T)=BX(T)-4:PUT(BX(T)+11,BY(T))-(BX(T)+26,BY(T)+6),BL,PSET
1160 PUT(BX(T),BY(T))-(BX(T)+11,BY(T)+6),BA,PSET:IFBD(T)=0 THEN1170 ELSEIFPPOINT(BX(T)+13,BY(T)+6)<>1 ORBX(T)>=242 THENBD(T)=0:PUT(BX(T),BY(T))-(BX(T)+11,BY(T)+6),BL,PSET:BX(T)=BX(T)-11:NEXTT:GOTO700ELSENEXTT:GOTO700
1170 IF PPOINT(BX(T)-2,BY(T)+6)<>1 OR BX(T)<=5 THEN BD(T)=1:PUT(BX(T),BY(T))-(BX(T)+11,BY(T)+6),BL,PSET:BX(T)=BX(T)+11:NEXTT:GOTO700 ELSENEXTT:GOTO700
1180 SC$=STR$(SC):TT=LEN(SC$):COLOR3:LINE(70,3)-(130,17),PSET,BF:DRAW"S8BM70,6C1":FORT=1TOTT:C$=MID$(SC$,T,1)
1190 IFC$="0"THENDRAW"R4D4L4NU4BE4BR2"ELSEIFC$="1"THENDRAW"BR2D4BR4BU4"ELSEIFC$="2"THENDRAW"R4D2L4D2R4BU4BR2"ELSEIFC$="3"THENDRAW"R4D2NL2D2NL4BU4BR2"ELSEIFC$="4"THENDRAW"D2R3NU2NRD2BR3BU4"ELSEIFC$="5"THENDRAW"NR4D2R4D2NL4BU4BR2"
1200 IFC$="6"THENDRAW"NR4D4R4U2NL4BU2BR2"ELSEIFC$="7"THENDRAW"R4G2D2BR4BU4"ELSEIFC$="8"THENDRAW"R4D4L4U2NU2R4U2BR2"ELSEIFC$="9"THENDRAW"R4D4NL4U2L4U2BR6"
1210 NEXTT:DRAW"S4":RETURN
1220 COLOR3:IFST<200 THEN ST=200
1230 LINE(250,2)-(ST,16),PSET,BF:IF ST=200 THEN 1240 ELSE RETURN
1240 PUT(X,Y)-(X+11,Y+15),BL,PSET:DRAW"C2BM"+STR$(X)+","+STR$(Y-4)+"BR6D2NR2NL2D6R6NR2NU2ND2L12NL2NU2ND2R6D10NL2NR2":PLAYM$(3)
1250 DRAW"S8BM75,30NR4D4R4U2L2BU2BR4BR2G2D2U2R4NH2D2BR2U4F2E2D4BR2NR4U2NR2U2R4BR6ND4R4D4NL4BR2BR2H2NU2F2E2U2BR2NR4D2NR2D2R4BR2U4R4D2L4R2F2":A$=INKEY$:IFA$=""THEN1260 ELSESCREEN0,0:PMODE1,1:PCLS:RESTORE:GOTO230
1260 DRAW"S8C2BM53,70NR4D4U2R4U2BR2NR4D4U2R4NU2L2F2BR2NR4U2NR2U2R4BR2NR4D2R4D2NL4BR2R4U2L4U2R4BR6BD2ND2NR4E2F2D2BR2U4F4U4BR2F2NE2D2BR10U4D2R2NE2F2BR2NR4U2NR2U2R4BR2F2NE2D2":A$=INKEY$:IFA$=""THEN1270ELSESCREEN0,0:PMODE1,1:PCLS:RESTORE:GOTO230
1270 DRAW"S8C2BM55,110R4L2D4BR4U4R4D4NL4BR6U4R4D2NL4U2BR2D4R4BR2BU4BD2ND2NR4E2F2D2BR4U2NH2E2BR6BD2ND2NR4E2F2D2BR2R4U2NL2D2L4U4R4BR2BD2ND2NR4E2F2D2BR2R4L2U4NL2R2BR2ND4F4U4":A$=INKEY$:IFA$=""THENDRAW"C"+STR$(RND(3)+1):GOTO1250
1280 SCREEN0,0:PMODE1,1:PCLS:RESTORE:GOTO230
1290 ST=ST-2:GOSUB1220:PLAY"T255L255O3GL4T4":RETURN
