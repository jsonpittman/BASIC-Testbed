5000 REM*************************
5001 REM* CALCULATOR SUBROUTINE *
5002 REM*************************
5003 DIMP(90):CF$="######.#"
5004 DATA129,131,131,131,131,131,131,131,131,130,133,96,96,96,96,96,96,96,96,138,132,140,140,140,140,140,140,140,140,136,32,49,128,50,32,32,51,32,52,32 
5005 DATA32,53,32,54,32,32,55,32,56,32,32,57,32,48,32,32,32,32,61,32
5006 DATA32,43,32,45,32,32,47,32,42,32
5007 DATA32,32,32,32,32,32,32,32,32,32,3,1,12,3,21,12,1,20,15,18
5008 Y=992:A=0 
5009 FORX=Y+208 TO Y+217:P(A)=PEEK(X):READXX:POKEX,XX
5010 A=A+1:NEXTX
5011 Y=Y+32:IFY>1279 GOTO 5012 ELSE GOTO5009
5012 Y=0:B$="":D$="":O$="":C$=""
5013 C$=INKEY$:IF C$=""THEN5013
5014 PRINT@209+Y,C$;:B$=B$+C$:Y=Y+1
5015 IF C$="*" OR C$="/" OR C$="+" OR C$="-" THEN PRINT@209,"       "C$;:O$=C$:GOTO 5017
5016 GOTO5013
5017 Y=0
5018 C$=INKEY$:IFC$=""THEN5018
5019 PRINT@209+Y,C$;:D$=D$+C$:Y=Y+1
5020 IF C$="=" AND O$="*" THEN A=(VAL(B$))*(VAL(D$)):GOTO5025
5021 IF C$="=" AND O$="/" THEN A=(VAL(B$))/(VAL(D$)):GOTO5025
5022 IF C$="=" AND O$="+" THEN A=(VAL(B$))+(VAL(D$)):GOTO5025
5023 IF C$="=" AND O$="-" THEN A=(VAL(B$))-(VAL(D$)):GOTO5025
5024 GOTO5018
5025 PRINT@209,USINGCF$;A;
5026 C$=INKEY$:IFC$=""THEN5026
5027 IFC$="C" THEN PRINT@209,"        ";:GOTO 5012   
5028 IFC$=CHR$(32) GOTO5030
5029 GOTO 5026
5030 Y=992:A=0
5031 FORX=Y+208 TO Y+217:POKEX,P(A)
5032 A=A+1:NEXTX
5033 Y=Y+32:IFY>1279 THEN END ELSE GOTO 5031
