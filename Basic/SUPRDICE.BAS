1 'SUPERDICE
2 'BY DAVID SCHALLER
3 'COPYRIGHT (C) JULY 1991
4 'BY FALSOFT, INC.
5 'RAINBOW MAGAZINE
10 REM *************************
20 REM *       SUPERDICE       *
30 REM *      VERSION 4.0      *
40 REM *   BY DAVID SCHALLER   *
50 REM *        1/12/91        *
60 REM *************************
70 CLEAR550
80 DIMA$(6,4),S(4,6),U(4,7)
90 C$=CHR$(207):D$=CHR$(205):E$=CHR$(203)
100 F$=CHR$(206):G$=CHR$(202):H$=CHR$(204):I$=CHR$(200)
110 Y$=CHR$(128)
120 A$(1,1)=C$+C$+C$+G$
130 A$(1,2)=C$+F$+C$+G$
140 A$(1,3)=A$(1,1)
150 A$(1,4)=H$+H$+H$+I$
160 A$(2,1)=C$+C$+F$+G$
170 A$(2,2)=A$(1,1)
180 A$(2,3)=F$+C$+C$+G$
190 A$(2,4)=H$+H$+H$+I$
200 A$(3,1)=F$+C$+C$+G$
210 A$(3,2)=C$+F$+C$+G$
220 A$(3,3)=C$+C$+F$+G$
230 A$(3,4)=H$+H$+H$+I$
240 A$(4,1)=F$+C$+F$+G$
250 A$(4,2)=C$+C$+C$+G$
260 A$(4,3)=F$+C$+F$+G$
270 A$(4,4)=H$+H$+H$+I$
280 A$(5,1)=F$+C$+F$+G$
290 A$(5,2)=C$+F$+C$+G$
300 A$(5,3)=F$+C$+F$+G$
310 A$(5,4)=A$(4,4)
320 A$(6,1)=F$+C$+F$+G$
330 A$(6,2)=A$(6,1):A$(6,3)=A$(6,1):A$(6,4)=A$(4,4)
340 REM SET UP FOR GAME
350 CLS4
360 HH=RND(-TIMER)
370 FOR I=1 TO 5:D(I)=RND(6):NEXT I
380 CO=1:FOR I=34 TO 58 STEP6:DD=D(CO):L=I:GOSUB1800:PRINT@I+160,CO;:CO=CO+1:NEXTI
390 PRINT@262,"welcome"+CHR$(128)+"to"+CHR$(128)+"superdice";
400 PLAY"O3V27L26CDEFGABO4CO3CO2BAGFEDC"
410 PRINT@295,"COPYRIGHT (C) 1991";:PRINT@295+32,"BY  DAVID SCHALLER";
420 FORZ1=1TO500:NEXTZ1
430 PRINT@388,"HOW MANY PLAYERS?  (1-4)";:SOUND170,1
440 Q$=INKEY$:IFQ$=""THEN440
450 Q=VAL(Q$):IFQ<1 OR Q>4 THEN430
460 SOUND200,1
470 GOSUB1880
480 FOR LP=1 TO Q
490 PRINT@256+LP*32,STRING$(32,32);
500 PRINT@256+(LP*32),"PLAYER"+STR$(LP)+">";
510 LINEINPUT P$(LP)
520 IFP$(LP)="" THEN500
530 NEXTLP
540 FORLP=1TO300:NEXTLP
550 GOSUB1880
560 T=1
570 'BEGIN PLAY********
580 GOSUB3830
590 IF PU=1 THEN2830
600 RL=1
610 '
620 FOR C4=1 TO5:RR(C4)=1:NEXTC4
630 IF DV(T)=1 THEN1690
640 PRINT@288,"player"+Y$;:POKE1319,48+T:POKE1320,58:PRINT@297,P$(T);
650 IF F2=1 THEN F2=0:GOTO710
660 IFRL=1 THENPRINT@358,"press"+Y$+"enter"+Y$+"to"+Y$+"roll";
670 IFRL>1 THENPRINT@352,"which"+Y$+"ones"+Y$+"to"+Y$+"roll"+Y$+"again";:POKE1400,63
680 IFRL>1 THENCO=49:FOR I=34 TO 58STEP6:PRINT@I+160," "+CHR$(CO)+" ";:CO=CO+1:NEXT I
690 IFRL>1 THEN GOSUB3590
700 IF RL>1 THEN F2=1:GOSUB1880:GOTO640
710 IFRL>1 THENPRINT@358,"press"+Y$+"enter"+Y$+"to"+Y$+"roll";
720 Q$=INKEY$
730 CO=49:FOR I=34 TO 58 STEP6:IFRR(CO-48)=1 THENPRINT@I+160,">"+CHR$(CO)+"<";ELSEPRINT@I+160," "+CHR$(CO)+" ";
740 CO=CO+1:NEXT I:BL$=""
750 FOR C5=1 TO LEN(P$(T))
760 BL$=BL$+CHR$(ASC(MID$(P$(T),C5,1))+32)
770 NEXT C5:C5=0
780 FOR C6=1 TO 12
790 Q$=INKEY$
800 IFQ$=CHR$(13) THENPRINT@297,BL$;:GOTO870
810 IFQ$="S" THEN2500
820 IFQ$="N" AND RL>1 THEN GOSUB1880:GOTO640
830 NEXT C6
840 IFC5=0 THENPRINT@297,BL$; ELSEPRINT@297,P$(T);
850 C5=1-C5
860 GOTO780
870 PRINT@428,"ROLLING";
880 'ROLLING SEQUENCE
890 L=34
900 GOTO2730
910 GOSUB1880
920 REM **** DISPLAY OPTION BOARDS ****
930 A1=279
940 FOR C5=266 TO 426 STEP32:PRINT@C5,STRING$(13,32);:NEXTC5
950 PRINT@256,STRING$(9,32);:PRINT@288,STRING$(9,32);
960 PRINT@320,STRING$(9,32);
970 PRINT@266,"(1'S)=1 :"S(T,1);
980 PRINT@298,"(2'S)=2 :"S(T,2);
990 PRINT@330,"(3'S)=3 :"S(T,3);
1000 PRINT@362,"(4'S)=4 :"S(T,4);
1010 PRINT@394,"(5'S)=5 :"S(T,5);
1020 PRINT@426,"(6'S)=6 :"S(T,6);
1030 PRINT@459,"next"+Y$+Y$+"table";
1040 S1=0:FOR C5=1 TO 6:S1=S1+S(T,C5):NEXT C5
1050 S2=0:FOR C5=1 TO 7:S2=S2+U(T,C5):NEXT C5
1060 PRINT@256,"TT:"S1;
1070 PRINT@288,"GT:"S1+S2;
1080 PRINT@320,"DT:"D(1)+D(2)+D(3)+D(4)+D(5);
1090 PRINT@A1,Y$;:A1=279
1100 PRINT@A1,CHR$(95);
1110 Q$=INKEY$
1120 EXEC44539:Q$=INKEY$
1130 IFQ$=CHR$(13) THENPRINT@A1,CHR$(127);:GOTO1210
1140 PRINT@A1,Y$;
1150 IFQ$=CHR$(94) THENA1=A1-32
1160 IF Q$="N" THEN1250
1170 IFQ$=CHR$(10) THENA1=A1+32
1180 IF A1<279 THEN A1=471
1190 IF A1>471 THEN A1=279
1200 GOTO1100
1210 SL=A1/32-7:SL=INT(SL)
1220 IF SL=7 THEN1250
1230 IF S(T,SL)<>0 THENPLAY"T255L255O1AAAAAAAAAAAAA":GOTO1100
1240 GOTO1920
1250 'SECOND TABLE*********
1260 GOSUB1880:A1=284
1270 FOR C5=266 TO 458 STEP32:PRINT@C5,STRING$(18,32);:NEXT C5
1280 PRINT@256,STRING$(9,32);:PRINT@288,STRING$(9,32);
1290 PRINT@320,STRING$(9,32);
1300 PRINT@266,"3 OF A KIND :";U(T,1);
1310 PRINT@298,"4 OF A KIND :";U(T,2);
1320 PRINT@330," FULL HOUSE :";U(T,3);
1330 PRINT@362,"SM.STRAIGHT :";U(T,4);
1340 PRINT@394,"LG.STRAIGHT :";U(T,5);
1350 PRINT@426," SUPERDICE! :";U(T,6);
1360 PRINT@458,"     CHANCE :";U(T,7);
1370 IFRL<>3 THENPRINT@493,"roll"+Y$+"again"; ELSEPRINT@493,"next"+Y$+"table";
1380 PRINT@256,"TT:"S2;
1390 PRINT@288,"GT:"S1+S2;
1400 PRINT@320,"DT:"D(1)+D(2)+D(3)+D(4)+D(5);
1410 PRINT@A1,Y$;:A1=284
1420 PRINT@A1,CHR$(95);
1430 Q$=INKEY$
1440 EXEC44539:Q$=INKEY$
1450 IF Q$=CHR$(13) THENPRINT@A1,CHR$(127);:GOTO1530
1460 PRINT@A1,Y$;
1470 IF Q$=CHR$(94) THEN A1=A1-32
1480 IF Q$="N" THEN910
1490 IF Q$=CHR$(10) THEN A1=A1+32
1500 IF A1<284 THEN A1=508
1510 IF A1>508 THEN A1=284
1520 GOTO1420
1530 SL=A1/32-7:SL=INT(SL)
1540 IF SL=8 THEN1570
1550 IF SL=6 AND U(T,SL)<>-1 THEN1590
1560 IF U(T,SL)<>0 THENPLAY"O1T255L255O1AAAAAAAAAAAA":GOTO1420
1570 IF SL=8 AND RL<3 THEN RL=RL+1:GOSUB1880:GOTO640
1580 IF SL=8 AND RL=3 THENGOSUB1880:GOTO920
1590 REM ORDER ROLL
1600 FOR C5=1 TO 5
1610 E(C5)=D(C5)
1620 NEXT C5
1630 FOR C5=1 TO 4
1640 IF E(C5)<=E(C5+1) THEN1660
1650 Z=E(C5):E(C5)=E(C5+1):E(C5+1)=Z:GOTO1630
1660 NEXT C5
1670 ON SL GOSUB2010,2080,2140,2200,2330,2380,2470
1680 GOSUB1880:RL=1
1690 T=T+1:IF T>Q THEN T=1
1700 IF T=1 THEN570 ELSE600
1710 GOTO1710
1720 REM **********
1730 REM **********
1740 REM **********
1750 REM **********
1760 REM **********
1770 REM SUBROUTINES
1780 REM **********
1790 REM **********
1800 'PRINT DIE AT (L) LOCATION
1810 'DIE TO PRINT IS (DD)
1820 C2=1
1830 FOR K=L TO L+96 STEP32
1840 PRINT@K,A$(DD,C2);
1850 C2=C2+1
1860 NEXTK
1870 RETURN
1880 'CLEAR SCREEN PRINT AREA
1890 FOR LP=256TO448STEP32:PRINT@LP,STRING$(32,128);
1900 NEXTLP:PRINT@480,STRING$(31,128);:POKE1535,128
1910 RETURN
1920 REM COUNT AND ADD ONLY(SL)
1930 CX=0
1940 FOR C5=1 TO 5
1950 IF D(C5)=SL THEN CX=CX+SL
1960 NEXT C5
1970 IF CX=0 THEN S(T,SL)=-1:FORC6=1TO5:SOUND1,1:NEXTC6 ELSE S(T,SL)=CX:SOUND205,4
1980 RL=1:GOSUB1880
1990 GOTO1690
2000 GOTO570
2010 '3 OF A KIND
2020 IF E(1)=E(2) AND E(1)=E(3) THEN2060
2030 IF E(2)=E(3) AND E(2)=E(4) THEN2060
2040 IF E(3)=E(4) AND E(3)=E(5) THEN2060
2050 FOR C6=1 TO5:SOUND1,1:NEXTC6:U(T,SL)=-1:RETURN
2060 U(T,SL)=D(1)+D(2)+D(3)+D(4)+D(5)
2070 SOUND205,4:RETURN
2080 '4 OF A KIND
2090 IF E(1)=E(2) AND E(1)=E(3) AND E(1)=E(4) THEN2120
2100 IF E(2)=E(3) AND E(2)=E(4) AND E(2)=E(5) THEN2120
2110 FOR C6=1 TO5:SOUND1,1:NEXTC6:U(T,SL)=-1:RETURN
2120 U(T,SL)=D(1)+D(2)+D(3)+D(4)+D(5)
2130 SOUND205,4:RETURN
2140 'FULL HOUSE
2150 IF E(1)=E(2) AND E(1)=E(3) AND E(4)=E(5) THEN2180
2160 IF E(1)=E(2) AND E(3)=E(4) AND E(3)=E(5) THEN2180
2170 FOR C6=1 TO5:SOUND1,1:NEXTC6:U(T,SL)=-1:RETURN
2180 U(T,SL)=25
2190 SOUND205,4:RETURN
2200 'SM.STRAIGHT
2210 FOR C6=1 TO 6:X3(C6)=0:NEXT C6
2220 FOR C6=1 TO 5
2230 FOR C7=1 TO 6
2240 IF E(C6)=C7 THEN X3(C7)=1
2250 NEXTC7
2260 NEXTC6
2270 IF X3(1)=1 AND X3(2)=1 AND X3(3)=1 AND X3(4)=1 THEN2310
2280 IF X3(2)=1 AND X3(3)=1 AND X3(4)=1 AND X3(5)=1 THEN2310
2290 IF X3(3)=1 AND X3(4)=1 AND X3(5)=1 AND X3(6)=1 THEN2310
2300 FOR C6=1TO5:SOUND1,1:NEXTC6:U(T,SL)=-1:RETURN
2310 U(T,SL)=30
2320 SOUND205,4:RETURN
2330 'LG.STRAIGHT
2340 IF E(5)-1=E(4) AND E(4)-1=E(3) AND E(3)-1=E(2) AND E(2)-1=E(1) THEN2360
2350 FOR C6=1 TO5:SOUND1,1:NEXTC6:U(T,SL)=-1:RETURN
2360 U(T,SL)=40
2370 SOUND204,5:RETURN
2380 'SUPERDICE!
2390 IF E(1)=E(2) AND E(1)=E(3) AND E(1)=E(4) AND E(1)=E(5) THEN2410
2400 FOR C6=1 TO5:SOUND1,1:NEXTC6:U(T,SL)=-1:RETURN
2410 IFU(T,SL)>0 THENU(T,SL)=U(T,SL)+100 ELSE U(T,SL)=50
2420 PLAY"T3L16V28O4CP16O3GP16O4CP16O3FP16O4CP16O3"
2430 PLAY"E-DE-DCP16L8O4E-L16DP16L4GL8C"
2440 PLAY"O3L16BABAGABG;L16O4CP16O3GP16FP16O4DP16L16O3"
2450 PLAY"E-DE-DCP16O4E-FGP16CP16O3GP16BP16L2O4C"
2460 RETURN
2470 'CHANCE
2480 U(T,SL)=D(1)+D(2)+D(3)+D(4)+D(5)
2490 SOUND204,5:RETURN
2500 GOSUB1880:PRINT@288,CHR$(123)+"scores"+CHR$(125);
2510 FOR C5=1 TO Q
2520 SX(C5)=S(C5,1)+S(C5,2)+S(C5,3)+S(C5,4)+S(C5,5)+S(C5,6)+U(C5,1)
2530 SX(C5)=SX(C5)+U(C5,2)+U(C5,3)+U(C5,4)+U(C5,5)+U(C5,6)+U(C5,7)
2540 NEXT C5
2550 FOR C5=1 TO Q:X$(C5)=P$(C5):NEXTC5
2560 IF Q=1 THEN2620
2570 FOR C5=1 TO Q-1
2580 IF SX(C5)>=SX(C5+1) THEN2610
2590 GG$=X$(C5):OE=SX(C5):X$(C5)=X$(C5+1):SX(C5)=SX(C5+1):X$(C5+1)=GG$:SX(C5+1)=OE
2600 GOTO2570
2610 NEXT C5
2620 FOR C5=1 TO Q
2630 IF LEN(P$(C5))>10 THEN R6$=LEFT$(X$(C5),10) ELSE R6$=X$(C5)+STRING$(10-LEN(X$(C5)),32)
2640 R6$=R6$+":"+STR$(SX(C5))
2650 PRINT@288+(32*C5),STRING$(32,32);
2660 PRINT@288+(32*C5),R6$;
2670 NEXTC5
2680 PRINT@452,"press"+Y$+"any"+Y$+"key"+Y$+"to"+Y$+"continue";
2690 Q$=INKEY$
2700 EXEC44539
2710 GOSUB1880
2720 IF RL>1 THEN F2=1:GOTO640 ELSE640
2730 G=1:PLAY"V20T255L255O1"
2740 IF RR(G)=0 THEN2810
2750 HH=RND(-TIMER)
2760 FOR C5=1 TO RND(10)+2
2770 PLAY"A"
2780 D(G)=RND(6):DD=D(G):GOSUB1800
2790 '
2800 NEXT C5
2810 SOUND G*10+20,2:L=L+6
2820 G=G+1:IFG=6 THEN910 ELSE2740
2830 'END OF GAME
2840 CLS0
2850 FOR X=0 TO 15
2860 POKE1024+X,42:POKE1055-X,42
2870 POKE1504+X,42:POKE1535-X,42
2880 POKE1024+(X*32),42:POKE1504-(X*32),42
2890 POKE1055+(X*32),42:POKE1535-(X*32),42
2900 NEXTX
2910 PP$="SUPERDICE FINAL STANDINGS:":WW=67:GOSUB3310
2920 ZA=1
2930 FOR C5=1 TO Q
2940 IFLEN(P$(C5))>7 THEN X$(C5)=LEFT$(P$(C5),7) ELSE X$(C5)=P$(C5)
2950 Z4=S(C5,1)+S(C5,2)+S(C5,3)+S(C5,4)+S(C5,5)+S(C5,6)
2960 Z5=U(C5,1)+U(C5,2)+U(C5,3)+U(C5,4)+U(C5,5)+U(C5,6)+U(C5,7)
2970 FS(C5)=Z4+Z5
2980 IF Z4>59 THEN FS(C5)=FS(C5)+35:BN(C5)=1 ELSE BN(C5)=0
2990 NEXT C5
3000 IF Q=1 THEN3070
3010 FOR C5=1 TO Q-1
3020 IF FS(C5)>=FS(C5+1) THEN3060
3030 KO=BN(C5):GG$=X$(C5):OE=FS(C5):X$(C5)=X$(C5+1):FS(C5)=FS(C5+1)
3040 X$(C5+1)=GG$:FS(C5+1)=OE:BN(C5)=BN(C5+1):BN(C5+1)=KO
3050 GOTO3010
3060 NEXT C5
3070 FOR LK=129 TO 129+(32*(Q-1)*2) STEP64
3080 PP$=STRING$(8-LEN(X$(ZA)),128)+X$(ZA)+":":WW=LK:GOSUB3310
3090 IF BN(ZA)=1 THEN PP$=STR$(FS(ZA)-35) ELSE PP$=STR$(FS(ZA))
3100 IF BN(ZA)=0 THENPP$=PP$+" -NO BONUS"
3110 IF BN(ZA)=1THENPP$=PP$+" +++ BONUS"
3120 GOSUB3310
3130 WW=LK+24
3140 PP$="="+STR$(FS(ZA)):GOSUB3310
3150 ZA=ZA+1
3160 NEXT LK
3170 WW=452:PP$="PRESS (ENTER) TO CONTINUE":GOSUB3310
3180 'PLAY SONG
3190 READ A8,A9:IF A8=0 THEN3550
3200 SOUND A8,A9
3210 IFPEEK(338)=191 THEN3230
3220 GOTO3190
3230 'PLAY AGAIN
3240 FOR LP=33 TO 449 STEP32:PRINT@LP,STRING$(30,128);:NEXTLP
3250 WW=132:PP$="PLAY ANOTHER GAME? (Y/N)":GOSUB3310
3260 EXEC44539:MB$=INKEY$
3270 IFMB$<>"Y" AND MB$<>"N"THEN 3260
3280 IFMB$="N" THEN CLS:END
3290 RUN
3300 GOTO3300
3310 'INVERSE PRINT
3320 FOR O=1 TO LEN(PP$)
3330 A7=ASC(MID$(PP$,O,1))
3340 IF A7>64 AND A7<91 THENPRINT@WW,CHR$(A7+32);:GOTO3370
3350 IF A7=32 THENPRINT@WW,CHR$(128);:GOTO3370
3360 POKE1024+WW,A7
3370 WW=WW+1:NEXT O
3380 RETURN
3390 DATA 176,2,159,2,133,2,133,2,89,2,133,2
3400 DATA 133,2,159,2,133,2,159,2,176,2,165,2
3410 DATA 159,2,165,2,147,2,147,2,89,2,147,2,147,2
3420 DATA 165,2,147,2,165,2,185,2,176,2,165,2
3430 DATA 159,2,133,2,133,2,89,2,133,2,133,2,159,2
3440 DATA 133,2,159,2,176,2,165,2,159,2,165,2,159,2,165,2
3450 DATA 147,2,176,2,165,2,159,2,133,2,133,2,133,3
3460 DATA 133,1,147,1,159,2,133,2,133,2
3470 DATA 89,2,133,2,133,2
3480 DATA 159,2,133,2,159,2,159,2,147,2,133,2
3490 DATA 147,2,125,2,125,2,89,2
3500 DATA 125,2,125,2,147,2,125,2,147,2,147,2
3510 DATA 133,2,125,2,108,2,133,2,133,2,89,2,133,2,133,2
3520 DATA 69,2,133,2,133,2,58,2,133,2,133,2
3530 DATA 165,2,159,2,165,2,147,2,176,2,165,2,159,2
3540 DATA 133,2,133,2,133,4,0,0
3550 FOR LP=1 TO 400
3560 IFPEEK(338)=191 THEN3230
3570 NEXTLP
3580 RESTORE:GOTO3180
3590 FOR J2=1 TO 5:RR(J2)=0:NEXTJ2
3600 CU(1)=143+64:CU(2)=143+48
3610 J9=384:DC$=""
3620 FOR Z1=1 TO 2
3630 PRINT@J9,CHR$(CU(Z1));
3640 FOR Z2=1 TO 20
3650 J8$=INKEY$:IF J8$<>"" THEN3680
3660 NEXT Z2,Z1
3670 GOTO3620
3680 IF J8$=CHR$(8) AND J9=384 THEN3650
3690 IFJ8$="N"THENRL=RL-1:GOTO1250
3700 IF J8$=CHR$(8) THENPRINT@J9,Y$;:DC$=LEFT$(DC$,LEN(DC$)-1)
3710 IF J8$=CHR$(8) THEN J9=J9-1:IF J9<384 THEN J9=384:GOTO3630 ELSE3630
3720 IF J8$=CHR$(13) THEN3770
3730 IF J8$>="1" AND J8$<="5" THEN3740 ELSE3650
3740 DC$=DC$+J8$:J9=J9+1
3750 IF J9>389 THEN DC$=LEFT$(DC$,5):J9=389:GOTO3630
3760 POKE1024+J9-1,ASC(J8$):GOTO3630
3770 FOR J2=1 TO LEN(DC$)
3780 FOR J3=1 TO 5
3790 IF VAL(MID$(DC$,J2,1))=J3 THEN RR(J3)=1
3800 NEXT J3
3810 NEXT J2
3820 RETURN
3830 'ALL DONE?
3840 FOR F1=1 TO Q
3850 FOR F3=1 TO 6
3860 IF S(F1,F3)=0 THEN 3920
3870 NEXT F3
3880 FOR F3=1 TO 7
3890 IF U(F1,F3)=0 THEN 3920
3900 NEXT F3
3910 DV(F1)=1
3920 NEXT F1
3930 FOR F4=1 TO Q
3940 IF DV(F4)=1 THEN 3950 ELSE3970
3950 NEXT F4
3960 PU=1
3970 RETURN
