1 'DISK SORTER
2 'BY GEOFF FRIESEN
3 'COPYRIGHT (C) 1992
4 'BY FALSOFT, INC.
5 'RAINBOW MAGAZINE
100 'DSORT (DISK SORT)
110 '
120 'INITIALIZE
130 '
140 CLEAR 3000
150 DIM DB$(2),DE$(72)
160 WIDTH 32
170 PRINT "DSORT (DISK SORT)"
180 PRINT
190 INPUT "DRIVE (0-3)"; D
200 IF D<0 OR D>3 THEN 190
210 POKE &HE42B,&H21
220 ON ERR GOTO 710
230 '
240 'INPUT DIRECTORY
250 '
260 I=0
270 FOR S=3 TO 11
280 DSKI$ D,17,S,DB$(0),DB$(1)
290 FOR J=1 TO 97 STEP 32
300 DE$(I)=MID$(DB$(0),J,32)
310 DE$(I+4)=MID$(DB$(1),J,32)
320 I=I+1
330 NEXT J
340 I=I+4
350 NEXT S
360 POKE &HFFD9,0
370 '
380 'DETERMINE NUMBER OF ENTRIES
390 '
400 N=0: I=0
410 X$=LEFT$(DE$(I),1)
420 IF X$=CHR$(255) THEN 450
430 N=N+1: I=I+1
440 IF I<72 THEN 410
450 IF N<2 THEN 700
460 '
470 'SORT DIRECTORY
480 '
490 FOR P=0 TO N-2
500 FOR I=0 TO N-P-1
510 IF DE$(I)<=DE$(I+1) THEN 550
520 T$=DE$(I)
530 DE$(I)=DE$(I+1)
540 DE$(I+1)=T$
550 NEXT I,P
560 POKE &HFFD8,0
570 '
580 'OUTPUT DIRECTORY
590 '
600 I=0
610 FOR S=3 TO 11
620 FOR J=1 TO 97 STEP 32
630 MID$(DB$(0),J,32)=DE$(I)
640 MID$(DB$(1),J,32)=DE$(I+4)
650 I=I+1
660 NEXT J
670 I=I+4
680 DSKO$ D,17,S,DB$(0),DB$(1)
690 NEXT S
700 DIR D
710 POKE &HE42B,&H27
720 IF ERNO=-1 THEN END
730 PRINT "ERROR"; ERNO; "@";
740 PRINT ERLIN
