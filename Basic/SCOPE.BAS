0 ' COPYRIGHT 1989  FALSOFT,INC
5 CLS:INPUT"MONITOR (C)OMPOSITE OR (R)GB";A$
10 IF A$="R" OR A$="r" THEN M=1 ELSE M=0
15 DIMC(32):FORT=1 TO 32:READC(T):NEXTT
20 FORT=0 TO 15:PALETTET,C(M*16+T+1):NEXTT
25 HSCREEN2:HCLS15
30 POKE65497,0
35 C=RND(15):X=RND(24)-1:Y=RND(24)-1
40 GOSUB125:V=INT(RND(9)):IF V=3 THEN C=INT(RND(24))-1
45 IF C>15 THEN C=15
50 D=INT(RND(8))
55 I$=INKEY$:IF I$=CHR$(12) THEN HCLS15
60 IF D=1 THEN Y=Y-1
65 IF D=2 THEN X=X+1:Y=Y-1
70 IF D=3 THEN X=X+1
75 IF D=4 THEN X=X+1:Y=Y+1
80 IF D=5 THEN Y=Y+1
85 IF D=6 THEN X=X-1:Y=Y+1
90 IF D=7 THEN X=X-1
95 IF D=8 THEN X=X-1:Y=Y-1
100 IF X<0 THEN X=0
105 IF Y<0 THEN Y=0
110 IF X>23 THEN X=23
115 IF Y>23 THEN Y=23
120 GOTO 40
125 A=X*4:B=Y*4:HCOLORC:HLINE(157-A,93-B)-(159-A,95-B),PSET,BF
130 HLINE(157-B,93-A)-(159-B,95-A),PSET,BF
135 HLINE(161+A,93-B)-(163+A,95-B),PSET,BF
140 HLINE(161+B,93-A)-(163+B,95-A),PSET,BF
145 HLINE(157-A,97+B)-(159-A,99+B),PSET,BF
150 HLINE(157-B,97+A)-(159-B,99+A),PSET,BF
155 HLINE(161+A,97+B)-(163+A,99+B),PSET,BF
160 HLINE(161+B,97+A)-(163+B,99+A),PSET,BF
165 RETURN
170 DATA 63,55,7,52,17,33,60,41,26,32,42,11,28,6,38,0,63,60,36,54,16,18,26,61,57,56,59,11,25,32,52,0
100 ' COCO 3 OSCILLOSCOPE PROGRAM. EMULATES A DUAL-TRACE SCOPE.
110 '
120 ' DATA DICTIONARY:
130 ' A$=TEMPORARY VARIABLE
135 ' B$=TEMPORARY VARIABLE
140 ' EB=END OF BUFFER
145 ' FI$=FILE NAME VARIABLE
150 ' I=TEMPORARY INDEX VARIABLE
160 ' P0=Y VOLTS PER DIVISION FOR TRACE 1
170 ' P1=X TIME PER DIVISION FOR TRACE 1 IN MS
180 ' P2=Y VOLTS PER DIVISION FOR TRACE 2
190 ' P3=X TIME PER DIVISION FOR TRACE 2 IN MS
200 ' P4=REFRESH, 0=CONTINUOUS, 1=STEP
210 ' P5=DISPLAY MODE, 0=X, 1=Y, 2=X AND Y
220 ' PS=PARAMETER SELECTED, 0-5
230 ' PS$=TEMPORARY STRING VARIABLE
240 ' SB=START OF BUFFER
250 ' SF=Y SCALE FACTOR, FINAL
260 ' Y=TEMPORARY VARIABLE FOR Y POSITION
270 ' YS=Y SCALE FACTOR
280 '
290 ' STORE MACHINE LANGUAGE CODE IN &H6000 ON
300 DEFUSR0=&H6000: DEFUSR1=&H607A
310 CLEAR 1000, &H5FFF
320 FOR I=&H6000 TO &H60F1
330 READ A$: POKE I,VAL("&H"+A$)
340 NEXT
350 DATA 10,8E,FF,00,8E,61,00,C6,00,BD,A9,A2,C6,80,F7,FF,20,A6,A4,2B,04,C0,40,20,04,CB,40,20,00,F7,FF,20,A6,A4,2B,04,C0,20,20,04,CB,20,20,00,F7,FF,20,A6,A4,2B
360 DATA 04,C0,10,20,04,CB,10,20,00,F7,FF,20,A6,A4,2B,04,C0,08,20,04,CB,08,20,00,F7,FF,20,A6,A4,2B,04,C0,04,20,04,CB,04,20,00,F7,FF,20,A6,A4,2B,04,C0,02,20,04
370 DATA CB,02,20,00,E7,80,CC,00,00,83,00,01,26,FB,8C,7F,FF,26,00,39,20,8D,10,8E,FF,00,8E,61,00,C6,01,BD,A9,A2,C6,80,F7,FF,20,A6,A4,2B,04,C0,40,20,04,CB,40,20
380 DATA 00,F7,FF,20,A6,A4,2B,04,C0,20,20,04,CB,20,20,00,F7,FF,20,A6,A4,2B,04,C0,10,20,04,CB,10,20,00,F7,FF,20,A6,A4,2B,04,C0,08,20,04,CB,08,20,00,F7,FF,20,A6
390 DATA A4,2B,04,C0,04,20,04,CB,04,20,00,F7,FF,20,A6,A4,2B,04,C0,02,20,04,CB,02,20,00,E7,80,CC,00,00,83,00,01,26,FB,8C,7F,FF,26,00,39
400 '
410 ' INITIALIZE
420 HSCREEN 4
430 HCLS
440 HBUFF 1,3200
450 HBUFF 2,200
460 HBUFF 3,200
465 HBUFF 4,300
470 HGET (0,174)-(639,191),1
480 HGET (0,0)-(47,9),2
490 HGET (0,0)-(79,7),3
495 HGET (0,0)-(119,7),4
500 PS=0
510 P1=10: P3=10
520 P0=1: P2=1
530 P4=0: P5=0
540 GOSUB 620
550 GOSUB 1280
560 GOSUB 1430
570 GOSUB 760
580 GOSUB 1270
590 GOSUB 1420
600 '
610 ' DISPLAY GRATICULE SUBROUTINE
620 FOR X=20 TO 620 STEP 60
630 HLINE (X,21)-(X,171),PSET
640 NEXT
650 FOR Y=21 TO 171 STEP 30
660 HLINE (20,Y)-(620,Y),PSET
670 NEXT
680 FOR X=20 TO 620 STEP 12
690 HLINE (X,169)-(X,173),PSET
700 NEXT
710 FOR Y=21 TO 171 STEP 4
720 HLINE (316,Y)-(324,Y),PSET
730 NEXT
740 RETURN
750 '
760 ' READ KEYS SUBROUTINE
770 A$=INKEY$: IF A$="" THEN GOTO 770
780 IF A$<>CHR$(9) THEN GOTO 810
790 PS=PS+1: IF PS=6 THEN PS=0
800 GOSUB 1420: GOTO 770
810 IF A$<>CHR$(8) THEN GOTO 840
820 PS=PS-1: IF PS=-1 THEN PS=5
830 GOSUB 1420: GOTO 770
840 IF A$<>CHR$(94) THEN GOTO 1070
850 IF PS<>0 THEN GOTO 880
860 P0=P0+.2: IF P0=1.2 THEN P0=.2
870 HPUT (104,176)-(123,183),2: HPRINT (12,22),P0: GOTO 770
880 IF PS<>1 THEN GOTO 910
890 IF P1<100 THEN P1=P1+10 ELSE IF P1<1000 THEN P1=P1+100 ELSE IF P1<10000 THEN P1=P1+1000 ELSE P1=P1+10000: IF P1=110000 THEN P1=10
900 HPUT (200,176)-(247,183),2:HPRINT (24,22),P1: GOTO 770
910 IF PS<>2 THEN GOTO 940
920 P2=P2+.2: IF P2=1.2 THEN P2=.2
930 HPUT (424,176)-(443,183),2: HPRINT (52,22),P2: GOTO 770
940 IF PS<>3 THEN GOTO 970
950 IF P3<100 THEN P3=P3+10 ELSE IF P3<1000 THEN P3=P3+100 ELSE IF P3<10000 THEN P3=P3+1000 ELSE P3=P3+10000: IF P3=110000 THEN P3=10
960 HPUT (520,176)-(567,183),2:HPRINT (64,22),P3: GOTO 770
970 IF PS<>4 THEN GOTO 1010
980 IF P4=0 THEN P4=1 ELSE P4=0
990 HPUT (80,184)-(159,192),3
1000 IF P4=0 THEN HPRINT (10,23), "CONTINUOUS" ELSE HPRINT (10,23), "STEP"
1010 IF PS<>5 THEN GOTO 1050
1020 P5=P5+1: IF P5=3 THEN P5=0
1030 HPUT (280,184)-(359,192),3
1040 IF P5=0 THEN HPRINT (35,23),"X ONLY" ELSE IF P5=1 THEN HPRINT (35,23),"Y ONLY" ELSE HPRINT (35,23), "X AND Y"
1050 GOTO 770
1060 ' G=GOTO ACCUMULATE DATA
1070 IF A$<>"G" THEN GOTO 1251
1080 IF P5=0 THEN POKE &H6076,&H95 ELSE IF P5=1 THEN POKE &H60F0,&H95 ELSE POKE &H6076,&H0A: POKE &H60F0,&H87
1090 IF P5=0 THEN IF P1>=1000 THEN POKE &H6073,&H63: POKE &H6074,&H58
1100 IF P5=0 THEN IF P1<1000 THEN POKE &H6073,&H80: POKE &H6074,&H00
1110 IF P5=1 THEN IF P3>=1000 THEN POKE &H60ED,&H63: POKE &H60EE,&H58
1120 IF P5=1 THEN IF P3<1000 THEN POKE &H60ED,&H80: POKE &H60EE,&H00
1130 IF P5=2 THEN IF P1>=1000 THEN POKE &H6073,&H65: POKE &H6074,&HB0: POKE &H60ED,&H65: POKE &H60EE,&HB0
1140 IF P5=2 THEN IF P1<1000 THEN POKE &H6073,&H80: POKE &H6074,&H00: POKE &H60ED,&H80: POKE &H60EE,&H00
1150 IF P5=0 THEN TD=P1 ELSE IF P5=1 THEN TD=P3 ELSE TD=P1
1160 TD=((TD/60)-.130)/.008: IF P5=2 THEN TD=TD/2
1170 MS=INT(TD/256)
1180 LS=INT(TD-MS*256)
1190 POKE &H606B,MS: POKE &H606C,LS: POKE &H60E5,MS: POKE &H60E6,LS
1191 IF P5=2 AND P1=10 THEN P1=20: GOSUB 1280: GOTO 770
1195 SOUND 128,1
1200 IF P5=0 THEN A=USR0(0) ELSE IF P5=1 THEN A=USR1(0) ELSE IF P5=2 THEN A=USR0(0)
1205 SOUND 128,1
1210 GOSUB 1490
1220 IF P4=0 THEN IF INKEY$="" THEN GOTO 1191 ELSE GOTO 770
1230 IF P4<>1 THEN GOTO 1250
1240 A$=INKEY$: IF A$="" THEN GOTO 1240 ELSE IF A$="S" THEN GOTO 770 ELSE GOTO 1191
1250 GOTO 770
1251 IF A$<>"W" THEN GOTO 1260
1252 HPUT (416,184)-(535,192),4,PRESET
1253 LINE INPUT FI$: IF FI$="" THEN GOTO 1258 ELSE HPRINT (52,23), FI$
1254 OPEN "O", #1, FI$
1255 PRINT#1,PS,P0,P1,P2,P3,P4,P5
1256 FOR I=&H6100 TO &H65AF: B=(INT(PEEK(I)/4)+64): PRINT#1,CHR$(B): NEXT
1257 CLOSE 1
1258 HPUT (416,184)-(535,192),4
1259 GOTO 770
1260 IF A$<>"R" THEN GOTO 770
1261 HPUT (416,184)-(535,192),4,PRESET
1262 LINE INPUT FI$: IF FI$="" THEN GOTO 1267 ELSE HPRINT (52,23),FI$
1263 OPEN "I", #1, FI$
1264 INPUT#1,PS,P0,P1,P2,P3,P4,P5
1265 FOR I=&H6100 TO &H65AF: INPUT#1, B$: B=(ASC(B$)-64)*4: POKE I,B: NEXT
1266 CLOSE 1
1267 HPUT (416,184)-(535,192),4
1268 GOSUB 1430: GOSUB 1500: GOTO 770
1278 '
1279 ' DISPLAY INFORMATION LINE SUBROUTINE
1280 HPUT (0,174)-(639,191),1
1290 HPRINT (0,22), "  TRACE 1: Y=   V/DIV  X=       MS/DIV    TRACE 2: Y=   V/DIV  X=       MS/DIV"
1300 HPRINT (0,23), "  REFRESH:           DISPLAY MODE:            FILE: "
1310 HPRINT (0,1), "  CURRENT PARAMETER SELECTED:"
1320 HPUT (104,176)-(123,183),2: HPRINT (12,22),P0
1330 HPUT (200,176)-(247,183),2:HPRINT (24,22),P1
1340 HPUT (424,176)-(443,183),2: HPRINT (52,22),P2
1350 HPUT (520,176)-(567,183),2: HPRINT (64,22),P3
1360 HPUT (80,184)-(159,192),3
1370 IF P4=0 THEN HPRINT (10,23),"CONTINUOUS" ELSE HPRINT (10,23), "STEP"
1380 HPUT (280,184)-(359,192),3
1390 IF P5=0 THEN HPRINT (35,23),"X ONLY" ELSE IF P5=1 THEN HPRINT (35,23),"Y ONLY" ELSE HPRINT (35,23),"X AND Y"
1400 RETURN
1410 '
1420 ' DISPLAY SELECT LINE SUBROUTINE
1430 HPUT (232,0)-(639,17),1
1440 IF PS=0 THEN PS$="TRACE 1, Y" ELSE IF PS=1 THEN PS$="TRACE 1, X" ELSE IF PS=2 THEN PS$="TRACE 2,Y" ELSE IF PS=3 THEN PS$="TRACE 2,X" ELSE IF PS=4 THEN PS$="REFRESH"
1450 IF PS=5 THEN PS$="DISPLAY MODE"
1460 HPRINT (30,1), PS$
1470 RETURN
1480 '
1490 ' PLOT SCOPE DISPLAY
1500 FOR Y=16 TO 156 STEP 14: HPUT (0,Y)-(639,Y+17),1: NEXT
1510 GOSUB 620: GOSUB 1280
1520 SB=&H6100
1530 IF P5=0 OR P5=1 THEN EB=&H6357 ELSE EB=&H65AF
1540 IF P5=0 OR P5=2 THEN YS=1/P0 ELSE YS=1/P2
1550 SF=(150/252)*YS
1560 HCOLOR 2,0
1570 IF P5<>2 THEN GOTO 1640
1580 FOR I=SB TO EB STEP 2: Y=170-(PEEK(I) AND &HFC)*SF: X=(I-&H6100)/2
1590 IF X=0 THEN IF Y>19 THEN HLINE(X+20,Y)-(X+20,Y),PSET: NEXT
1600 IF Y>=20 THEN HLINE -(X+20,Y),PSET:NEXT ELSE HPRINT (50,3),"POINTS OFF SCREEN!":NEXT
1605 HCOLOR 3,0
1610 FOR I=SB+1 TO EB STEP 2: Y=170-(PEEK(I) AND &HFC)*SF: X=(I-&H6100)/2
1611 IF X<1 THEN IF Y>19 THEN HLINE(X+20,Y)-(X+20,Y),PSET: NEXT
1620 IF Y>=20 THEN HLINE -(X+20,Y),PSET:NEXT ELSE HPRINT (50,3),"POINTS OFF SCREEN!":NEXT
1630 GOTO 1670
1640 FOR I=SB TO EB: Y=170-(PEEK(I) AND &HFC)*SF: X=I-&H6100
1650 IF X=0 THEN IF Y>19 THEN HLINE(X+20,Y)-(X+20,Y),PSET: NEXT
1660 IF Y>=20 THEN HLINE -(X+20,Y),PSET:NEXT ELSE HPRINT (50,3),"POINTS OFF SCREEN!":NEXT
1670 HCOLOR 1,0
1680 RETURN
