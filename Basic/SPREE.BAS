0 ' COPYRIGHT 1989  FALSOFT,INC
10 'SHOPPING SPREE (C) 1989 BY CURT COTY
20 CLEAR 500,32500:PCLEAR 7
30 CLS:PRINT"ARE YOU USING A RGB MONITOR?"
40 I$=INKEY$:IF I$="" THEN 40
50 IF I$="Y" THEN CL$="620056365220562563383617" ELSE CL$="510032062015324563210631"
60 FOR X=0 TO 15:PALETTE X,0:NEXT X
70 PALETTE 4,VAL(MID$(CL$,1,2))
80 PALETTE 5,VAL(MID$(CL$,3,2))
90 PALETTE 6,VAL(MID$(CL$,5,2))
100 PALETTE 7,VAL(MID$(CL$,7,2))
110 CLS0
120 DIM N$(10),L$(26),GD(20,14),SH(15,10),MT(15,10)
130 DATA 14,8,10,0,0,0,0,0,0,0,8,0,0,0,0,0,14,8,0,0,0,0,0,0,0
140 DATA 12,10,14,10,14,10,14,10,14,10,10,14,10,14,10,0,12,10,14,10,14,5,13,5,13
150 DATA 12,8,8,8,12,8,14,8,14,8,8,8,8,12,10,0,12,8,14,8,8,5,12,5,12
160 DATA 0,0,0,0,0,0,8,0,8,0,0,0,0,12,8,0,0,0,8,0,0,4,12,4,12
170 WIDTH 32:POKE 41382,128:POKE 65497,0:POKE 63506,33:POKE 63772,33
180 FOR C=1 TO 3
190 FOR Y=0 TO 96 STEP 32
200 PRINT @ Y+C*66,"";
210 FOR X=1 TO 25
220 READ D
230 PRINT CHR$(128+16*C+D);
240 NEXT X,Y
250 RESTORE
260 NEXT C
270 PRINT @ 392,"(C) 1989 BY CURT COTY";
280 PALETTE 1,56:PALETTE 2,59:PALETTE 3,10:PALETTE 12,59
290 LV=5:SP=LV:NC=0
300 D$="BR2;D8;U1;L2;R5;U3;L5;U3;R5"
310 P$="CBAABCFCBAABCFFGEA"
320 ML$="8E143EA684A701301F8C124026F58E14208600A7843088E08C124026F639"
330 TT=32500:DEFUSR0=TT:GOSUB390
340 ML$="8E1021A684A71F30018C11FF26F58E11FF8600A7843088E08C101F26F639"
350 TT=32650:DEFUSR1=TT:GOSUB390
360 ML$="8E14E1A684A71F30018C16BF26F58E16BF8600A7843088E08C14DF26F639"
370 TT=32550:DEFUSR2=TT:GOSUB390
380 GOTO 410
390 VV=0:FORI=1TOLEN(ML$)STEP2:AA$=MID$(ML$,I,2):AA=VAL("&H"+AA$):POKETT+VV,AA:VV=VV+1:NEXT I
400 RETURN
410 'DEFINE CHARACTER SET
420 N$(0)="NU6R4U6L4R6D6BR4":N$(1)="R6UL2NL4U5L2DR2BR6BD5":N$(2)="R6UNL2BU2U3L6R4D3L4D3BR10":N$(3)="R6U3NL4U3L6R4D6BR6":N$(4)="BU3NU3R4ND3U3R2D6BR4"
430 N$(5)="UR2DL2R6U3L6U3R2ND3R4BR4BD6":N$(6)="NU6R6U3LND3L5U3R6DL2BR6BD5":N$(7)="BU6R4D6RU6RD6BR4":N$(8)="U3NR4U3R4D6RU6RD6L6BR10":N$(9)="BU3NR4U3R4D6RU6RD6BR4"
440 L$(0)="U6R2ND6R4D3NL6D3BR4":L$(1)=L$(0)+"BL4L6BR10":L$(2)="NR6U6R2ND6R4D2BF4":L$(3)="U6R2ND6R2F2D2G2BR6":L$(4)="NR6U3NR4U3R2ND6R4BD6BR4":L$(5)="U3NR4U3R2ND6R4BD6BR4":L$(6)="NR6U6R2ND6R4BD4D2BR4"
450 L$(7)="U6R2D3ND3R4U3D6BR4":L$(8)="R2U6L2R6L2D6R2BR4":L$(9)="R2U6L2R6L2D6BR6":L$(10)="U6R2D2NM+4,-2ND4F4BR4":L$(11)="U6R2D6R4BR4":L$(12)="U6R2ND6F2E2D6BR4"
460 L$(13)="U6R2D3R2D3R2NU6BR4":L$(14)="U6R6L4D6R4NU6BR4":L$(15)="U6R2ND6R4D3L4BD3BR8":L$(16)="U6R2ND6R4D6L6R4BU2M+4,+2BR4":L$(17)="U6R2ND6R4D3L4R2M+2,+3BR4":L$(18)="R6U3L2ND3L4U3R2ND3R4BD6BR4"
470 L$(19)="BU6R2ND6R2ND6R2BD6BR4":L$(20)="U6R2D6R4NU6BR4":L$(21)="BR2H2U4R2D4F2E2U4BD6BR4":L$(22)="BU2U4R2D6E2F2NU6BR4":L$(23)="UE2H2UR2DF2G2DBR4UH2E2UBD6BR4":L$(24)="UR2DL2R6U3NU3L6U3R2D3BR8BD3":L$(25)="R6UL2DL4U2M+6,-2U2L6DR2
480 GOTO 520
490 FORK=1TOLEN(W$):L=ASC(MID$(W$,K,1)):IFL>64ANDL<91THENL$=L$(L-65)ELSEIFL=46THENL$="URDLBR6"ELSEIFL<48ORL>57THENL$="BR6"ELSEL$=N$(L-48)
500 DRAW L$:NEXT K
510 RETURN
520 'DRAW SCREEN
530 PMODE3,1:COLOR 8,5:PCLS
540 GET(1,1)-(16,11),MT,G
550 DRAW"BM 20,80;C6":W$="COUPONS":GOSUB 490
560 FOR X=120 TO 200 STEP 16:DRAW"BM"+STR$(X)+",73;C6;"+D$:NEXT X
570 DRAW"BM60,9;S4;C7":W$="SHOPPING SPREE":GOSUB 490
580 DRAW"BM62,10;C6":W$="SHOPPING SPREE":GOSUB 490
590 DRAW"BM75,110;C6":W$="FLOOR":GOSUB 490
600 DRAW"BM103,125;C6":W$="5 ELECTRONICS":GOSUB 490
610 DRAW"BM103,140":W$="4 TOY SHOP":GOSUB 490
620 DRAW"BM103,155":W$="3 HOUSEWARES":GOSUB 490
630 DRAW"BM103,170":W$="2 SPORTING GOODS":GOSUB 490
640 DRAW"BM103,185":W$="1 GROCERY":GOSUB 490
650 DRAW"BM3,70;C8;R249;F3;D8;G3;L249;H3;U8;E3"
660 DRAW"BM3,0;R249;F3;D8;G3;L249;H3;U8;E3"
670 DRAW"BM3,88;R249;F3;D97;G3;L249;H3;U97;E3"
680 COLOR 8,8
690 LINE(0,33)-(255,33),PSET
700 LINE(0,52)-(255,52),PSET
710 CR$="C6;R2;D2;R13;D5;L3;D2;L2;U2;L4;D2;L2;U2;L1;U3;R12;L12;U2"
720 DRAW"BM124,17"+CR$
730 DRAW"BM200,96"+CR$:DRAW"BM220,96"+CR$
740 GET(124,17)-(139,27),SH,G
750 PCOPY 1 TO 5:PCOPY 2 TO 6
760 GOTO 1660
770 'DRAW TELEVISION
780 PALETTE 6,VAL(MID$(CL$,5,2))
790 PALETTE 7,VAL(MID$(CL$,7,2))
800 DRAW"BM25,121;C7;F5;E5;G5;C6;R8;D8;L16;U8;R8"
810 PAINT(25,130),6,6
820 COLOR 7,7
830 LINE(24,127)-(32,133),PSET,BF
840 COLOR 8,8:PSET(36,128):PSET(36,131)
850 'DRAW RADIO
860 COLOR 7,7
870 LINE(22,145)-(37,154),PSET,BF
880 LINE(22,141)-(27,145),PSET
890 DRAW"BM22,146;C5;R16"
900 COLOR 6,6
910 DRAW"BM26,148;R3;F1;D2;G1;L3;H1;U2;E1":PAINT(26,151)
920 DRAW"BM34,148;R1;D1;L1"
930 DRAW"BM32,145;C8;D1"
940 'DRAW TELEPHONE
950 DRAW"BM24,161;C6;R12;F2;D2;L2;U2;L12;D2;L2;U2;E2;D1;R12"
960 DRAW"BM28,164;C6;D2;R4;U2;D3;R2;F2;D5;L12;U5;E2"
970 PAINT(30,170)
980 COLOR 5,5
990 FOR X=26 TO 36 STEP 4:PSET(X,169):PSET(X,171):PSET(X,173):NEXT X
1000 RETURN
1010 'DRAW TEDDY BEAR
1020 PALETTE 6,VAL(MID$(CL$,9,2))
1030 PALETTE 7,VAL(MID$(CL$,11,2))
1040 DRAW"BM30,122;C6;R4;U1;R2;D2;L1;D3;G2;D1;R4;E1;G1;L3;D1;F2;D1;G1;L1;H1;L2;G1;L2;H1;U1;E2;U1;L3;H1;F1;R4;U2;L2;U4;L2;U2;R2;D1;R2" 
1050 PAINT(32,124),7,6:PAINT(32,130),7,6
1060 'DRAW TOP
1070 DRAW"BM28,141;C6;R5;L2;D3;R4;D1;R2;G7;U1;H5;U1;R2;U1;R4"
1080 PAINT(28,146),7,6
1090 DRAW"BM28,145;C8;R4;BD2;R1;L5;R2;BD2;R1"
1100 'DRAW SHIP
1110 COLOR 6,5
1120 DRAW"BM22,169;C8;F5;R8;E5;L16"
1130 PAINT(30,172),7,8
1140 DRAW"BM30,168;C7;U7;R2;F6;L4;H1"
1150 RETURN
1160 'DRAW MIXER
1170 PALETTE 6,VAL(MID$(CL$,13,2))
1180 PALETTE 7,VAL(MID$(CL$,15,2))
1190 DRAW"BM26,121;C6;R8;F2;D2;G1;L6;D6;R8;D2;L12;U11;E2"
1200 PAINT(30,123),8,6
1210 DRAW"BM34,127;C7;D2;R2;D2;L3;U2;R1"
1220 'DRAW COFFEE POT
1230 DRAW"BM28,141;C7;R1;D2;R2;F2;D8;L8;U8;E2;R2;L2;G2;L2;D1
1240 DRAW"BM34,145;C6;R2;D4;L2"
1250 PAINT(30,147),7,7
1260 'DRAW CLOCK
1270 DRAW"BM28,161;C6;R6;F4;D5;G3;L7;H3;U6;E3"
1280 PAINT(28,164),7,6
1290 DRAW"BM30,167;C6;U4;D4;R3
1300 COLOR 8,6
1310 PSET(30,163):PSET(36,167):PSET(26,167):PSET(30,172)
1320 RETURN
1330 'DRAW RAQUET
1340 PALETTE 6,VAL(MID$(CL$,17,2))
1350 PALETTE 7,VAL(MID$(CL$,19,2))
1360 DRAW"BM22,127;C6;R7;U2;E3;R4;F3;D5;G3;L4;H3;U2;L7"
1370 PAINT(35,125),7,6
1380 'DRAW BASKETBALL
1390 DRAW"BM26,142;C8;R8;F2;D6;G2;L8;H2;U6;E2"
1400 PAINT(30,145),8,8
1410 DRAW"BM25,143;C6;D1;R2;D6;L2;D1"
1420 DRAW"BM36,143;C6;D1;L2;D6;R2;D1"
1430 DRAW"BM30,143;C6;D9"
1440 'DRAW FOOTBALL HELMET
1450 DRAW"BM30,161;C6;R3;F3;D5;L3;D5;L8;U1;H2;U7;E3;R2"
1460 PAINT(30,165),8,6
1470 DRAW"BM30,172;C6;R8"
1480 RETURN
1490 'DRAW BOTTLE
1500 PALETTE 6,VAL(MID$(CL$,21,2))
1510 PALETTE 7,VAL(MID$(CL$,23,2))
1520 DRAW"BM29,121;C6;R1;D4;R3;D9;L7;U9;R3;U4"
1530 PAINT(30,129),7,6
1540 'DRAW APPLE
1550 DRAW"BM28,143;C7;R4;F4;D4;G3;L4;H4;U3;E4"
1560 PAINT(30,145),7,7
1570 DRAW"BM30,143;C8;E2;G2;H2"
1580 COLOR 5,5
1590 PSET(32,145):PSET(32,146)
1600 'DRAW BOX
1610 DRAW"BM24,173;C6;U7;R6;D7;L6;R7;E5;U7;G5;L7;E5;R6"
1620 PAINT(28,170),8,6
1630 PAINT(30,165),8,6
1640 PAINT(34,168),8,6
1650 RETURN
1660 WIDTH 32:SCREEN 1,1
1670 PLAY"T10;L2;O3"
1680 DRAW"BM50,45;C8;":W$="PRESS FIRE BUTTON":GOSUB 490
1690 FOR X=1 TO LEN(P$)
1700 PLAY MID$(P$,X,1)
1710 IF BUTTON(0)=0 THEN NEXT X ELSE 1730
1720 GOTO 1690
1730 PCOPY 6 TO 2
1740 RC=3
1750 'START PROG
1760 PLAY"T10;L10;O2"
1770 DS=200
1780 H=124:V=-1:V1=-1:CH=0:CV=0
1790 COLOR 5,5
1800 PCOPY 5 TO 1
1810 LINE(0,36)-(255,50),PSET,BF
1820 LINE(0,54)-(255,69),PSET,BF
1830 ON LV GOSUB 1490,1330,1160,1010,770
1840 IF SP<>1 THEN SP=LV
1850 DRAW"BM85,"+STR$(117+(5-LV)*15)+";C8;F5;G5;E3;L10;R10;BU4;L10"
1860 SOUND 150,5
1870 J=JOYSTK(0):J1=JOYSTK(1)
1880 V1=V
1890 IF J1=63 THEN IF V<1 THEN V=V+1:PLAY"BBA"
1900 IF J1=0 THEN IF V>-1 THEN V=V-1:PLAY"BBA"
1910 IF V<>V1 THEN IF PPOINT(H,41+20*V)=5 AND PPOINT(H+15,41+20*V)=5 AND PPOINT(H+7,42+20*V)=5 THEN PUT(H,37+20*V1)-(H+15,47+20*V1),MT,PSET:PUT(H,37+20*V)-(H+15,47+20*V),SH,PSET: ELSE GOSUB 2070
1920 FOR C=1 TO (SP-1)*20:NEXT C
1930 U=USR0(0):U=USR1(0):U=USR2(0)
1940 C1=C1+1:C2=C2+1:C3=C3+1
1950 IF V=0 THEN H=H+8 ELSE H=H-8
1960 IF CH<>0 THEN IF CV=0 THEN CH=CH+8 ELSE CH=CH-8
1970 IF CH<0 OR CH>245 THEN CH=0
1980 IF H<0 OR H>235 THEN 2070
1990 R=RND(3+SP):O=RND(3):W=RND(3)
2000 GET(20,101+20*O)-(40,115+20*O),GD,G
2010 IF W=2 THEN HP=2 ELSE HP=234
2020 IF R=1 AND C1>3 THEN PUT(235,17)-(255,30),GD,PSET:C1=1
2030 IF R=2 AND C2>3 THEN PUT(0,36)-(20,50),GD,PSET:C2=1
2040 IF R=3 AND C3>3 THEN PUT(235,55)-(255,68),GD,PSET:C3=1
2050 IF R=4 AND CH=0 AND PPOINT(HP,W*20+4)=5 THEN CV=W-2:DRAW"BM"+STR$(HP)+","+STR$(CV*20+38)+"C6;"+D$:CH=HP:IF W=1 THEN C1=1 ELSE IF W=2 THEN C2=1 ELSE C3=1
2060 GOTO 1870
2070 'CART CRASHED
2080 IF H<0 THEN H=0 ELSE IF H>245 THEN H=245
2090 PUT(H,37+20*V1)-(H+15,47+20*V1),MT,PSET
2100 IF ABS(H-CH)<17 AND CV=V THEN 2340
2110 FOR X=1 TO 10
2120 PUT(H,37+20*V)-(H+15,47+20*V),SH,PRESET
2130 PLAY"CAA"
2140 PUT(H,37+20*V)-(H+15,47+20*V),SH,PSET
2150 NEXT X
2160 FOR X=1 TO 500:NEXT X
2170 RC=RC-1:IF RC=0 THEN 2220
2180 COLOR 5,5
2190 IF RC=2 THEN LINE(220,90)-(240,110),PSET,BF
2200 IF RC=1 THEN LINE(200,90)-(220,110),PSET,BF
2210 GOTO 1780
2220 PALETTE 7,VAL(MID$(CL$,15,2))
2230 WIDTH 40:ATTR 5,7:CLS8
2240 M$="GAME OVER"
2250 FOR X=1 TO LEN(M$)
2260 FOR Y=0 TO 16
2270 LOCATE X+15,Y
2280 PRINT MID$(M$,X,1);
2290 NEXT Y:SOUND 200,1:NEXT X
2300 LOCATE 9,18:PRINT"YOU COLLECTED";NC;"COUPONS";
2310 LOCATE 13,20:PRINT"TRY AGAIN (Y/N)";
2320 I$=INKEY$:IF I$="" THEN 2320
2330 IF I$="Y" THEN LOCATE 12,20:ATTR 5,7,B:PRINT"RE-ENTERING STORE";:NC=0:LV=5:SP=LV:GOTO 520: ELSE IF I$="N" THEN POKE 65496,0:END: ELSE 2310
2340 'CART LANDED ON COUQON
2350 NC=NC+1
2360 DRAW"BM"+STR$(CH)+","+STR$(CV*20+38)+"C5;"+D$
2370 PUT(H,37+20*V)-(H+15,47+20*V),SH,PSET
2380 IF PPOINT(H-1,42+20*V)<>5 OR PPOINT(H+17,42+20*V)<>5 THEN GOTO 2110
2390 PLAY"T10;L10;O2;CCDDEEFFCADAE"
2400 DRAW"BM"+STR$(DS)+",73;C5"+D$
2410 DS=DS-16:CH=0
2420 IF DS=104 THEN 2440
2430 RETURN
2440 'NEW LEVEL
2450 PLAY"T10;L5;O2;CFABDAFA"
2460 LV=LV-1
2470 COLOR 5,5
2480 LINE(20,115)-(100,175),PSET,BF
2490 COLOR 7,7:FOR X=120 TO 200 STEP 16:DRAW"BM"+STR$(X)+",73;C6;"+D$:NEXT X
2500 IF LV=0 THEN GOTO 2520
2510 GOTO 1750
2520 'ESCAPED FROM STORE
2530 FOR X=1 TO 40
2540 PCOPY 1 TO 7:PCOPY 2 TO 1:PCOPY 3 TO 2:PCOPY 4 TO 3:PCOPY 7 TO 4
2550 NEXT X
2560 COLOR 5,5:LINE(0,36)-(255,50),PSET,BF
2570 DRAW"BM30,45;C8":W$="YOU ESCAPED THE STORE":GOSUB 490
2580 FOR X=1 TO 3:SOUND 100,3:FOR Z=1 TO 500:NEXT Z,X
2590 COLOR5,5:LINE(0,36)-(255,50),PSET,BF
2600 DRAW"BM25,45;C8":W$="PREPARE FOR NEXT LEVEL":GOSUB 490
2610 PLAY "T10;L2;O3"+P$+P$+"T5;L2;AA"
2620 COLOR 5,5:LINE(20,115)-(100,190),PSET,BF
2630 LV=5
2640 GOTO 1750
