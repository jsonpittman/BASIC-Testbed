10 '
20 '
30 '     SNEAKY SNAKE   VR 2.1
40 '
50 '
60 ' COPYRIGHT (C) 1982
70 ' BY PETER KERCKHOFF
80 ' REV. 6/86 P.KERCKHOFF
90 '
100 CLEAR1390,&H7A9F:SP=0:SR=3:GOSUB680:GOSUB440:GOSUB490:DIMA(7)
110 POKEXC,10:POKEYC,10:A$=CHR$(29)+CHR$(28)+CHR$(24):GOSUB350:GOSUB370:POKECH,30:POKEXC,XP:POKEYC,YP:Z=USR3(Z):IFSP=1THENGOSUB370:POKECH,31:POKEXC,XP:POKEYC,YP:Z=USR3(Z)
120 X=&H7AA0:POKEX,10:POKEX+1,11:POKEX+2,12:X=&H7B68:POKEX,10:POKEX+1,10:POKEX+2,10:POKEM,1:POKELN,2:A$=INKEY$
130 X=JOYSTK(0):X=JOYSTK(2):Y=JOYSTK(3):A$=INKEY$:IFPEEK(J)=0ANDA$<>""THEN150
140 IF(X<5ORY<5ORX>58ORY>58)ANDPEEK(J)=1THEN150ELSE130
150 PLAY"AG":Z=USR1(Z):FORX=0TO50STEPSR:NEXT:IFPEEK(G)=1THEN150
160 ONPEEK(G)GOTO170,180,260,300,310
170 GOTO150:'SHOULD NEVER GET HERE
180 PLAY"L255V31O4BAGFEDC":POKELN,PEEK(LN)+1:X=&H7AA0+PEEK(LN):Y=&H7B68+PEEK(LN):LX=PEEK(X-1):LY=PEEK(Y-1):ONPEEK(M)GOTO190,200,210,220
190 LX=LX+1:GOTO230
200 LY=LY-1:GOTO230
210 LX=LX-1:GOTO230
220 LY=LY+1:GOTO230
230 POKEX,LX:POKEY,LY:POKEXC,PEEK(X-2):POKEYC,PEEK(Y-2):POKECH,29:Z=USR3(Z):GOSUB370:POKEXC,XP:POKEYC,YP:POKECH,30:Z=USR3(Z):IFSP=1THENGOSUB370:POKEXC,XP:POKEYC,YP:POKECH,31:Z=USR3(Z)
240 IFPEEK(LN)<200THEN150:' MAXIMUM SNAKE LENGTH = 200
250 A$="YOU HAVE OBTAINED A MEGA-SNAKE":POKEXC,0:POKEYC,0:GOSUB350:A$="THE SNAKE LENGTH IS 200!!!":POKEXC,0:POKEYC,0:GOSUB350:GOSUB540:GOTO110
260 A$="BFBFBFBF":PLAY"L100O1V31XA$;V15XA$;V7XA$;V3XA$;V2XA$;V1XA$;V0XA$;V31O4L255"
270 XP=PEEK(&H7AA0+PEEK(LN)):YP=PEEK(&H7B68+PEEK(LN)):POKEXC,XP:POKEYC,YP:POKECH,32:Z=USR3(Z)
280 X=PEEK(LN)-1:IFX<2THENX=2
290 POKELN,X:GOTO150
300 A$="YOU HAVE TIED YOUR SNAKE INTO A":B$="KNOT...LENGTH WAS":GOTO320
310 A$="YOU HAVE RUN YOUR SNAKE INTO A":B$="WALL...LENGTH WAS"
320 POKEXC,0:POKEYC,0:GOSUB350:A$=B$+STR$(PEEK(LN)+1)+".":POKEXC,0:POKEYC,1:GOSUB350:POKEXC,0:POKEYC,3:A$="PRESS TRIGGER FOR SAME GAME":GOSUB350:POKEXC,0:POKE YC,4:A$="OR PRESS ENTER FOR NEW SET-UP":GOSUB350
330 A$=INKEY$:Z=PEEK(&HFF00)AND2:IFA$=""ANDZ=2THEN330 ELSE IF Z=0 THEN GOSUB620:GOTO 110 ELSE GOSUB560:GOTO110
340 ' CHARACTER OUT RTN
350 FORL=1TOLEN(A$):POKECH,ASC(MID$(A$,L,1)):Z=USR3(Z):PLAY"O4V10L255AG":POKEXC,PEEK(XC)+1:NEXT:PLAY"V31L255BFBF":RETURN
360 ' RND RTN FOR RB OR SNK PIT
370 XP=RND(27)+2:YP=RND(18)+2:AP=&H0E00+YP*256+XP:IFPEEK(AP)<>0THEN370ELSEA(0)=AP+1:A(1)=AP+256:A(2)=AP-256:A(3)=AP-1:A(4)=AP+2:A(5)=AP+512:A(6)=AP-512:A(7)=AP-2
380 Y=&H0600+PEEK(&H7B68+PEEK(LN))*256+PEEK(&H7AA0+PEEK(LN)):FORX=0TO7:IFY=A(X)THEN370ELSENEXTX:RETURN
390 RESTORE:CLS
400 READ A$:PRINT@0,A$;" ";:IFA$<>"*"THEN400ELSECLS
410 READA$:PRINTA$;"-";
420 IFINKEY$<>" "THEN420ELSE410
430 A$=INKEY$:IFA$=""THEN430ELSEPRINTHEX$(ASC(A$)):GOTO430
440 RESTORE:AD=&H7DD0
450 READD$:IFD$<>"*"THENPOKEAD,VAL("&H"+D$):AD=AD+1:GOTO450
460 AD=&H7C3A:DEFUSR1=&H7C3E:DEFUSR3=&H7D7E:YC=&H7C37:XC=YC+1:CH=XC+1:LN=&H7C31:POKELN-1,0:M=LN+1:J=M+1:G=J+1:POKEJ,1
470 READD$:IFD$<>"*"THENPOKEAD,VAL("&H"+D$):AD=AD+1:GOTO470
480 RETURN
490 PMODE3,1:SCREEN1,0:PCLS:LINE(0,0)-(255,191),PSET,B:LINE(4,4)-(251,187),PSET,B:POKEYC,2:POKEXC,10:A$="SNEAKY SNAKE":GOSUB350
500 POKEXC,3:POKEYC,4:A$="WELCOME TO THE GAME SNEAKY":GOSUB350:POKEXC,1:POKEYC,5:A$="SNAKE. THE OBJECT OF THIS GAME":GOSUB350:POKEXC,1:POKEYC,6:A$="IS TO GUIDE YOUR SNAKE ( "+CHR$(29)+CHR$(29)+CHR$(28)+CHR$(24)+")":GOSUB350
510 POKEYC,7:POKEXC,1:A$="TO THE MUG OF ROOTBEER ( "+CHR$(30)+" ),":GOSUB350:POKEYC,8:POKEXC,1:A$="AVOIDING THE SNAKE PITS ( "+CHR$(31)+" ).":GOSUB350:POKEYC,10:POKEXC,1:A$="YOUR SNAKE WILL GROW LONGER AS":GOSUB 350
520 POKEYC,11:POKEXC,1:A$="IT DRINKS THE ROOTBEER--BUT IF":GOSUB350:POKEYC,12:POKEXC,1:A$="THE SNAKE FALLS INTO A SNAKE":GOSUB350:POKEYC,13:POKEXC,1:A$="PIT THE SNAKE WILL SHRINK.":GOSUB350
530 POKEYC,15:POKEXC,4:A$="THE GAME ENDS IF YOU TIE":GOSUB350:POKEYC,16:POKEXC,1:A$="YOUR SNAKE INTO A KNOT OR LEAD":GOSUB350:POKEYC,17:POKEXC,1:A$="IT INTO A WALL.":GOSUB350:PLAYTN$
540 POKEYC,21:POKEXC,4:A$="PRESS ANY KEY TO CONTINUE":GOSUB350:A$=INKEY$
550 Z=PEEK(&HFF00)AND2:IF INKEY$="" AND Z=2 THEN 550
560 PCLS:POKEXC,2:POKEYC,21:A$="PRESS ENTER OR USE TRIGGER":GOSUB350:POKEYC,22:POKEXC,2:A$="BUTTON TO ENTER VALUE":GOSUB350
570 POKEXC,10:POKEYC,2:A$="SNEAKY SNAKE":GOSUB350:POKEXC,2:POKEYC,6:A$="SNAKE PITS (1=YES 0=NO) ":B$=RIGHT$(STR$(SP),1):GOSUB350:A$=INKEY$:GOSUB640:IFB$="1"THENSP=1ELSEIFB$="0"THENSP=0
580 POKEYC,8:POKEXC,2:A$="SNAKE SPEED (1 TO 5) ":B$=RIGHT$(STR$(SR),1):GOSUB350:A$=INKEY$:GOSUB640:IFB$>"0"ANDB$<"6"THENSR=VAL(B$):POKEYC,10:POKEXC,2:A$="KEYBOARD (0) OR":GOSUB350
590 POKEYC,11:POKEXC,2:A$="JOYSTICK (1)    ":B$=RIGHT$(STR$(PEEK(J)),1):GOSUB350:A$=INKEY$:GOSUB640:POKEJ,0:IFB$="1"THENPOKEJ,1
600 POKEYC,14:POKEXC,2:A$="** PRESS ANY KEY TO START **":GOSUB350:A$=INKEY$
610 Z=PEEK(&HFF00)AND2:IF INKEY$="" AND Z=2 THEN 610
620 PCLS:POKECH,23:FORX=0TO31:POKEXC,X:POKEYC,0:Z=USR3(Z):POKEYC,23:Z=USR3(Z):NEXT:FORX=0TO23:POKEXC,0:POKEYC,X:Z=USR3(Z):POKEXC,31:Z=USR3(Z):NEXT:RETURN
630 'KEYBOARD INPUT
640 POKECH,ASC(B$):Z=USR3(Z)
650 A$=INKEY$:Z=PEEK(&HFF00)AND2:IF A$="" AND Z=2 THEN 650 ELSE IF Z=0 THEN RETURN ELSE IFA$=""THEN650ELSEIFA$>"/"ANDA$<":"THENPLAY"V31L255B":B$=A$:GOTO640ELSERETURN
660 GOTO660
670 ' TITLE PAGE GRAPHICS
680 PMODE4,1:SCREEN1,1:PCLS1:DRAW"BM15,84C0S8F3R7E2U6H2L3H2U2E2R2E5R4E2U6H2L3H2UE2R2E2R2U3EUDRLGL3D2GL3G3D4F2R3F2D2G2L3G5L2G3D5F2R3F2D2G2L5H3D2"
690 DRAW"BM+14,+3U8R2F5U5R2D8L2H5D5L2BM+11,+0U6E2R2F2D6L2U2L2D2L2BM+2,-3R2U2L2D2BM+6,+3U8R2D4E4R2G4F4L2H3GD2L2BM+16,+0L6U8R6DL4D3R2DL2D2R4DBM-27,-21U8R2F5U5R2D8L2H5D5L2BM+11,+0U8R6DL4D3R2DL2D2R4DL6BM+8,+0U6E2R2F2D6L2U2L2D2L2BM+2,-3"
700 DRAW"R2U2L2D2BM+6,+3U8R2D4E4R2G4F4L2H3GD2L2BM+13,+0U4H3UR2F2E2R2DG3D4L2":CIRCLE(180,100),20,0,.2:LINE(160,100)-(160,130),PRESET:LINE(200,100)-(200,105),PRESET:CIRCLE(180,130),20,0,.2,0,.5:LINE(160,130)-(160,140),PRESET
710 LINE(200,130)-(200,140),PRESET:CIRCLE(180,140),20,0,.2,0,.5:LINE(195,108)-(210,104),PRESET:LINE(195,130)-(210,126),PRESET:LINE(210,104)-(210,126),PRESET:LINE(195,113)-(205,110),PRESET:LINE(195,125)-(205,122),PRESET:LINE(205,110)-(205,122),PRESET
720 LINE(200,112)-(200,122),PRESET:FORX=9TO27STEP9:LINE(159+X,109)-(159+X,126),PRESET:LINE(158+X,111)-(158+X,124),PRESET:NEXT:PRESET(55,12):PRESET(53,10)
730 FORX=1TO10:XC=X*4+160:YC=100-RND(10):LINE(XC-1,YC)-(XC+1,YC),PRESET:LINE(XC,YC-1)-(XC,YC+1),PRESET:NEXT
740 DRAW"BM5,110S12RULU2D3BM+2,-1FUD2LBM+4,-1S8U5R2D2L2BM+5,+3L2URLUR2BM+2,+0R2LD2BM+5,+0L2URLUR2BM+3,+0LD2URFHUBM+7,+2H3D3U5D2E2BM+5,+5L2URLUR2BM+2,+2U2RDLRFBM+3,+0LU2RBM+3,+2HEGDU5BM+3,+0D5U2R2D2BM+2,+0U2R2D2L2BM+4,+0U5RBM+3,+0LD5BM-4,-3R6"
750 DRAW"BM30,190S8HU3ER2FD3GL2BM+5,+0U5F5U5BM+5,+0L3D2R2L2D3R3BM+5,+0U5F2E2D5BM+3,+0HU3ER2FD3GL2BM+5,+0U5F2E2D5BM+5,+0L3U3R2L2U2R3BM+2,+5U5F5U5BM+2,+0R4L2D5BM+7,+0U5R3D3L3BM+5,-3D5R3BM+5,+0L3U3R2L2U2R3BM+2,+5U3E2F2DL4R4D2BM+2,+0R3U3L3U2R3BM+5,+0L3"
760 DRAW"D2R2L2D3R3":TN$="V31T5O3L4CDL2E-DCL4CDE-FDE-L2CL4GGGGGA-GFDE-FFFGFE-L4CDL2E-DCL4CDE-FDE-L2CP8T2O4L255P8":RETURN
770 ' CHARACTER FONT TABLE
780 DATA28,82,82,82,82,82,82,28,0,0,3,FC,FC,3,0,0,0,33,33,3F,C,C,C,C,0,0,C0,3F,3F,C0,0,0,C,C,C,C,3F,33,33,0,14,14,69,69,69,69,14,14,55,55,69,7D,7D,69,55,55,A8,A8,AA,A2,A2,A2,A8,A8,3C,FF,FF,FF,FF,FF,FF,3C
790 DATA 0,0,0,0,0,0,0,0,4,4,4,4,4,0,4,0,11,11,11,0,0,0,0,0,0,0,0,0,0,0,0,0,4,15,10,4,1,15,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,1,4,4,4,4,4,1,0
800 DATA10,4,4,4,4,4,10,0,0,11,4,15,4,11,0,0,0,0,4,15,4,0,0,0,0,0,0,0,1,1,4,0,0,0,0,15,0,0,0,0,0,0,0,0,0,4,4,0,1,4,4,4,4,4,10,0,4,11,11,11,11,11,4,0,4,14,4,4,4,4,15,0
810 DATA15,1,1,15,10,10,15,0,15,1,1,5,1,1,15,0,11,11,11,15,1,1,1,0,15,10,10,15,1,1,15,0,15,10,10,15,11,11,15,0,15,1,1,1,1,1,1,0,15,11,11,15,11,11,15,0,15,11,11,15,1,1,15,0,0,4,4,0,4,4,0,0
820 DATA0,1,1,0,1,1,4,0,0,1,1,4,4,1,1,0,0,0,15,15,0,0,0,0,0,10,10,4,4,10,10,0,4,11,11,1,4,0,4,0,0,0,0,0,0,0,0,0,15,11,11,11,15,11,11,0,14,11,11,14,11,11,14,0,5,10,10,10,10,10,5,0
830 DATA14,11,11,11,11,11,14,0,15,10,10,14,10,10,15,0,15,10,10,14,10,10,10,0,15,10,10,11,11,11,5,0,11,11,11,15,11,11,11,0,15,4,4,4,4,4,15,0,1,1,1,1,11,15,4,0,11,11,14,14,11,11,11,0,10,10,10,10,10,10,15,0
840 DATA11,15,15,11,11,11,11,0,14,15,11,11,11,11,11,0,15,11,11,11,11,11,15,0,15,11,11,15,10,10,10,0,4,11,11,11,11,15,5,0,15,11,11,15,14,11,11,0,15,10,10,15,1,1,15,0,15,4,4,4,4,4,4,0,11,11,11,11,11,11,15,0
850 DATA11,11,11,11,11,11,4,0,11,11,11,11,15,15,11,0,11,11,11,4,11,11,11,0,11,11,11,11,4,4,4,0,15,1,1,15,10,10,15,0,*
860 ' MACHINE CODE FOLLOWS
870 DATAEF,DF,F7,BF,B6,7C,33,26,1B,C6,4,8E,7C,3A,A6,80,B7,FF,2,B6,FF,0,84,8,27,5,5A,26,F1,20,26,F7,7C,32,20,21,BD,A9,DE,B6,1,5D,C6,2,81,5,23,EF,C6,4,81,3A,24,E9,B6,1,5C,C6,3,81,5,23,E0,C6,1,81,3A,24,DA,CC,7A,A0
880 DATAF3,7C,30,1F,1,A6,84,B7,7C,36,CC,7B,68,F3,7C,30,1F,1,A6,84,B7,7C,35,B6,7C,32,81,1,26,5,7C,7C,36,20,19,81,2,26,5,7A,7C,35,20,10,81,3,26,5,7A,7C,36,20,7,81,4,26,3,7C,7C,35,CC,E,0,F3,7C,35,1F,1,A6,84,C6,5,81,28,27,10,5A,81,55,27,B,5A,81,3C,27,6
890 DATA5A,81,A8,27,1,5A,F7,7C,34,8E,7A,A0,A6,84,B7,7C,38,8E,7B,68,A6,84,B7,7C,37,86,20,B7,7C,39,BD,7D,7E,CC,7A,A0,F3,7C,30,1F,1,A6,84,B7,7C,38,CC,7B,68,F3,7C,30,1F,1,A6,84,B7,7C,37
900 DATA86,1C,B7,7C,39,BD,7D,7E,7A,7C,31,CC,7A,A0,F3,7C,30,1F,1,A6,84,B7,7C,38,CC,7B,68,F3,7C,30,1F,1,A6,84,B7,7C,37,86,1D,B7,7C,39,BD,7D,7E,7C,7C,31,B6,7C,32,8B,17,B7,7C,39,B6,7C,36,B7,7C,38,B6,7C,35,B7,7C,37,BD,7D,7E,8E,7A,A0,10,8E,7B,68,F6,7C,31
910 DATA12,A6,1,A7,80,A6,21,A7,A0,5A,26,F5,B6,7C,36,A7,0,B6,7C,35,A7,20,39,12,12,12
920 DATA F6,7C,39,86,8,3D,C3,7D,18,1F,1,FC,7C,37,C3,E,0,1F,2,A6,80,A7,A4,A6,80,A7,A8,20,A6,80,A7,A8,40,A6,80,A7,A8,60,A6,80,A7,A9,0,80,A6,80,A7,A9,0,A0,A6,80,A7,A9,0,C0,A6,80,A7,A9,0,E0,39,*
