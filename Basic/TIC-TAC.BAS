1 'TIC-TAC
2 'WRITTEN BY DAVID RIDINGS
3 'COPYRIGHT (C) MARCH 1991
4 'BY FALSOFT, INC.
5 'RAINBOW MAGAZINE
11 GOSUB911
12 PC=7:NC=3:BC=11:GOSUB926
15 X$="BM=X;,=Y;"
17 HBUFF1,99:HBUFF2,999:HBUFF3,999:HBUFF4,2999
21 TT$="D110BR40U110D35R40L120BD40R120"
22 TA$="C12R89D4L89U4C8":TB$="C12R4D84L4U84C8":TC$="C12BL2BD2E69F3G69H3C8":TD$="C12BR1F69G3H69E3C8"
31 HLINE(3,44)-(316,48),PSET,B:HPAINT(4,46),BC,8
33 HLINE(100,3)-(104,44),PSET,B:HPAINT(101,5),BC,8:HLINE(206,3)-(210,44),PSET,B:HPAINT(207,5),BC,8
34 A=-55:B=22:FORD=1TO3:A=A+104:HLINE(A,B)-(A+9,B+4),PSET,B:HPAINT(A+1,B+1),BC,8:NEXTD
35 X=28:Y=18:GOSUB830
36 X=235:Y=19:GOSUB812
37 X=129:Y=18:GOSUB831
38 HPAINT(5,5),10,8:HPAINT(109,5),10,8:HPAINT(214,5),10,8
40 X=79:Y=18:GOSUB829:X=183:Y=18:GOSUB829:X=287:Y=18:GOSUB829
43 HCIRCLE(11,37),4:HCIRCLE(112,37),4
45 HLINE(176,55)-(310,180),PSET,B:HPAINT(7,52),14,8
47 A=135:B=44
48 FORD=1TO8:B=B+16:GOSUB95:NEXTD
49 B=44:A=A-16:IF A<18 THEN61
50 GOTO48
61 HCOLOR14:HLINE(5,51)-(31,75),PSET,BF:HCOLOR8
62 HDRAW"BM22,65D7F2R2E2U12H2L2G2D5U3L12G2D4F2R12L5BU8U13L1D13"
63 HPAINT(21,65),8,8:HPAINT(23,65),3,8
65 HCOLOR12:HLINE(20,163)-(115,179),PSET,B:HCOLOR11:HLINE(21,164)-(114,178),PSET,B:HCOLOR12:HLINE(22,165)-(113,177),PSET,B:HPAINT(55,170),10,12:HCOLOR8
66 HPRINT(3,21),"TIC-TAC-TOE"
91 GOSUB922:GOTO101
95 HCIRCLE(A,B),6:HPAINT(A,B),11,8:RETURN
101 HPAINT(23,65),1,8
103 HCOLOR1:HLINE(26,61)-(169,58),PSET:HLINE(169,58)-(169,111),PSET:HLINE(169,111)-(26,70),PSET:HCOLOR8
104 HPAINT(43,67),0,1:GOSUB121:GOTO125
121 HCOLOR11:X=223:Y=61:HDRAWX$+TT$:X=224:Y=63:HDRAWX$+TT$:HCOLOR10:X=225:Y=62:HDRAWX$+TT$:HCOLOR8:RETURN
125 X=242:Y=112:GOSUB829:X=201:Y=77:GOSUB833:X=284:Y=157:GOSUB833    
127 HGET(188,62)-(218,93),2:HGET(228,102)-(258,133),3
128 HCOLOR4:HLINE(188,62)-(218,93),PSET,BF:HLINE(228,102)-(258,133),PSET,BF:HLINE(268,142)-(298,173),PSET,BF:HCOLOR8:GOSUB129:GOTO202
129 HPRINT(25,9),"1    2    3":HPRINT(25,14),"4    5    6":HPRINT(25,19),"7    8    9":RETURN
133 X=202:Y=158:HDRAWX$+TC$
134 GOTO134
202 HPAINT(11,37),10,8:HPAINT(112,37),10,8:R=RND(2):ON R GOTO 211,261
211 HPAINT(11,37),3,8:A$=INKEY$
212 IF A$>CHR$(48)AND A$<CHR$(58)THEN221
213 GOSUB851
214 HPAINT(11,37),10,8
215 GOSUB851
216 GOTO211
221 IF A$=CHR$(49)THEN GOSUB311
222 IF A$=CHR$(50)THEN GOSUB321
223 IF A$=CHR$(51)THEN GOSUB331
224 IF A$=CHR$(52)THEN GOSUB341
225 IF A$=CHR$(53)THEN GOSUB351
226 IF A$=CHR$(54)THEN GOSUB361
227 IF A$=CHR$(55)THEN GOSUB371
228 IF A$=CHR$(56)THEN GOSUB381
229 IF A$=CHR$(57)THEN GOSUB391
235 GOSUB918:GOSUB711:IF T=9 THEN731
237 HPAINT(11,37),10,8
239 GOTO261
261 FORF=1TO1:HPAINT(112,37),3,8
262 FORP=1TO3:GOSUB851:NEXTP
264 HPAINT(112,37),10,8
265 FORP=1TO3:GOSUB851:NEXTP
266 HPAINT(112,37),3,8
267 NEXTF
271 R=RND(9):GOSUB861
272 ON R GOSUB411,421,431,441,451,461,471,481,491
275 GOSUB918:GOSUB711:IF T=9 THEN731
277 HPAINT(112,37),10,8
298 GOTO211
299 GOTO299
311 IF L(1)=1 THEN 211
312 N(1)=24:N(2)=9:N(3)=1:GOSUB397
313 L(1)=1:A(1)=1:T=T+1
314 HPUT(188,62)-(218,93),2
315 RETURN
321 IF L(2)=1 THEN 211
322 N(1)=29:N(2)=9:N(3)=2:GOSUB397
323 L(2)=1:A(2)=1:T=T+1
324 HPUT(228,62)-(258,93),2
325 RETURN
331 IF L(3)=1 THEN211
332 N(1)=34:N(2)=9:N(3)=3:GOSUB397
333 L(3)=1:A(3)=1:T=T+1
334 HPUT(268,62)-(298,93),2
335 RETURN
341 IF L(4)=1 THEN211
342 N(1)=24:N(2)=14:N(3)=4:GOSUB397
343 L(4)=1:A(4)=1:T=T+1
344 HPUT(188,102)-(218,133),2
345 RETURN
351 IF L(5)=1 THEN211
352 N(1)=29:N(2)=14:N(3)=5:GOSUB397
353 L(5)=1:A(5)=1:T=T+1
354 HPUT(228,102)-(258,133),2
355 RETURN
361 IF L(6)=1 THEN211
362 N(1)=34:N(2)=14:N(3)=6:GOSUB397
363 L(6)=1:A(6)=1:T=T+1
364 HPUT(268,102)-(298,133),2
365 RETURN
371 IF L(7)=1 THEN211
372 N(1)=24:N(2)=19:N(3)=7:GOSUB397
373 L(7)=1:A(7)=1:T=T+1
374 HPUT(188,142)-(218,173),2
375 RETURN
381 IF L(8)=1 THEN211
382 N(1)=29:N(2)=19:N(3)=8:GOSUB397
383 L(8)=1:A(8)=1:T=T+1
384 HPUT(228,142)-(258,173),2
385 RETURN
391 IF L(9)=1 THEN211
392 N(1)=34:N(2)=19:N(3)=9:GOSUB397
393 L(9)=1:A(9)=1:T=T+1
394 HPUT(268,142)-(298,173),2
395 RETURN
397 HCOLOR4:HPRINT(N(1),N(2)),N(3):FORD=1TO29:IF BUTTON(0)=1 THEN HCOLOR8:RETURN
398 B$=INKEY$:IF B$=CHR$(32)THEN HCOLOR8:HPRINT(N(1),N(2)),N(3):GOTO211
399 NEXTD:HCOLOR8:HPRINT(N(1),N(2)),N(3):FORF=1TO49:NEXTF:GOTO397
411 IF L(1)=1 THEN 271
412 L(1)=1:A(1)=2:T=T+1
413 HPUT(188,62)-(218,93),3
419 RETURN
421 IF L(2)=1 THEN271
422 L(2)=1:A(2)=2:T=T+1
423 HPUT(228,62)-(258,93),3
429 RETURN
431 IF L(3)=1 THEN 271
432 L(3)=1:A(3)=2:T=T+1
433 HPUT(268,62)-(298,93),3
439 RETURN
441 IF L(4)=1 THEN 271
442 L(4)=1:A(4)=2:T=T+1
443 HPUT(188,102)-(218,133),3
449 RETURN
451 IF L(5)=1 THEN 271
452 L(5)=1:A(5)=2:T=T+1
453 HPUT(228,102)-(258,133),3
459 RETURN
461 IF L(6)=1 THEN 271
462 L(6)=1:A(6)=2:T=T+1
463 HPUT(268,102)-(298,133),3
469 RETURN
471 IF L(7)=1 THEN 271
472 L(7)=1:A(7)=2:T=T+1
473 HPUT(188,142)-(218,173),3
479 RETURN
481 IF L(8)=1 THEN 271
482 L(8)=1:A(8)=2:T=T+1
483 HPUT(228,142)-(258,173),3
489 RETURN
491 IF L(9)=1 THEN 271
492 L(9)=1:A(9)=2:T=T+1
493 HPUT(268,142)-(298,173),3
499 RETURN
511 HGET(3,3)-(100,44),4
512 HPUT(193,75)-(290,116),4
515 GOTO541
521 HGET(104,3)-(206,44),4
522 HPUT(193,75)-(295,116),4
525 GOTO541
531 HGET(210,3)-(316,44),4
532 HPUT(193,75)-(299,116),4
535 GOTO541
541 HPRINT(25,16),"W I N N E R"
542 GOSUB917
543 FORF=1TO29:PALETTE0,49:FORP=1TO49:NEXTP:PALETTE0,62:FORP=1TO49:NEXTP,F
544 FORZ=1TO4:HBUFF(Z)=0:NEXTZ
545 SA=0:SB=0:SC=0:GOTO1
551 GOTO551
611 SA=SA+1:HCOLOR10:HLINE(64,8)-(96,38),PSET,BF:HCOLOR8:X=79:Y=18:IF SA=10THENGOSUB811:GOTO651
612 IF SA=9THENGOSUB828:GOTO651
613 IF SA=1THEN GOSUB816:GOTO651
614 IF SA=2THENGOSUB818:GOTO651
615 IF SA=3THENGOSUB820:GOTO651
616 IF SA=4THENGOSUB822:GOTO651
617 IF SA=5THENGOSUB824:GOTO651
618 IF SA=6THENGOSUB825:GOTO651
619 IF SA=7THENGOSUB826:GOTO651
620 IF SA=8THENGOSUB827:GOTO651
621 SB=SB+1:HCOLOR10:HLINE(168,8)-(200,38),PSET,BF:HCOLOR8:X=183:Y=18:IF SB=10THENGOSUB811:GOTO661
622 IF SB=9THENGOSUB828:GOTO661
623 IF SB=1THENGOSUB816:GOTO661
624 IF SB=2THENGOSUB818:GOTO661
625 IF SB=3THENGOSUB820:GOTO661
626 IF SB=4THENGOSUB822:GOTO661
627 IF SB=5THENGOSUB824:GOTO661
628 IF SB=6THENGOSUB825:GOTO661
629 IF SB=7THENGOSUB826:GOTO661
630 IF SB=8THENGOSUB827:GOTO661
631 SC=SC+1:HCOLOR10:HLINE(272,8)-(304,38),PSET,BF:HCOLOR8
632 X=287:Y=18
633 IF SC=1THENGOSUB816:GOTO671
634 IF SC=2THENGOSUB818:GOTO671
635 IF SC=3THENGOSUB820:GOTO671
636 IF SC=4THENGOSUB822:GOTO671
637 IF SC=5THENGOSUB824:GOTO671
638 IF SC=6THENGOSUB825:GOTO671
639 IF SC=7THENGOSUB826:GOTO671
640 IF SC=8THENGOSUB827:GOTO671
641 IF SC=9THENGOSUB828:GOTO671
642 IF SC=10THENGOSUB811:GOTO671
651 'WIN-DAN
652 FORD=1TO3:GOSUB917:NEXTD
653 GOTO681
661 'WIN-COMP
662 GOSUB917:FORD=1TO3:GOSUB921:NEXTD
663 GOTO681
671 'WIN-CAT
672 GOSUB917:FORD=1TO9:GOSUB918:NEXTD
673 GOTO681
681 FORF=1TO19:PALETTE0,49:FORP=1TO49:NEXTP:PALETTE0,62:FORP=1TO49:NEXTP,F
682 HCOLOR4:HLINE(178,57)-(308,178),PSET,BF:HCOLOR8
691 FORQ=1TO9:A(Q)=0:L(Q)=0:NEXTQ:T=0
693 IF SA=10THEN511
694 IF SB=10THEN521
695 IF SC=10THEN531
697 GOSUB121:GOSUB129
699 GOTO202
711 IF A(1)=2 AND A(1)=A(2)AND A(1)=A(3)THEN X=198:Y=75:TL$=TA$:GOTO751
712 IF A(1)=2 AND A(1)=A(4)AND A(1)=A(7)THEN X=201:Y=75:TL$=TB$:GOTO751
713 IF A(1)=2 AND A(1)=A(5)AND A(1)=A(9)THEN X=209:Y=81:TL$=TD$:GOTO751
714 IF A(2)=2 AND A(2)=A(5)AND A(2)=A(8)THEN X=241:Y=75:TL$=TB$:GOTO751
715 IF A(3)=2 AND A(3)=A(6)AND A(3)=A(9)THEN X=281:Y=75:TL$=TB$:GOTO751
716 IF A(3)=2 AND A(3)=A(5)AND A(3)=A(7)THEN X=209:Y=149:TL$=TC$:GOTO751
717 IF A(4)=2 AND A(4)=A(5)AND A(4)=A(6)THEN X=198:Y=115:TL$=TA$:GOTO751
718 IF A(7)=2 AND A(7)=A(8)AND A(7)=A(9)THEN X=198:Y=155:TL$=TA$:GOTO751
721 IF A(1)=1 AND A(2)=1 AND A(3)=1 THEN X=198:Y=75:TL$=TA$:GOTO771
722 IF A(1)=1 AND A(4)=1 AND A(7)=1 THEN X=201:Y=75:TL$=TB$:GOTO771
723 IF A(1)=1 AND A(5)=1 AND A(9)=1 THEN X=209:Y=81:TL$=TD$:GOTO771
724 IF A(2)=1 AND A(5)=1 AND A(8)=1 THEN X=241:Y=75:TL$=TB$:GOTO771
725 IF A(3)=1 AND A(6)=1 AND A(9)=1 THEN X=281:Y=75:TL$=TB$:GOTO771
726 IF A(3)=1 AND A(5)=1 AND A(7)=1 THEN X=209:Y=149:TL$=TC$:GOTO771
727 IF A(4)=1 AND A(5)=1 AND A(6)=1 THEN X=198:Y=115:TL$=TA$:GOTO771
728 IF A(7)=1 AND A(8)=1 AND A(9)=1 THEN X=198:Y=155:TL$=TA$:GOTO771
729 RETURN
731 GOTO631
751 HDRAWX$+TL$:HPAINT(X+1,Y+1),0,12:GOTO621
771 HDRAWX$+TL$:HPAINT(X+1,Y+1),0,12:GOTO611
811 X=X-11:Y=Y-5:TN$="D20R5U20L5BR12G3D14F3R9E3U14H3L9BD4BR3G1D10F1R3E1U10H1L3":HDRAWX$+TN$:HPAINT(X+1,Y+1),NC,8:HPAINT(X+12,Y+1),NC,8:XA$=" TEN":RETURN
812 X=X+12:Y=Y+2:CT$="BL1E2U8G6H3L7G3H6D8F2D7F7R6E7U7":HDRAW X$+CT$
813 HCIRCLE(X-16,Y),3,,.6:HCIRCLE(X-8,Y),3,,.6:HCIRCLE(X-12,Y+4),3,,.8:HCIRCLE(X-12,Y+9),5,,.4
814 HLINE(X-6,Y+3)-(X+4,Y+3),PSET:HLINE(X-6,Y+6)-(X+1,Y+10),PSET:HLINE(X-18,Y+3)-(X-24,Y+3),PSET:HLINE(X-18,Y+6)-(X-24,Y+10),PSET
815 HPAINT(X-1,Y-1),15,8:XB$=" CAT":RETURN
816 X=X-3:Y=Y-2:OE$="D16L4D3R14U3L4U20L9D3R2"
817 HDRAW X$+OE$:HPAINT(X+2,Y),NC,8:XB$=" ONE":RETURN
818 X=X-10:Y=Y-1:TW$="U3E3R13F3D8G3L11D4R9U2R5D6L19U9E3R10E1U4H1L7G1D2L5"
819 HDRAW X$+TW$:HPAINT(X+1,Y-2),NC,8:XB$=" TWO":RETURN
820 X=X-10:Y=Y-1:TH$="U3E3R13F3D6G2F2D6G3L13H3U4R5D2F1R6E1U3H1L6U4R6E1U3H1L6G1D2L5U2":HDRAW X$+TH$:HPAINT(X+2,Y),NC,8
821 XB$="THREE":RETURN
822 X=X+5:Y=Y-7:FO$="D11R5D5L5D7L5U7L11U5E11R5L5BD8D4L5E5"
823 HDRAW X$+FO$:HPAINT(X-1,Y+1),NC,8:XB$=" FOUR":RETURN
824 X=X-9:Y=Y-6:FI$="R17D5L12D3R9F3D7G3L14U5R11E1U1H1L11U12":HDRAW X$+FI$:HPAINT(X+2,Y+2),NC,8:XB$=" FIVE":RETURN
825 X=X+9:Y=Y-1:SX$="U3H3L11G3D16F3R11E3U7H3L9U3E1R5F1D1R5BD6BL6L5G1D2F1R5E1U2H1":HDRAW X$+SX$:HPAINT(X-2,Y-2),NC,8:XB$=" SIX":RETURN
826 X=X-9:SV$="U6R20D5G9D8L6U9E9L9D2L5":HDRAWX$+SV$:HPAINT(X+2,Y-2),NC,8:XB$="SEVEN":RETURN
827 X=X-7:Y=Y+5:EI$="H2U6E3R14F3D6G2F2D6G3L14H3U6E2BR5BU3H1U2E1R6F1D2G1L6BD5G1D2F1R6E1U2H1L6":HDRAWX$+EI$:HPAINT(X+2,Y),NC,8:XB$="EIGHT":RETURN
828 X=X-7:Y=Y+11:NI$="D3F3R11E3U15H3L11G3D6F3R9D3G1L6U2L5BU6BR6R5E1U2H1L5G1D2F1":HDRAWX$+NI$:HPAINT(X+2,Y+1),NC,8:XB$=" NINE":RETURN
829 X=X-5:Y=Y-5:ZE$="G3D14F3R12E3U14H3L12BD4BR3G1D10F1R6E1U10H1L6":HDRAWX$+ZE$:HPAINT(X+2,Y+1),NC,8:XA$="ZERO":RETURN
830 HCIRCLE(X,Y+5),12:HCIRCLE(X,Y-4),13,13,.3:HPAINT(X,Y-4),12,13:HCIRCLE(X,Y-4),13,8,.3:HA$="C8BL5BD2R2D2L2U2BR8R2D2L2U2BD4BL2L2D2R2U2BR4BD2D1G3L4H3U1BL8U5BR26D5":HDRAWX$+HA$:XC$="HAPPY":RETURN
831 HCIRCLE(X,Y+5),13:HCIRCLE(X-5,Y+4),6,,.5:HCIRCLE(X+5,Y+4),6,,.5:HPAINT(X,Y-3),8,8:VI$="BD10BL1U2R2D2L2BD2L2G1E1R6F1L8BL5BU9U12D1H1F2BR16E2G1U1D12U12F1H2BL16G2":HDRAWX$+VI$
832 RETURN
833 CX$="G9R6E5F5R6H9E9L6G5H5L6F9":HDRAWX$+CX$:HPAINT(X+1,Y),3,8:RETURN
851 C=RND(155):C=C+9:D=RND(130):D=D+57:CC=RND(15):HGET(C-4,D-4)-(C+4,D+4),1:HCIRCLE(C,D),2,CC:HPUT(C-4,D-4)-(C+4,D+4),1:RETURN
861 G=1:H=2:J=3:GOSUB895
862 G=1:H=4:J=7:GOSUB895
863 G=1:H=5:J=9:GOSUB895
864 G=2:H=3:J=1:GOSUB895
865 G=2:H=5:J=8:GOSUB895
866 G=3:H=1:J=2:GOSUB895
867 G=3:H=5:J=7:GOSUB895
868 G=3:H=6:J=9:GOSUB895
869 G=4:H=7:J=1:GOSUB895
870 G=4:H=5:J=6:GOSUB895
871 G=5:H=6:J=4:GOSUB895
872 G=5:H=9:J=1:GOSUB895
873 G=5:H=8:J=2:GOSUB895
874 G=5:H=7:J=3:GOSUB895
875 G=6:H=9:J=3:GOSUB895
876 G=6:H=4:J=5:GOSUB895
877 G=7:H=8:J=9:GOSUB895
878 G=7:H=1:J=7:GOSUB895
879 G=7:H=3:J=5:GOSUB895
880 G=8:H=9:J=7:GOSUB895
881 G=8:H=2:J=5:GOSUB895
882 G=9:H=1:J=5:GOSUB895
883 G=9:H=7:J=8:GOSUB895
884 G=9:H=3:J=6:GOSUB895
885 G=1:H=7:J=4:GOSUB895
887 RETURN
895 IF T=8 AND A(R)=0 THEN 272
896 IF A(G)=1 AND A(H)=1 AND A(J)=0 THEN R=J
897 IF A(G)=2 AND A(H)=2 AND A(J)=0 THEN R=J:GOTO272
899 RETURN
911 ON BRK GOTO 916
912 PALETTE RGB:HSCREEN2:HCLS4:HCOLOR8:POKE65497,0:PALETTE0,62:PALETTE10,49:PALETTE11,14:PALETTE12,2:PALETTE13,4:PALETTE14,7:PALETTE15,52:RETURN
916 PALETTE RGB:END
917 PLAY"O1T160CDEFGABO2CDEFGABO3CDEFGABO4CDEFGAB":RETURN
918 PLAY"O2T160CDEFGAB":RETURN
919 FORT=151TO141 STEP-1:SOUNDT,1:NEXTT:SOUND41,9:RETURN
921 PLAY"O1T160CDEFGABO1CDEFGABO1CDEFGABO1CDEFGAB":RETURN
922 IF BUTTON(0)=1 THEN RETURN
923 GOTO922
925 RETURN
926 HLINE(3,3)-(316,188),PSET,B:HPAINT(1,1),BC,8:RETURN
