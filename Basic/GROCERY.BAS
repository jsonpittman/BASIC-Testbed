5 REM GROCERY LIST
6 REM BY DONALD LARGE
7 REM NORTH SYRACUSE,NY  1984
10 POKE 150,41
20 FOR Z= 1 TO 10
30 PRINT#-2,CHR$(27) CHR$(19)
40 PRINT#-2,CHR$(27) CHR$(14)
50 PRINT#-2,"  SHOPPING LIST"
60 PRINT#-2,CHR$(27) CHR$(15)
70 RESTORE
80 X$="           ---":Y$="---------------":Z$="---"
90 PRINT#-2,CHR$(27) CHR$(20)
100 PRINT#-2,,"ITEM","COUPON","BRAND",,"ITEM","COUPON","BRAND"
110 PRINT#-2,"     ************************************************************************************************************************"
120 PRINT#-2
130 FOR A= 1 TO 41
140 READ A$,B$
150 PRINT#-2,X$,A$,Z$,Y$,X$,B$,Z$,Y$
160 NEXT A
170 PRINT#-2,"SPECIAL INSTRUCTIONS:"
180 FOR A = 1 TO 5
190 PRINT#-2,"-----------------------------------------------------------------------------------------------------------------------------------"
200 NEXT A
210 PRINT#-2, CHR$(27) CHR$(19)
220 FOR V= 1 TO 8
230 PRINT#-2
240 NEXT V
250 NEXT Z
260 DATA FRESH VEG.,FROZEN VEG.,CANNED VEG.,IN.POTATOES,CEREAL,FLOUR,RICE,PANCAKE MIX,BAKING MIXES,JELLO,PUDDING,PEANUT BUTTER,JELLY,COOKIES,CRACKERS,SOUP,PICKLES,OLIVES,MILK,CHEESE,EGGS,BUTTER
270 DATA COLD CUTS,MEAT,FROZEN MEAT,CANNED MEAT,TUNA,FROZEN DINNERS,FROZEN DESERTS,ART.SWEETN'R,SUGAR,SALT,PEPPER,SPICES,COOKING OIL,CATSUP,MUSTARD,MAYONAISE,STEAK SAUCE,SALAD DRESSING,RELISH,SYRUP
280 DATA BREAD,HOTDOG BUNS,HAMBURG BUNS,DINNER ROLLS,MUFFINS,SODA,LO-CAL SODA,BEER,KOOL AID,DOG FOOD,CAT FOOD,CLEANSER,FURN.POLISH,BATTERIES,UTENSILS,GLUE,TAPE,VITAMINS,ASPRIN,SOAP,LAUNDRY DETERG.
290 DATA SOFTENER,STARCH,BLEACH,HAND LOTION,SHAMPOO,RAZOR BLADES,SHAVING CREAM,GARBAGE BAGS,STORAGE WRAP,NAPKINS,PAPER PLATES,PAPER CUPS,LUNCH BAGS,TOILET PAPER,FEM.PRODUCTS,OTHER,OTHER,OTHER,OTHER
0 DATA"Bread/cereal","Canned goods","Dairy","Frozen foods","Hygiene","Meats, fish, and poultry","Miscellaneous","Paper/detergent","Produce",9,2,7,4,3,6,1,8,5
1 WIDTH40:ONBRKGOTO8:PMODE0,1:PCLEAR1:CLEAR8000:DIMF(361),I(40),P(360),I$(360),P$(40):FORK=1TO9:READG$(K):NEXT
3 CLS:LOCATE13,2:ATTR0,0,U:PRINT"Grocery Helper";:ATTR0,0:LOCATE13,5:PRINT"by Dave LeBlanc":LOCATE8,23:PRINT"(C) 1992 Rainbow Magazine";
4 'GROCERY HELPER BY D. LEBLANC
5 'COPYRIGHT (C) 1992 FALSOFT
6 GOTO10
8 RUN
10 POKE65496,0:OPEN"D",#1,"LIST.DAT",21:FIELD#1,18ASA$,3ASB$:POKE65497,0
20 IFLOF(1)=0THENCLOSE:FORK=1TO750:NEXT:GOTO1000
22 LOCATE15,21:PRINT"Disk access":POKE65496,0:FORK=1TO360:GET#1,K:I$(K)=A$:P(K)=VAL(B$):NEXT:CLOSE:POKE65497,0
24 LOCATE13,21:PRINT"Processing data":FORK=1TO360
25 IFINSTR(I$(K),STRING$(18,32))=1THENI$(K)="":GOTO28
26 IFASC(RIGHT$(I$(K),1))=32THENI$(K)=LEFT$(I$(K),LEN(I$(K))-1):GOTO26
28 NEXT
30 ONBRKGOTO30:SOUND1,1:ATTR0,0:CLS:LOCATE16,2:PRINT"MAIN MENU":FORK=1TO8:LOCATE6,3+K:ATTR3,2:PRINTSTRING$(28,32);:NEXT:LOCATE7,5:PRINT"1. Add items to master file";:LOCATE7,6:PRINT"2. Alphabetize items";:LOCATE7,7:PRINT"3. Select items";:LOCATE7,8
31 PRINT"4. Print list";:LOCATE7,9:PRINT"5. Exit";:LOCATE7,10:PRINT"6. Clear master file";:LOCATE12,13:ATTR0,0:PRINT"Select option > ";
32 EXEC44539:A$=INKEY$:IFVAL(A$)<1ORVAL(A$)>6THENSOUND1,1:GOTO32ELSEPRINTA$:EXEC43345:ONVAL(A$)GOTO1000,2000,3000,4000,5000,6000
999 'MODIFY MASTER FILE MODULE
1000 ONBRKGOTO1000:C=0:CLS:ATTR0,0:LOCATE10,0:PRINT"MODIFICATION MODULE":PRINT" CTRL-X to exit         CTRL-H for help";:LOCATE1,2:IFG=0THENG=1
1005 PRINT"Group #"+STR$(G)+": "+G$(G):PRINT" "+STRING$(38,"-");
1010 FORK=1TO40:I(K)=0:NEXT:A=0:FORK=(G-1)*40+1TO(G-1)*40+40:IFI$(K)=""THENNEXTELSEA=A+1:I(A)=K:NEXT
1011 IFC=0THENIFA=40THENC=1ELSEC=A+1
1012 ATTR0,0:FORK=1TO40:IFK/2<>INT(K/2)THENB=3+((K+1)/2)ELSEB=3+(K/2)
1014 IFK/2<>INT(K/2)THENLOCATE1,B ELSELOCATE21,B
1015 IFK=C THENATTR2,4
1016 PRINTI$(I(K))+STRING$(18-LEN(I$(I(K))),32);
1017 IFK=C THENATTR0,0
1018 NEXT
1025 C$=I$(I(C))
1030 IFC/2<>INT(C/2)THENB=3+((C+1)/2)ELSEB=3+(C/2)
1032 IFC/2<>INT(C/2)THENLOCATE1,B ELSELOCATE21,B
1034 ATTR2,4:PRINTC$+STRING$(18-LEN(C$),32);:ATTR1,0:LOCATE39,0
1036 GOTO1050
1039 'PRINT NORMAL ITEM [ENTRY: C=POS
1040 IFC/2<>INT(C/2)THENLOCATE1,B ELSELOCATE21,B
1042 ATTR0,0:PRINT C$+STRING$(18-LEN(C$),32);:IFI(C)>0THEN1044ELSEIFC$=""THENRETURNELSEFORK=(G-1)*40+1TO(G-1)*40+40:IFI$(K)=""THENI(C)=K:A=A+1:I$(K)=C$:RETURNELSENEXT:STOP
1044 I$(I(C))=C$:RETURN
1050 IFPEEK(341)=247THEN1100
1052 IFPEEK(342)=247THEN1150
1054 IFPEEK(343)=247ORPEEK(344)=247THEN1200
1058 A$=INKEY$:IFA$=""THEN1050
1059 IFA$=CHR$(189)ORA$="^"ORA$=CHR$(8)ORA$=CHR$(9)ORA$=CHR$(10)THEN1050
1060 IFA$="_"THEN1350
1062 IFA$="["THEN1360
1064 IFA$="X"ANDPEEK(342)=191GOSUB1040:GOTO30
1066 IFA$="H"ANDPEEK(342)=191THEN1380
1068 IFA$=CHR$(12)THEN1300
1070 IFA$="\"THEN1325
1076 IFA$=CHR$(13)THEN1310
1078 IFLEN(C$)=18THENSOUND1,1:GOTO1050
1080 EXEC43345:C$=C$+A$:GOTO1030
1100 IFI(C)=0ORC$<>""THEN1110ELSEIFC<3THENIFC+38>A THEN1050ELSEI$(I(C))="":C=C+38:GOTO1010
1102 I$(I(C))="":C=C-2:GOTO1010
1110 IFC<3THENIFC+37>A THEN1050ELSEGOSUB1040:C=C+38:GOTO1025
1112 GOSUB1040:C=C-2:GOTO1025
1150 IFI(C)=0ORC$<>""THEN1160ELSEIFC>38THENI$(I(C))="":C=C-38:GOTO1010
1152 IFC+2>A THEN1050ELSEI$(I(C))="":C=C+2:GOTO1010
1160 IFC>38THENGOSUB1040:C=C-38:GOTO1025ELSEIFC+1>A THEN1050ELSEGOSUB1040:C=C+2:GOTO1025
1200 IFI(C)=0ORC$<>""THEN1210ELSEIFC/2<>INT(C/2)THENIFC=A THEN1050ELSEI$(I(C))="":C=C+1:GOTO1010
1202 I$(I(C))="":C=C-1:GOTO1010
1210 IFC/2<>INT(C/2)THENIFC$=""THEN1050ELSEGOSUB1040:C=C+1:GOTO1025
1212 GOSUB1040:C=C-1:GOTO1025
1300 IFC$=""THENSOUND1,1:GOTO1050ELSEEXEC43345:C$=LEFT$(C$,LEN(C$)-1):GOTO1030
1310 IFC$=""THENSOUND1,1:GOTO1050ELSEEXEC43345:GOSUB1040:C=C+1:IFC>40THENC=1
1312 GOTO1025
1325 EXEC43345:IFI(C)=0THENC$="":GOTO1030ELSEI$(I(C))="":GOTO1010
1350 GOSUB1040:G=G-1:IFG=0THENG=9
1352 GOTO1000
1360 GOSUB1040:G=G+1:IFG>9THENG=1
1362 GOTO1000
1380 GOSUB1040:LOCATE0,1:ATTR0,0:PRINTSTRING$(40,32);:LOCATE10,1:PRINT"Help screen engaged.";:FORK=1TO12:LOCATE7,6+K:ATTR3,2:PRINTSTRING$(26,32);:LOCATE34,7+K:ATTR0,3
1381 PRINT" ";:ATTR0,0:PRINT" ";:NEXT:LOCATE8,19:ATTR0,3:PRINTSTRING$(25,32);
1382 LOCATE8,8:ATTR2,4:PRINT"CTRL";:ATTR3,2:PRINT" + ";:ATTR2,4:PRINT"H";:ATTR3,2:PRINT" for HELP screen.";
1384 LOCATE8,9:ATTR2,4:PRINT"CTRL";:ATTR3,2:PRINT" + ";:ATTR2,4:PRINT"X";:ATTR3,2:PRINT" for MAIN MENU.";
1386 LOCATE8,10:PRINT"ARROW KEYS move cursor.";:LOCATE8,11:ATTR2,4:PRINT"CLEAR";:ATTR3,2:PRINT" to backspace.";
1388 LOCATE8,12:ATTR2,4:PRINT"SHIFT";:ATTR3,2:PRINT" + ";:ATTR2,4:PRINT"CLEAR";:ATTR3,2:PRINT" to delete";:LOCATE9,13:PRINT"item.";
1390 LOCATE8,14:ATTR2,4:PRINT"SHIFT";:ATTR3,2:PRINT" + UP or DOWN arrow";:LOCATE9,15:PRINT"moves to another group.";
1392 LOCATE8,17:PRINT"Hit any key to resume...";
1394 LOCATE36,0:ATTR1,0:PRINT" ";:EXEC44539:A$=INKEY$:ATTR0,0:LOCATE1,1:PRINT"CTRL-X to exit         CTRL-H for help";
1396 FORK=1TO15:LOCATE19,5+K:PRINT"  ";:NEXT:GOTO1010
1500 A$=INKEY$:IFA$=""THEN1500
1600 PRINTASC(A$)
1700 GOTO1500
1999 'ALPHABETIZE
2000 PRINT" Alphabetizing.":PRINT" Please wait a few moments...":LOCATE35,0:ATTR0,0,B:PRINT9;:ATTR1,0:PRINTCHR$(8);:FORK=1TO360:P(K)=K:NEXT:M=511
2010 FORK=1TO8:LOCATE35,0:ATTR0,0,B:PRINT9-K;:ATTR1,0:PRINTCHR$(8);:M=(M-1)/2
2020 IF360-M-1<0THEN2130ELSEM1=M+1:I=M1
2030 I1=P(I):M2=I-M:J=1
2040 J1=M2-J+1:I2=P(J1)
2050 IFI$(I1)>=I$(I2)THEN2100
2060 P(J1+M)=P(J1)
2070 IF J+M>M2 THEN2090
2080 J=J+M:GOTO2040
2090 P(J1)=I1:GOTO2110
2100 P(J1+M)=I1
2110 IF I+1>360THEN2130
2120 I=I+1:GOTO2030
2130 NEXTK
2140 GOTO30
3000 ONBRKGOTO3000:CLS:ATTR0,0:LOCATE13,0:PRINT"SELECT MODULE":PRINT" CTRL-X to exit         CTRL-H for help":PRINT" "+STRING$(38,"-");
3006 FORK=1TO360:IFI$(P(K))=""THENNEXT:SOUND1,1:GOTO30ELSEA=K
3010 ATTR0,0:B=A-1:FORK=1TO5
3012 LOCATE11,(6-K)*2+1:IFB=0ORI$(P(B))=""THENPRINTSTRING$(18,32);:NEXT:GOTO3020ELSEC$=I$(P(B))
3014 IFF(P(B))=1THENATTR2,4
3016 PRINTC$+STRING$(18-LEN(C$),32);:IFF(P(B))=1THENATTR1,0:LOCATE39,0:ATTR0,0
3018 B=B-1:NEXT
3020 B=A:FORK=1TO6
3022 LOCATE11,(K*2)+11:IFB>360THENPRINTSTRING$(18,32);:NEXT:GOTO3030ELSEC$=I$(P(B))
3024 IFF(P(B))=1THENATTR2,4
3026 PRINTC$+STRING$(18-LEN(C$),32);:IFF(P(B))=1THENATTR1,0:LOCATE39,0:ATTR0,0
3028 B=B+1:NEXT
3030 LOCATE8,13:PRINT"=>";:LOCATE30,13:PRINT"<=";:ATTR1,0:LOCATE39,0
3040 IFPEEK(341)=247THEN3200
3042 IFPEEK(342)=247THEN3250
3043 K=PEEK(341)AND64:IFK>0THENW$=""
3044 A$=INKEY$:IFA$=""THEN3040
3046 IFA$="@"ORA$=CHR$(189)ORA$="^"ORA$=CHR$(10)THEN3040
3048 IFA$=CHR$(13)THEN3300
3050 IFA$="_"THEN3006
3052 IFA$="["THENA=360:GOTO3010
3054 IFA$="X"ANDPEEK(342)=191THEN30
3056 IFA$="H"ANDPEEK(342)=191THEN3375
3058 IFPEEK(341)=191THENW$=W$+A$ ELSEW$=A$
3059 IFLEN(W$)=1THENFORK=1TO360ELSEFORK=A TO360
3060 IFINSTR(I$(P(K)),W$)<>1THENNEXT:SOUND1,1:W$="":GOTO3040ELSEA=K:IFPEEK(341)<>191THENW$=""
3062 GOTO3010
3200 IFA-1=0ORI$(P(A-1))=""THEN3040ELSEA=A-1:GOTO3010
3250 IFA+1>360THEN3040ELSEA=A+1:GOTO3010
3300 IFF(P(A))=0THENF(P(A))=1ELSEF(P(A))=0
3302 GOTO3010
3375 LOCATE0,1:ATTR0,0:PRINTSTRING$(40,32);:LOCATE10,1:PRINT"Help screen engaged.";:FORK=1TO17:LOCATE7,4+K:ATTR3,2:PRINTSTRING$(26,32);:LOCATE34,5+K:ATTR0,3
3376 PRINT" ";:ATTR0,0:PRINT" ";:NEXT:LOCATE8,22:ATTR0,3:PRINTSTRING$(25,32);
3378 LOCATE8,6:ATTR2,4:PRINT"CTRL";:ATTR3,2:PRINT" + ";:ATTR2,4:PRINT"H";:ATTR3,2:PRINT" for HELP screen.";
3380 LOCATE8,7:ATTR2,4:PRINT"CTRL";:ATTR3,2:PRINT" + ";:ATTR2,4:PRINT"X";:ATTR3,2:PRINT" for MAIN MENU.";
3382 LOCATE8,8:PRINT"UP arrow moves cursor up";:LOCATE9,9:PRINT"one item.";:LOCATE8,10:PRINT"DOWN arrow moves cursor";:LOCATE9,11:PRINT"down one item.";
3384 LOCATE8,12:ATTR2,4:PRINT"SHIFT";:ATTR3,2:PRINT" + UP arrow moves";:LOCATE9,13:PRINT"cursor to top of items.";
3386 LOCATE8,14:ATTR2,4:PRINT"SHIFT";:ATTR3,2:PRINT" + DOWN arrow moves";:LOCATE9,15:PRINT"cursor to end of items.";
3388 LOCATE8,16:ATTR2,4:PRINT"ENTER";:ATTR3,2:PRINT" selects an item.";:LOCATE8,17:ATTR2,4:PRINT"A";:ATTR3,2:PRINT"-";:ATTR2,4:PRINT"Z";:ATTR3,2
3390 PRINT" for letter search.";:LOCATE8,18:ATTR2,4:PRINT"ALT";:ATTR3,2:PRINT" for word search.";
3392 LOCATE8,20:PRINT"Hit any key to resume...";
3394 LOCATE36,0:ATTR1,0:PRINT" ";:EXEC44539:A$=INKEY$:ATTR0,0:LOCATE1,1:PRINT"CTRL-X to exit         CTRL-H for help";
3396 FORK=1TO18:LOCATE7,4+K:PRINTSTRING$(27,32);:NEXT:GOTO3010
4000 PRINT" Make sure printer is on and positioned  to top of form and strike any key...":EXEC44539
4002 POKE65496,0:PRINT#-2,CHR$(27)CHR$(77);:POKE65497,0:RESTORE:FORK=1TO9:READA$:NEXT
4004 FORA=1TO3:FORB=1TO3:L(B)=0:NEXT:FORB=1TO40:P$(B)="":NEXT:FORK=1TO3:READK(K):NEXT:FORK=1TO3:FORL=(K(K)-1)*40+1TO(K(K)-1)*40+40:IFF(L)=1THENL(K)=L(K)+1
4006 NEXTL,K:IFL(1)=>L(2)ANDL(1)=>L(3)THENI=L(1):GOTO4012
4008 IFL(2)=>L(1)ANDL(2)=>L(3)THENI=L(2):GOTO4012
4010 IFL(3)=>L(1)ANDL(3)=>L(2)THENI=L(3)
4012 IFI=0THENNEXTA:GOTO30
4014 FORK=1TO3:B=0
4016 FORL=(K(K)-1)*40+1TO(K(K)-1)*40+40:IFF(L)=0THENNEXTL:GOTO4019ELSEB=B+1:C$=I$(L):Z=INSTR(C$,","):IFZ=0THEN4018ELSEC$=MID$(I$(L),Z+1)+" "+LEFT$(I$(L),Z-1)
4017 IFASC(LEFT$(C$,1))=32THENC$=RIGHT$(C$,LEN(C$)-1):GOTO4017
4018 P$(B)=P$(B)+"___ "+C$+STRING$(20-LEN(C$),32):NEXTL
4019 IFB<I THENFORL=B+1TO I:P$(L)=P$(L)+STRING$(24,32):NEXT
4020 NEXTK:POKE65496,0:FORK=1TO I:PRINT#-2,P$(K):NEXT:PRINT#-2,CHR$(13):POKE65497,0:NEXTA
4022 POKE65496,0:PRINT#-2,CHR$(27)CHR$(19);:POKE65497,0:GOTO30
5000 PRINT" You sure? ";
5002 EXEC44539:A$=INKEY$:IFA$<>"N"ANDA$<>"Y"THENSOUND1,1:GOTO5002ELSEPRINTA$:EXEC43345:IFA$="N"THEN30
5004 PRINT" Saving memory to disk.":PRINT" One moment please..."
5006 OPEN"D",#1,"LIST.DAT",21:FIELD#1,18ASA$,3ASB$
5010 POKE65496,0:FORK=1TO360:LSETA$=I$(K):LSETB$=MID$(STR$(P(K)),2):PUT#1,K:NEXT:CLS:END
6000 PRINT" You sure? ";
6002 EXEC44539:A$=INKEY$:IFA$<>"N"ANDA$<>"Y"THENSOUND1,1:GOTO6002ELSEPRINTA$:EXEC43345:IFA$="N"THEN30
6004 PRINT" NO RETURN beyond this point!!":PRINT" Hit ENTER key to clear disk and         restart. Hit ESC to abort..."
6006 EXEC44539:A$=INKEY$:IFA$<>CHR$(13)THENSOUND1,1:GOTO6006ELSEEXEC43345
6008 PRINT" Trashing file...":POKE65496,0:KILL"LIST.DAT":RUN
