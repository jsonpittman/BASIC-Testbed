0 GOTO90
5 CLEAR200,&H2000:DIMA(50),B(50):CLS:PRINT"IMORTALITY FINDER":PRINT"BY PAUL ALGER":PRINT
10 PRINT"ENTER FILENAME/EXT: ";:LINEINPUTFI$:INPUT"HOW MANY MEN DO YOU START WITH";C1:PRINT"INSERT DISK WITH "FI$" AND HIT ENTER. ";:LINEINPUTZ$
15 OPEN"D",#1,FI$,1:IF LOF(1)=0 THEN CLOSE:KILL FI$:RUN
20 FIELD#1,1 AS A$:B=LOF(1):FORQ=1TO5:GET#1,Q:C(Q)=ASC(A$):NEXTQ:CLOSE:ST=(C(4)*256+C(5)):LG=(C(2)*256+C(3)):ED=ST+LG:OF=&H2000-ST:IF OF<1THENOF=0
25 IF OF+ED>&H8000 THENPRINT"WHEN IO ERROR OCCURS, TYPE:":PRINT"GOTO35
30 LOADMFI$,OF
35 CLS(3):PRINT@5,"FILENAME:";:PRINT@16,FI$;
40 PRINT@66,"START";:PRINT@73,USING"#####";ST;:PRINT@66+64,"END  ";:PRINT@73+64,USING"#####";ED;:PRINT@66+32,"NOW  ";:PRINT@73+32,USING"#####";M;
45 PRINT@81,"LDA'S ";:PRINT@89,USING"####";LA;:PRINT@81+32,"LDB'S ";:PRINT@89+32,USING"####";LB;:PRINT@81+64,"POKES ";:PRINT@89+64,USING"####";0;
50 FOR M=ST+OF TO ED+OF
55 FORM=ST+OF TO ED+OF:PRINT@105,USING"#####";M-OF;
60 IF PEEK(M)=&H86 THEN LA=LA+1:PRINT@89,USING"####";LA;:IF PEEK(M+1)=C1 OR PEEK(M+1)=C1+1THEN L=L+1:A(L)=M-OF:PRINT@153,USING"####";L+L1;
65 IF PEEK(M)=&HC6 THEN LB=LB+1:PRINT@121,USING"####";LB;:IF PEEK(M+1)=C1 OR PEEK(M)=C1+1 THEN L1=L1+1:B(L1)=M-OF:PRINT@153,USING"####";L+L1;
70 NEXT:PRINT@321," ";:INPUT"DONE... HIT ENTER TO PRINT";Z$
75 CLS:PRINT"PRINT TO [S]CREEN OR [P]RINTER.":PRINT"(ENTER P OR S) ";:LINEINPUTZ$:IFZ$="P"THEND=2ELSED=0
80 PRINT#-D,"FILENAME: ";FI$:PRINT#-D,"DECIMAL","HEX":FORX=1TOL:PRINT#-D,A(X)+1,HEX$(A(X)+1):NEXT:FORX=1TOL1:PRINT#-D,B(X)+1,HEX$(B(X)+1):NEXT
85 PRINT"HIT ENTER TO PRINT AGAIN.":LINEINPUTZ$:GOTO75
90 PCLEAR1:GOTO5
