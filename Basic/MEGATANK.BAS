1 'MEGATANK
2 'BY MARSHALL WEISENBURGER
3 'COPYRIGHT (C) AUGUST 1991
4 'BY FALSOFT, INC.
5 'RAINBOW MAGAZINE
10 '****************************
20 '*       MEGA TANK          *
30 '*          BY              *
40 '*  MARSHALL WEISENBURGER   *
50 '*        8/20/87           *
60 '****************************
70 ON BRK GOTO 1970
80 POKE 65497,0:P$="O1L225CDEFG"
90 GOTO830
100 '***MAINLOOP***
110 A=JOYSTK(0)
120 IFA<15THENA1=A1-8
130 IFA>53THENA1=A1+8
140 IFA1<0THEN A1=0:HPUT(A1,179)-(A1+36,191),3:A1=198
150 IFA1>199THEN A1=199:HPUT(A1,179)-(A1+36,191),3:A1=0
160 Y=Y+R:IFY>135THENGOSUB640:GOSUB600
170 D=D+.2:E=SIN(D):IFE>0THEN X=X+I ELSE X=X-I
180 IFX=322THEN210
190 IFX>207THENX=207
200 IFX<0THENX=0
210 H=H+1:IFH=1THENPALETTE13,W:PALETTE14,V
220 IFH=2THENPALETTE14,W:PALETTE15,V
230 IFH=3THENPALETTE15,W:PALETTE13,V:H=0
240 HPUT(X,Y)-(X+28,Y+17),U,PSET:IFG=1THEN260
250 HPUT(X1,Y)-(X1+28,Y+17),U,PSET
260 HPUT(A1,179)-(A1+36,191),1,PSET:IFBUTTON(1)=1THENGOSUB560
270 IFBUTTON(0)=0THEN110
280 SOUND230,1:B=A1+19:HCOLOR3,0:HLINE (B,155)-(B,0),PSET:HCOLOR0,0: HLINE (B,155)-(B,0),PSET
290 IF X+14>B-14 AND X+14<B+14 THEN 320 ELSE IF X1+14>B-14 AND X1+14<B+14 THEN 380
300 M2=1:M1=M1+1:HCOLOR0,0:HLINE(249,71)-(279,79),PSET,BF:HCOLOR4,0:HPRINT(31,9),M1:IF M1<5THEN110
310 M1=0:SOUND1,2:SOUND1,2:SOUND1,2:HCOLOR0,0:HLINE(249,71)-(279,79),PSET,BF:HCOLOR4,0:HPRINT(31,9),M1:GOSUB670:GOTO110
320 GOSUB750
330 HCOLOR0,0:HLINE(X,Y)-(X+28,Y+17),PSET,BF:X=322:I=0:J=J+1
340 S=S+T:GOSUB440
350 IFJ=1ANDG=1THENGOSUB600:GOTO100
360 IFJ=2THENGOSUB600:GOTO100
370 GOTO110
380 IFG=1THEN110
390 GOSUB760
400 S=S+T:GOSUB440
410 HCOLOR0,0:HLINE(X1,Y)-(X1+28,Y+17),PSET,BF:X1=329:J=J+1
420 IFJ=2THENGOSUB600:GOTO100
430 GOTO110
440 '*** SCORE ***
450 IF S=1000THEN HCOLOR0,0:HLINE(X,Y)-(X+28,Y+17),PSET,BF:HLINE(X1,Y)-(X1+28,Y+17),PSET,BF:GOSUB600:GOSUB800:R=4:T=250:U=5:V=38:W=0:I1=3:M2=0
460 IF S=4000THEN HCOLOR0,0:HLINE(X,Y)-(X+28,Y+17),PSET,BF:HLINE(X1,Y)-(X1+28,Y+17),PSET,BF:GOSUB600:GOSUB800:R=6:T=500:U=6:V=36:W=0:I1=4:M2=0
470 IF S=12000THEN HCOLOR0,0:HLINE(X,Y)-(X+28,Y+17),PSET,BF:HLINE(X1,Y)-(X1+28,Y+17),PSET,BF:GOSUB600:GOSUB800:R=7:T=1000:U=7:V=36:W=63:I1=5:M2=0
480 IF S=30000THEN HCOLOR0,0:HLINE(X,Y)-(X+28,Y+17),PSET,BF:HLINE(X1,Y)-(X1+28,Y+17),PSET,BF:GOSUB600:GOSUB800:R=8:T=1500:U=8:V=55:W=32:I1=6:M2=0
490 HCOLOR0,0:HLINE(254,23)-(316,30),PSET,BF
500 HCOLOR4,0:HPRINT(31,3),S
510 IF HS>S THEN RETURN
520 HS=S
530 HCOLOR0,0:HLINE(254,47)-(316,54),PSET,BF
540 HCOLOR4,0:HPRINT(31,6),HS
550 RETURN
560 '*** SUPER SAVER TEST ***
570 IF Z=0 THEN RETURN
580 Z=Z-1:HCOLOR0,0:HLINE(249,103)-(279,111),PSET,BF:HCOLOR4,0:HPRINT(31,13),Z
590 PLAY "L4O4CEG":HCOLOR0,0:HLINE(X,Y)-(X+28,Y+17),PSET,BF:HLINE(X1,Y)-(X1+28,Y+17),PSET,BF
600 '*** RANDOM SHIP POSITION ***
610 I=I1:J=0:G=RND(2):X1=RND(207):X=RND(207):Y=0:D=0
620 IF X-X1<40THEN610
630 RETURN
640 '*** ENEMY LANDS ***
650 SOUND1,1:SOUND1,1:SOUND1,1:SOUND1,1
660 HCOLOR0,0:HLINE(X,Y)-(X+28,Y+17),PSET,BF:HLINE(X1,Y)-(X1+28,Y+17),PSET,BF
670 Q=Q-1:IFQ=4THEN N=278:O=168
680 IFQ=3THEN N=239
690 IFQ=2THEN N=278:O=151
700 IFQ=1THEN N=239
710 IFQ=0THEN1610
720 HCOLOR0,0:HLINE(N,O)-(N+36,O+12),PSET,BF
730 RETURN
740 '*** ENEMY EXPLOSION ***
750 HPUT(X,Y)-(X+28,Y+17),9:GOTO770
760 HPUT(X1,Y)-(X1+28,Y+17),9
770 PLAY P$:PALETTE9,32:PLAY P$:PALETTE12,38:PLAY P$:PALETTE12,0:PLAY P$:PALETTE9,0
780 RETURN
790 '*** BONUS SUPER ZAPPER CHECK ***
800 IF M2=1 THEN RETURN
810 Z=Z+1:HCOLOR0,0:HLINE(249,103)-(279,111),PSET,BF:HCOLOR4,0:HPRINT(31,13),Z
820 RETURN
830 '***BUFFERS AND COLORS***
840 HSCREEN2:HBUFF1,247:HBUFF2,247:HBUFF3,247:HBUFF4,270:HBUFF5,270:HBUFF6,270:HBUFF7,270:HBUFF8,270:HBUFF9,270
850 PALETTE0,0:PALETTE1,0:PALETTE2,0:PALETTE3,0:PALETTE4,0:PALETTE5,0:PALETTE6,0:PALETTE7,0:PALETTE8,0:PALETTE9,0:PALETTE10,0:PALETTE11,0:PALETTE12,0:PALETTE13,0:PALETTE14,0:PALETTE15,0
860 HCLS0
870 '*** TANK /W GREY BACKGROUND ***
880 HCOLOR11,0:HLINE(20,10)-(57,22),PSET,BF
890 HCOLOR 1,0:HLINE(28,19)-(49,20),PSET,BF:HLINE(30,17)-(31,22),PSET,BF:HLINE(34,17)-(35,22),PSET,BF:HLINE(38,17)-(39,22),PSET,BF:HLINE(42,17)-(43,22),PSET,BF:HLINE(46,17)-(47,22),PSET,BF
900 HCOLOR8,0:HLINE(29,16)-(29,18),PSET:HLINE(30,15)-(47,16),PSET,BF:HLINE(32,17)-(33,18),PSET,BF:HLINE(36,17)-(37,18),PSET,BF:HLINE(40,17)-(41,18),PSET,BF:HLINE(44,17)-(45,18),PSET,BF:HLINE(48,16)-(48,18),PSET
910 HCOLOR6,0:HLINE(36,14)-(41,14),PSET:HLINE(38,10)-(39,13),PSET,B
920 HGET(20,10)-(56,22),1
930 '*** TANK /W BLACK BACKGROUND ***
940 HCOLOR1,0:HLINE(68,19)-(89,20),PSET,BF:HLINE(70,17)-(71,22),PSET,BF:HLINE(74,17)-(75,22),PSET,BF:HLINE(78,17)-(79,22),PSET,BF:HLINE(82,17)-(83,22),PSET,BF:HLINE(86,17)-(87,22),PSET,BF
950 HCOLOR8,0:HLINE(69,16)-(69,18),PSET:HLINE(70,15)-(87,16),PSET,BF:HLINE(72,17)-(73,18),PSET,BF:HLINE(76,17)-(77,18),PSET,BF:HLINE(80,17)-(81,18),PSET,BF:HLINE(84,17)-(85,18),PSET,BF:HLINE(88,16)-(88,18),PSET
960 HCOLOR6,0:HLINE(76,14)-(81,14),PSET:HLINE(78,10)-(79,13),PSET,B
970 HGET(60,10)-(96,22),2
980 '*** BLANK TANK ***
990 HCOLOR11,0:HLINE(200,10)-(237,22),PSET,BF
1000 HGET(200,10)-(236,22),3
1010 '*** HELICOPTER DRAWING ***
1020 HCOLOR4,0:HLINE(248,6)-(248,7),PSET:HLINE(244,8)-(251,8),PSET:HLINE(243,9)-(252,9),PSET:HLINE(242,10)-(263,10),PSET:HLINE(241,11)-(263,11),PSET:HLINE(241,12)-(253,12),PSET:HLINE(242,13)-(252,13),PSET:HLINE(243,14)-(251,14),PSET
1030 HCOLOR1,0:HLINE(245,15)-(245,16),PSET:HLINE(249,15)-(249,16),PSET:HLINE(241,15)-(242,17),PSET:HLINE(242,17)-(257,17),PSET:HLINE(245,9)-(246,11),PSET,B:HLINE(244,10)-(244,11),PSET:HSET(243,11,1)
1040 HCOLOR13,0:HLINE(241,5)-(255,5),PSET:HLINE(266,7)-(266,11),PSET
1050 HCOLOR14,0:HLINE(250,3)-(246,7),PSET:HLINE(264,8)-(268,10),PSET
1060 HCOLOR15,0:HLINE(246,3)-(250,7),PSET:HLINE(264,10)-(268,8),PSET
1070 HGET(240,0)-(268,17),4
1080 '*** GIANT FLY DRAWING ***
1090 HCOLOR1,0:HSET(281,8,1):HSET(288,8,1):HLINE(282,7)-(282,9),PSET:HLINE(287,7)-(287,9),PSET:HLINE(283,6)-(283,10),PSET:HLINE(286,6)-(286,10),PSET:HLINE(284,6)-(285,15),PSET,B:HLINE(282,13)-(287,14),PSET,B:HLINE(283,15)-(283,17),PSET
1100 HLINE(286,15)-(286,17),PSET
1110 HSET(283,14,6):HSET(286,14,6)
1120 HCOLOR13,0:HLINE(287,11)-(293,15),PSET:HLINE(287,11)-(293,14),PSET:HLINE(287,11)-(293,13),PSET:HLINE(282,11)-(275,15),PSET:HLINE(282,11)-(275,14),PSET:HLINE(282,11)-(275,13),PSET
1130 HCOLOR14,0:HLINE(287,11)-(293,12),PSET:HLINE(287,11)-(293,11),PSET:HLINE(287,11)-(293,10),PSET:HLINE(282,11)-(275,12),PSET:HLINE(282,11)-(275,11),PSET:HLINE(282,11)-(275,10),PSET
1140 HCOLOR15,0:HLINE(287,11)-(293,9),PSET:HLINE(287,11)-(293,8),PSET:HLINE(287,11)-(293,7),PSET:HLINE(282,11)-(275,9),PSET:HLINE(282,11)-(275,8),PSET:HLINE(282,11)-(275,7),PSET
1150 HGET(270,0)-(298,17),6
1160 '*** FIRE BALL DRAWING ***
1170 HCIRCLE(14,112),1,13:HCIRCLE(14,112),4,13:HCIRCLE(14,112),2,14:HCIRCLE(14,112),5,14:HCIRCLE(14,112),3,15
1180 HGET(0,100)-(28,117),8
1190 '*** FLYING SAUCER DRAWING ***
1200 HCOLOR2,0:HLINE(109,8)-(120,8),PSET:HLINE(108,9)-(121,9),PSET:HLINE(107,10)-(122,10),PSET
1210 HCOLOR4,0:HLINE(106,11)-(123,12),PSET,B:HLINE(106,16)-(123,17),PSET,B
1220 HCOLOR13,0:HLINE(106,13)-(107,15),PSET,B:HLINE(112,13)-(113,15),PSET,B:HLINE(118,13)-(119,15),PSET,B
1230 HCOLOR14,0:HLINE(108,13)-(109,15),PSET,B:HLINE(114,13)-(115,15),PSET,B:HLINE(120,13)-(121,15),PSET,B
1240 HCOLOR15,0:HLINE(110,13)-(111,15),PSET,B:HLINE(116,13)-(117,15),PSET,B:HLINE(122,13)-(123,15),PSET,B
1250 HGET (100,0)-(128,17),7
1260 '*** EXPLOSION DRAWING ***
1270 HCOLOR7,0:HLINE(148,8)-(157,9),PSET,B:HLINE(152,5)-(153,12),PSET,B
1280 HCOLOR9,0:HLINE(150,3)-(155,4),PSET,BF:HLINE(146,6)-(147,11),PSET,BF:HLINE(150,13)-(155,14),PSET,BF:HLINE(158,6)-(159,11),PSET,BF
1290 HLINE(148,5)-(151,7),PSET,BF:HLINE(148,10)-(151,12),PSET,BF:HLINE(154,10)-(157,12),PSET,BF:HLINE(154,5)-(157,7),PSET,BF
1300 HSET(149,4,9):HSET(149,13,9):HSET(156,4,9):HSET(156,13,9)
1310 HCOLOR12,0:HLINE(142,8)-(142,9),PSET:HLINE(143,6)-(143,11),PSET:HLINE(144,4)-(145,13),PSET,BF:HLINE(146,3)-(147,5),PSET,BF:HLINE(146,12)-(147,14),PSET,BF:HLINE(148,2)-(149,3),PSET,B:HLINE(148,14)-(149,15),PSET,B:HSET(148,4,12):HSET(148,13,12)
1320 HLINE(152,0)-(153,0),PSET:HLINE(150,1)-(155,2),PSET,B:HLINE(150,15)-(155,16),PSET,B:HLINE(152,17)-(153,18),PSET
1330 HLINE(154,1)-(155,2),PSET,B:HLINE(156,14)-(157,14),PSET,B:HLINE(156,2)-(157,3),PSET,B:HLINE(155,13)-(156,14),PSET,B:HLINE(158,3)-(159,5),PSET,B:HLINE(158,12)-(159,14),PSET,B:HLINE(160,4)-(161,13),PSET,B:HLINE(162,6)-(162,11),PSET
1340 HLINE(163,8)-(163,9),PSET
1350 HGET(140,0)-(168,17),9
1360 '*** ROTATING BLADES DRAWING ***
1370 HCOLOR13,0:HLINE(184,5)-(184,16),PSET:HLINE(185,5)-(183,16),PSET:HLINE(183,5)-(185,16),PSET
1380 HCOLOR14,0:HLINE(176,6)-(193,16),PSET:HLINE(176,7)-(193,15),PSET:HLINE(193,17)-(176,5),PSET
1390 HCOLOR15,0:HLINE(176,14)-(192,8),PSET:HLINE(175,13)-(192,9),PSET:HLINE(175,15)-(192,7),PSET
1400 HGET(170,0)-(198,17),5
1410 '*** SETUP FOR SCREEN ***
1420 HCLS
1430 HCOLOR2,0:HLINE(317,0)-(236,192),PSET,B
1440 HCOLOR6,0:HPRINT(31,2),"SCORE"
1450 HCOLOR6,0:HPRINT(31,5),"HI SCORE"
1460 HPRINT(30,17),"NO. SHIPS"
1470 HPRINT(31,8),"MISSES"
1480 HCOLOR6,0:HPRINT(31,11),"SUPER"
1490 HPRINT(31,12),"SAVERS"
1500 HCOLOR11,0:L=175
1510 FOR K=0 TO 235
1520 N=RND(2):IF N=1 THEN L=L+1 ELSE L=L-1
1530 IF L>178 THEN L=178
1540 IF L<156 THEN L=156
1550 HSET(K,L)
1560 NEXT K
1570 HLINE(235,L)-(235,191),PSET
1580 HPAINT (100,189),11,11
1590 GOTO1640
1600 '*** END OF GAME ***
1610 HPUT(A1,179)-(A1+36,191),3,PSET
1620 HCOLOR0,0:HLINE(X,Y)-(X+28,Y+17),PSET,BF:HLINE(X1,Y)-(X1+28,Y+17),PSET,BF
1630 ' *** START UP ***
1640 PALETTE0,0:PALETTE1,8:PALETTE2,9:PALETTE3,47:PALETTE4,18:PALETTE5,18:PALETTE6,36:PALETTE7,55:PALETTE8,40:PALETTE9,0:PALETTE10,55:PALETTE11,56:PALETTE12,0:PALETTE13,40:PALETTE14,0:PALETTE15,0
1650 PLAY "T3L6O2B-O3L12CP90CP90CP90CP90CP90CL8E-P90E-P90L12E-P90E-CP90CP90CP90CP90CP50CL8O2B-P90B-P90L12B-P90B-O3CP90CP90CP90CP90CP90CL6E-FO2B-O3CO2L55BAGFEDCO1BAGFEDC"
1660 HCOLOR5,0:HPRINT(10,1),"MEGA TANK":HPRINT(3,17),"PRESS ANY KEY TO BEGIN"
1670 H=0:RESTORE
1680 FOR F=0TO4
1690 HCOLOR0,0:HLINE(7,103)-(87,93),PSET,BF:HLINE(167,103)-(220,93),PSET,BF
1700 READ M$,M,U,V,W
1710 HCOLOR6,0:HPRINT(1,12),M$
1720 HPRINT(22,12),M
1730 HPUT(110,86)-(138,103),U
1740 FOR PP=1TO25
1750 FOR XY=1TO40:NEXTXY
1760 H=H+1:IFH=1THENPALETTE13,W:PALETTE14,V
1770 IFH=2THENPALETTE14,W:PALETTE15,V
1780 IFH=3THENPALETTE15,W:PALETTE13,V:H=0
1790 P=RND(63):PALETTE5,P
1800 A$=INKEY$:IF A$<>""THENGOTO1840
1810 NEXT PP
1820 NEXT F
1830 GOTO1670
1840 HCOLOR0,0:HLINE(77,6)-(152,15),PSET,BF
1850 HLINE(7,103)-(87,93),PSET,BF
1860 HLINE(110,86)-(138,104),PSET,BF
1870 HLINE(167,103)-(220,93),PSET,BF
1880 HLINE(15,132)-(210,146),PSET,BF
1890 HCOLOR0,0:HLINE(249,103)-(279,111),PSET,BF:HLINE(249,71)-(279,79),PSET,BF
1900 M1=0:HCOLOR4,0:HPRINT(31,9),M1
1910 Z=2:HPRINT(31,13),Z
1920 S=0:A1=100:J=0:Q=5:R=3:T=100:U=4:V=36:W=0:I1=0
1930 HPUT(239,151)-(275,163),2,PSET:HPUT(239,168)-(275,180),2,PSET:HPUT(278,151)-(314,163),2,PSET:HPUT(278,168)-(314,180),2,PSET
1940 GOSUB440:GOSUB600
1950 GOTO100
1960 DATA CHOPPERS,100,4,36,0,BLADES,250,5,38,0,BATS,500,6,36,0,SAUCERS,1000,7,36,63,FIREBALLS,1500,8,55,32
1970 RGB:POKE 65496,0
