10 CLS0
20 CLEAR2500
30 DIM BA$(14),G(6,4),G$(8),T(14),L(6),L$(6),Z(6)
40 '
50 '***STOCK TICKER*86**********
60 '***BY MARK WEBB ************
70 '***FOR COCO 1&2*************
80 '***REVISED AUG. 88**********
90 '***BOX 793 GOLD RIVER B.C.**
100 '**CANADA***VOP 1G0*********
110 '
120 POKE142,0
130 X=RND(-TIMER)
140 PL$(1)="V31O5T100L1GABBGABBGABBGABBGABBGABBGABBGABBGABBGABB"
150 PL$(2)="V31T64O1L4CCFFCCFFCCFFCCFFBCCFFCCFFCCFFCCFFCCFFCCFFCCFFCCFFCCFF"
160 PL$(3)="V31T32O4BAGFEDCO3BAGFEDCO2BAGFEDCO1BAGFEDC"
170 PL$(4)="V31T32O2CDEFGABO3CDEFGABO4CDEFGABO5CDEFGAB"
180 PL$(5)="V31L16T255O4CEGBDFACEGBDFACEGBDFACEGBDFA"
190 PL$(6)="V31T28O4L4V15CV13CV11CV9CV7CV5CV3CV1CV3CV5CV7CV9CV11CV13CV15C"
200 G$(1)=STRING$(31,249):G$(2)=STRING$(31,246)
210 G$(3)=STRING$(32,143):G$(4)=STRING$(31,143)
220 U=1:AD=0
230 FORX=1TO6:READ D1$:S$(X)=D1$:NEXTX
240 DATA GOLD,SILVER,OIL,BONDS,INDUST,GRAIN
250 FORX=1TO6:L(X)=100:NEXTX
260 FORX=1TO4
270 FORX1=1TO32
280 READD1:G$(4+X)=G$(4+X)+CHR$(D1)
290 NEXTX1,X
300 DATA 128,128,167,175,175,175,175,170,128,128,128,128,128,167,175,175,175,175,170,128,128,128,128,128,167,175,175,175,175,170,128,128
310 DATA 128,167,175,175,175,175,175,170,128,128,128,128,167,175,175,175,175,175,170,128,128,128,128,167,175,175,175,175,175,170,128,128
320 DATA 128,143,143,143,143,143,175,170,128,128,128,128,143,143,143,143,143,175,170,128,128,128,128,143,143,143,143,143,175,170,128,128
330 DATA 128,143,143,143,143,143,174,128,128,128,128,128,143,143,143,143,143,174,128,128,128,128,128,143,143,143,143,143,174,128,128,128
340 'title page layout
350 CLS3
360 SOUNDRND(255),1
370 FORX=1TO14:PRINT@32*X,CHR$(249);:PRINT@32*X+31,CHR$(249);:NEXTX
380 PRINT@0,STRING$(32,249);:PRINT@480,STRING$(31,249);
390 POKE1055,249
400 POKE 1535,249
410 PRINT@70,"***STOCK TICKER*86**";
420 PRINT@138,"BY M.WEBB";
430 PRINT@297-32,"JAN/06,1984";
440 PRINT@265-32," COPYRIGHT ";
450 PRINT@326,"COCO 1-2 VERSION";
460 PRINT@387,"UPDATED MARCH 86 & AUG 88";
470 IF INKEY$=""THEN470ELSE480
480 '# of players set up
490 CLS3:PLAY"V31"
500 SOUNDRND(88),3
510 PRINT@70,"HOW MANY PLAYERS(1-4)";:INPUTP
520 IF P=4 THEN 560
530 PRINT@162,"DO YOU WISH HAL TO PLAY ALSO";
540 I$=INKEY$:IFI$="" THEN 540
550 IF I$="Y" OR I$="N" THEN 560 ELSE540
560 PRINT@162,STRING$(30,175);
570 IF I$="N" THEN JJ=70:HF=88
580 FORX=1TO5:SOUNDRND(255),1:NEXTX
590 IFP>4 THEN 480
600 FORX=1TOP
610 PRINT@134+(X-1)*64,"PLAYER #";X;"NAME";:INPUTN$(X)
620 NEXTX
630 IF P=4 THEN 650
640 IF I$="Y" THEN P=P+1:N$(P)="HAL"
650 FORX=1TOP:M(X)=10000:NEXTX
660 PLAYPL$(5)
670 CLS7
680 FORX=5 TO 26
690 PRINT@32+X,CHR$(159);
700 PRINT@448+X,CHR$(159);
710 NEXTX
720 FORX=3 TO 12
730 PRINT@32*X+3,CHR$(159);:PRINT@X*32+28,CHR$(159);
740 NEXTX
750 PRINT@103,"HOW MANY ROUNDS";
760 PRINT@199,"(200-400) IS AVG.";
770 PRINT@301,"?   ";
780 R$="":R=0
790 I$=INKEY$:IFI$=""THEN790
800 IFI$=CHR$(8) THEN PRINT@302,STRING$(4,143);:GOTO780
810 IFI$=CHR$(13) THEN830
820 R$=R$+I$:PRINT@302,R$;:GOTO790
830 PRINT@395,"OK? (Y/N)";:SOUND22,1
840 I$=INKEY$:IFI$=""THEN840
850 IFI$<>"Y" THEN I$=CHR$(8):GOTO800
860 R=VAL(R$):IFR<=0 THEN 670
870 PLAY PL$(6)
880 '
890 CLS
900 TP$=STRING$(6,128)+"stock"+CHR$(128)+"ticker"+STRING$(14,128)
910 PRINT TP$
920 POKE1043,56:POKE1044,54
930 PRINT@33,N$(1);:PRINT@49,N$(2);:PRINT@257,N$(3);:PRINT@273,N$(4);
940 PRINT@39,"$";:PRINT@55,"$";:PRINT@263,"$";:PRINT@279,"$";
950 IF M(1)<1 THEN M(1)=0
960 IF M(2)<1 THEN M(2)=0
970 IF M(3)<1 THEN M(3)=0
980 IF M(4)<1 THEN M(4)=0
990 FORX=1 TO P
1000 M(X)=INT(100*M(X))/100
1010 NEXTX
1020 PRINT@40,M(1);:PRINT@56,M(2);:PRINT@264,M(3);:PRINT@280,M(4);
1030 FORX=1TO6
1040 PRINT@32*X+33,LEFT$(S$(X),2);:PRINT@32*X+49,LEFT$(S$(X),2);
1050 NEXTX
1060 FORX=8TO13
1070 PRINT@32*X+33,LEFT$(S$(X-7),2);:PRINT@32*X+49,LEFT$(S$(X-7),2);
1080 NEXT X
1090 FORX=32TO192STEP32
1100 PRINT@4+X+32,G(X/32,1);:PRINT@20+X+32,G(X/32,2);:PRINT@228+X+32,G(X/32,3);:PRINT@244+X+32,G(X/32,4);
1110 NEXT X
1120 FORX=0 TO 5
1130 PRINT@480+X*5,L(X+1);
1140 NEXT X
1150 'draw a square beside player
1160 IFU=1THENPRINT@32,CHR$(159);
1170 IFU=2THENPRINT@48,CHR$(159);
1180 IFU=3THENPRINT@256,CHR$(159);
1190 IFU=4THENPRINT@272,CHR$(159);
1200 'main loop
1210 BS$=INKEY$
1220 IF BS$="Q" THEN FL=0
1230 IF BS$="A" THEN FL=1
1240 IF FL=1 THEN 1350
1250 IF BS$="H" THEN GOTO2640
1260 IF BS$="^" THEN U=U+1:IF U>P THEN U=1
1270 IFBS$="^"THEN 880
1280 IFBS$="B"THEN1910
1290 IF JJ=70 THEN 1310
1300 IF U=P THEN IF BS$="C" THEN JJ=70:GOTO2860
1310 IFBS$="S"THEN1910
1320 IFBS$=CHR$(32)THEN1350
1330 BS$=""
1340 GOTO1210
1350 'dice roll and adjustments
1360 IF HF=88 THEN 1380
1370 IF RND(3)=2 THEN IF U=P THEN GOSUB2790
1380 RC=RC+1:IFRC>=R THEN 2400
1390 U=U+1:IF U>P THEN U=1
1400 'roll three dice
1410 PLAYPL$(2)
1420 D(1)=RND(6):D(2)=RND(3):D(3)=RND(3)
1430 IF D(2)=2 THEN IF RND(10)>7 THEN D(2)=RND(2)*2+-1
1440 IFD(3)=1THEN D(3)=5
1450 IFD(3)=2THEN D(3)=10
1460 IFD(3)=3THEN D(3)=20
1470 'ADJUST UP & DOWN
1480 GOSUB1620
1490 IF D(2)=1 THEN L(D(1))=L(D(1))+D(3):PLAYPL$(4)
1500 IF L(D(1))>=200 THEN GOSUB1730
1510 IF D(2)=2 THEN L(D(1))=L(D(1))-D(3):PLAYPL$(3)
1520 IF L(D(1))<=0 THEN GOSUB1820
1530 'dividend routine
1540 IF D(2)=3 THEN 1550 ELSE 1610
1550 IFL(D(1))<100THEN FORX=1TO500:NEXTX:GOTO 1610
1560 PLAY PL$(1)
1570 FORX=1TOP
1580 DV=G(D(1),X)/100*D(3)
1590 M(X)=M(X)+DV
1600 NEXT X
1610 GOTO 880
1620 CLS0
1630 PRINT@71,"# ROLLS LEFT "+STR$(R-RC);
1640 PRINT@160,G$(5);:PRINT@192,G$(6);
1650 PRINT@224,G$(7);:PRINT@256,G$(7);
1660 PRINT@288,G$(8);
1670 PRINT@257,LEFT$(S$(D(1)),5);
1680 IF D(2)=1 THENPRINT@269,"UP";
1690 IF D(2)=2 THENPRINT@268,"DOWN";
1700 IF D(2)=3 THENPRINT@269,"DIV";
1710 PRINT@279,D(3);
1720 RETURN
1730 'splitting routine
1740 PRINT@396,"IT SPLIT!!";
1750 FORX=1TO3:PLAYPL$(1):NEXTX
1760 PRINT@396,"IT SPLIT!!";
1770 L(D(1))=100
1780 FORX=1TOP
1790 G(D(1),X)=G(D(1),X)*2
1800 NEXTX
1810 RETURN
1820 'breaking routine
1830 L(D(1))=100
1840 PRINT@396,"IT BROKE . . .";
1850 PRINT@384+32,"IT FELL THROUGH THE FLOOR EH!";
1860 FOR X=1TOP
1870 G(D(1),X)=0
1880 NEXTX
1890 FORX=1TO 8:SOUND122,1:SOUND20,1:NEXTX
1900 RETURN
1910 'buy & sell routine
1920 'display stocks first
1930 SOUND200,1
1940 CLS0
1950 PRINT@8,STRING$(17,236);:PRINT@232,STRING$(17,227);
1960 FORX=0TO7:PRINT@X*32+7,CHR$(229);:PRINT@X*32+25,CHR$(234);:NEXTX
1970 PRINT@266,CHR$(239);:PRINT@277,CHR$(239);:PRINT@297,CHR$(227);:PRINT@298,CHR$(236);:PRINT@299,CHR$(227);:PRINT@308,CHR$(227);:PRINT@309,CHR$(236);:PRINT@310,CHR$(227);
1980 PRINT@320,STRING$(32,239);
1990 FOR X= 352TO448 STEP32:PRINT@X,G$(3);:NEXTX:PRINT@480,G$(4);:POKE1535,143
2000 PRINT@40,"GOLD   IS AT";L(1);
2010 PRINT@72,"SILVER IS AT";L(2);
2020 PRINT@104,"OIL    IS AT";L(3);
2030 PRINT@136,"BONDS ARE AT";L(4);
2040 PRINT@168,"INDUST IS AT";L(5);
2050 PRINT@200,"GRAIN  IS AT";L(6);
2060 PRINT@301,LEFT$(N$(U),6);
2070 PRINT@354,USING"$$#########";M(U);
2080 IFBS$="B"THENPRINT@333,"BUYING";
2090 IFBS$="S"THENPRINT@333,"SELLING";
2100 PRINT@484,"PRESS *ENTER* TO RETURN";
2110 PRINT@390,"HOW MANY SHARES";:INPUTS:SOUNDRND(233),2
2120 IFS=0THEN880
2130 IFS<500 THEN 2110
2140 PRINT@423,"OF WHICH STOCK ";:INPUTU$:SOUND233,2
2150 FORX=1TO6:IFLEFT$(U$,2)=LEFT$(S$(X),2)THEN2160ELSE NEXTX:I$="N":GOTO2200
2160 V=S/100*L(X)
2170 PRINT@454,"VALUE IS";V;"OK(Y/N)";:PLAY"T255O5CGDGECCGDGECC"
2180 PRINT@485,"PRESS **Q** TO RETURN    ";
2190 I$=INKEY$:IF I$=""THEN2190
2200 IF I$="N"  THEN PRINT@462,STRING$(8,143);:PRINT@405,STRING$(8,143);:PRINT@438,STRING$(8,143);:GOTO2110
2210 IF I$="Q"THEN880
2220 IF BS$="B" THEN GOSUB2250:GOTO 2240
2230 IF BS$="S" THEN GOSUB2340
2240 GOTO880
2250 'value calculator to buy
2260 IF V<=M(U) THEN 2310
2270 PRINT@390,"SORRY BUT YOU DONT    ";
2280 PRINT@423,"HAVE ENOUGH MONEY     ";
2290 PRINT@454,STRING$(21,143);
2300 SOUND30,20:RETURN
2310 G(X,U)=G(X,U)+S
2320 M(U)=M(U)-V
2330 RETURN
2340 'value calculator to sell
2350 IFG(X,U)>=S THEN2360 ELSE PRINT@390,STRING$(24,143);:PRINT@423,STRING$(24,143);:PRINT@454,STRING$(24,143);:PRINT@423,"NICE TRY BUDDY";
2355 FORXW=1 TO 333:NEXTXW:GOTO880
2360 G(X,U)=G(X,U)-S
2370 M(U)=M(U)+V
2380 RETURN
2390 'end routine here eh
2400 CLS6:PRINT@167,"TIMES UP FOLKS!!";
2410 PRINT@227,"ALL STOCKS WILL NOW BE SOLD!";
2420 SOUND220,20
2430 SOUND200,20
2440 SOUND220,20
2450 SOUND200,20
2460 FORX=1TOP
2470 FORY=1TO6
2480 V=G(Y,X)/100*L(Y)
2490 M(X)=M(X)+V
2500 NEXTY
2510 NEXTX
2520 FORX=1TO6:PLAYPL$(X):NEXTX
2530 CLS8
2540 FORX=3TO P*3 STEP 3
2550 PRINT@X*32,N$(X/3);:PRINT@X*32+7,USING"$$#########";M(X/3);
2560 NEXTX
2570 PN=1:HS=M(1)
2580 FORX=2 TO P
2590 IF M(X)>HS THEN HS=M(X):PN=X
2600 NEXTX
2610 FORX=1 TO 1333:NEXTX
2620 PRINT@490,N$(PN)+" WINS EH!";
2630 GOTO2630
2640 'help menu here
2650 CLS
2660 PRINT@10,"STOCK TICKER";
2670 PRINT@42,"------------";
2680 PRINT@102,"H = HELP";
2690 PRINT@134,"C = ORIGINAL BUY FOR HAL"
2700 PRINT@166,"A = AUTO ROLL";
2710 PRINT@230,"Q = QUIT AUTO ROLL";
2720 PRINT@262,"B = BUY STOCKS";
2730 PRINT@198,"S = SELL STOCKS";
2740 PRINT@483," PRESS ANY KEY TO RETURN";
2750 EXEC44539
2760 GOTO 880
2780 'hal routine
2790 IF M(U)<1000 THEN 2855
2800 CLSRND(8):PRINT@166,"I'M GONNA BUY";
2810 Y=0
2820 X=RND(6)
2830 Y=Y+1:IFY=12 THEN2855
2840 IF M(U)>=500/100*L(X) THEN G(X,U)=G(X,U)+500:M(U)=M(U)-500/100*L(X)
2850 GOTO 2820
2855 RETURN
2860 'auto buy for hals 
2870 ' original buying
2880 FOR X=1 TO 10
2890 RS=RND(6)
2900 G(RS,U)=G(RS,U)+1000
2910 M(U)=M(U)-1000
2920 NEXTX
2930 U=1
2940 GOTO 880
