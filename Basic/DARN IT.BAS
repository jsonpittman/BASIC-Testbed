1 'DARN IT
2 'BY KENNETH REIGHARD, JR.
3 'COPYRIGHT 1992
100 DIM U(52), C(52), P(52), G(6,6), S(15), R(6), O(52)
105 CLS:INPUT"MONITOR (R/C)";Q$:IF Q$="R" THEN MN=-1 ELSE IF Q$="C" THEN MN=0 ELSE 105
107 CLS
110 POKE 65497,0
115 ON BREAK GOTO 180
119 GOSUB 1500 'BLANK SCREEN
120 GOSUB 1800 'DRAW CARDS
123 GOSUB 2400 'DRAW TITLES
125 GOSUB 1400 'RESET COLORS
127 GOSUB 2500 'PLAY MUSIC
130 GOSUB 200 'SHUFFLE CARDS
140 GOSUB 300 'DEAL CARD ARRAYS
150 GOSUB 400 'SET UP SCREEN
160 GOSUB 500 'PLAY GAME
165 HCOLOR 7:HPRINT(11,15),"Play again (Y/N)?"
170 Q$=INKEY$:IFQ$="Y" THEN HCLS:GOTO 130 ELSE IF Q$="N" THEN 180 ELSE IF Q$="O" THEN GOSUB 2600:HLINE(72,112)-(264,128),PRESET,BF:GOTO 160 ELSE 170
180 GOSUB 1400:POKE 65496,0:CLS:END
199 'SHUFFLE CARDS
200 FOR X=1 TO 52:U(X)=0:NEXT X
210 X=RND(-TIMER)
220 FOR X=1 TO 52
230 Y=RND(52):IF U(Y)<>0 THEN 230
240 U(Y)=1:C(X)=Y
245 NEXT X
250 RETURN
299 'SET UP CARD ARRAYS
300 P=1
310 FOR X=1 TO 6:FOR Y=1 TO 6
320 G(X,Y)=C(P)
325 P=P+1
330 NEXT Y,X
340 FOR X=1 TO 15
350 S(X)=C(X+36)
360 NEXT X
370 P(1)=C(52)
372 FOR X=1 TO 6:R(X)=6:NEXT X
374 Z=15:Q=1:CL=36:O=0
380 RETURN
399 'SET UP SCREEN
400 HCOLOR 4,8:HCLS
410 FOR X=1 TO 6:FOR Y=1 TO 6
420 C=G(X,Y):GOSUB 700
430 NEXT Y, X
440 X=2:Y=17:C=78:GOSUB 700
450 X=5:Y=17:C=P(1):GOSUB 700
455 GOSUB 900
460 RETURN
499 'PLAY GAME
500 V=1
510 H=V*40+17:HDRAW"C2BM=H;,112XA$;"
520 Q$=INKEY$:IF Q$="" THEN 520
530 HDRAW"C8BM=H;,112XA$;"
540 IF Q$=CHR$(8) THEN V=V-1:IF V<1 THEN V=6
550 IF Q$=CHR$(9) THEN V=V+1:IF V>6 THEN V=1
560 IF Q$=CHR$(32) THEN GOSUB 1000
570 IF Q$=CHR$(13) THEN GOSUB 1100
580 IF Q$="Q" THEN 650
585 IF Q$="O" THEN GOSUB 2600
590 IF CL=0 THEN GOSUB 2200:GOTO 650
592 IF Z=0 THEN GOSUB 1300:IF NOT(CM) THEN GOSUB 2300:GOTO 650
600 GOTO 510
650 RETURN
699 'PUT CARD ON SCREEN
700 HPUT(X*40-1,Y*8-2)-(X*40+33,Y*8+52),(INT(C/14)+1)
710 CC=C
712 IF CC>52 THEN 750
715 IF CC<27 THEN HCOLOR 3 ELSE HCOLOR 8
720 GOSUB 800
730 IF CC=1 THEN C$="A" ELSE IF CC<10 THEN C$=RIGHT$(STR$(CC),1) ELSE IF CC=10 THEN C$="10" ELSE IF CC=11 THEN C$="J" ELSE IF CC=12 THEN C$="Q" ELSE C$="K"
740 HPRINT(X*5,Y),C$
750 RETURN
799 'GET CARD VALUE
800 IF CC>13 THEN CC=CC-13:GOTO 800
810 RETURN
899 'PRINT CARDS LEFT IN DECK
900 HCOLOR5:HLINE(88,176)-(104,184),PSET,BF
910 HCOLOR7:IF Z>9 THEN HPRINT(10,22),Z ELSE HPRINT(11,22),"0"+RIGHT$(STR$(Z),1)
920 RETURN
999 'GET CARD OFF DECK
1000 IF Z=0 THEN 1030
1005 Q=Q+1:P(Q)=S(Z)
1010 X=5:Y=17:C=P(Q):GOSUB 700
1020 Z=Z-1:IF Z=0 THEN X=2:Y=17:C=65:GOSUB 700 ELSE GOSUB 900
1025 O=O+1:O(O)=0
1027 PLAY"O3L100C"
1030 RETURN
1099 'PLAY CARD FROM GRID
1100 IF R(V)=0 THEN 1210
1110 CC=P(Q):GOSUB 800:QQ=CC
1120 CC=G(V,R(V)):GOSUB 800
1130 IF QQ=13 THEN GOSUB 1600:GOTO 1210
1140 IF NOT(CC=QQ+1 OR CC=QQ-1) THEN GOSUB 1700:GOTO 1210
1150 X=V:Y=R(V):C=65:GOSUB 700
1160 Q=Q+1:P(Q)=G(V,R(V)):R(V)=R(V)-1
1170 IF R(V)>0 THEN X=V:Y=R(V):C=G(V,R(V)):GOSUB 700
1180 X=5:Y=17:C=P(Q):GOSUB 700
1185 O=O+1:O(O)=V
1190 PLAY"O2L100ABDC"
1200 CL=CL-1
1210 RETURN
1299 'CHECK FOR LEGAL MOVES
1300 CM=0
1310 CC=P(Q):GOSUB 800:QQ=CC
1320 IF QQ=13 THEN 1370
1330 FOR X=1 TO 6
1335 IF R(X)=0 THEN 1360
1340 CC=G(X,R(X)):GOSUB 800
1350 IF CC=QQ+1 OR CC=QQ-1 THEN CM=-1
1360 NEXT X
1370 RETURN
1399 'SET COLORS
1400 IF MN THEN RGB ELSE CMP
1410 RETURN
1499 'SET COLORS TO BLACK
1500 FOR X=0 TO 8:PALETTE X,0:NEXT X
1510 RETURN
1599 'PLAY ON KING MESSAGE
1600 HCOLOR 3:HPRINT(6,15),"Can't play a card on a King."
1610 PLAY"L100O2ECECECECECECECECP8"
1620 HLINE(48,120)-(272,128),PRESET,BF
1630 RETURN
1699 'ILLEGAL MOVE MESSAGE
1700 HCOLOR 3:HPRINT(13,15),"Illegal Move."
1710 PLAY"L100O1CACACACACACACACACP8"
1720 HLINE(104,120)-(208,128),PRESET,BF
1730 RETURN
1799 'DRAW CARD TEMPLATES
1800 HCOLOR 8,4:HSCREEN 2
1810 FOR X=1 TO 6
1820 HBUFF X,993
1830 HLINE(6,7)-(42,61),PSET,B
1840 ON X GOSUB 1900,1930,1960,1990,2020,2040
1850 HGET(6,7)-(40,61),X
1860 HCLS
1870 NEXT X
1880 A$="U10NF5G5"
1890 RETURN
1900 HDRAW"C3BM23,38H5U2ER2F2E2R2FD2G5C8"
1910 HPAINT(22,36),3,3
1920 RETURN
1930 HDRAW"C3BM23,38H5E5F5G5C8"
1940 HPAINT(22,36),3,3
1950 RETURN
1960 HDRAW"BM23,38LU3G2H2E2R2H2E3F3G2R2F2G2H2D3L"
1970 HPAINT(23,36),8,8
1980 RETURN
1990 HDRAW"BM23,38LU3G2L2U4E5F5D4L2H2D3L"
2000 HPAINT(23,36),8,8
2010 RETURN
2020 HPAINT(22,36),8,8
2030 RETURN
2040 HPAINT(23,42),5,8
2050 FOR Y=3 TO 15 STEP 3
2060 HCIRCLE(24,42),Y,0,1,.5,0
2070 NEXT Y
2080 HCOLOR 0
2090 HLINE(8,43)-(38,43),PSET
2100 FOR Y=0 TO 3:HPAINT(24-(Y*3+4),42),Y,0:HCIRCLE(24,42),Y*3+3,Y,1,.5,0:NEXT Y
2110 HCIRCLE(24,42),15,5
2120 HCOLOR 5:HLINE(8,43)-(38,43),PSET
2130 HCIRCLE(24,20),4,1:HPAINT(23,20),1,1
2140 HCOLOR 7:FOR Y=1 TO 2:HLINE(6+Y,7+Y)-(42-Y,61-Y),PSET,B:NEXT Y
2150 RETURN
2199 'WIN MESSAGE
2200 HCOLOR 1:HPRINT(11,14),"We Have a Winner!!"
2210 PLAY"O2L8G#GF#GG#GF#P8D#DC#DD#DC#P8C#D#F#P8C#D#F#P8F#GG#A#BP255BP255B"
2220 RETURN
2299 'LOSE MESSAGE
2300 HCOLOR 3:HPRINT(9,14),"No moves,"+STR$(CL)+" cards left."
2310 PLAY"O1L4EDL2C"
2320 RETURN
2399 'TITLE SCREEN
2400 HCOLOR 4,8:HCLS
2410 O$="C3D50R10E10U30H10L10BR45BD10C2NF10G10D10ND30R20NU10D30BR15BU40C1ND50R10F10G10NL10M+10,+30BR15BU40C6ND50M+20,+50U50BR35BU10C7R10NR10D50NL10R10BR15BU60C5R10NR10D50BR25BU60C0D40BD5D5"
2420 FOR X=1 TO 5
2430 H=40+X:V=10+X:HDRAW"BM=H;,=V;XQ$;"
2440 NEXT X
2450 HCOLOR 4:HPRINT(14,13),"A Card Puzzle"
2460 HPRINT(8,18),"By Kenneth Reighard, Jr."
2470 HPRINT(13,23),"Copyright 1992"
2480 RETURN
2499 'THEME MUSIC
2500 FOR X=1 TO 17
2510 PLAY"O2T=X;L4F#GG#"
2520 NEXT
2530 PLAY"T2L2G"
2540 RETURN
2599 'OOPS ROUTINE
2600 IF O=0 THEN 2650
2610 IFO(O)=0 THEN Z=Z+1:Q=Q-1: IF Z=1 THEN X=2:Y=17:C=78:GOSUB 700:GOSUB 900:GOTO 2630 ELSE GOSUB 900:GOTO 2630
2620 R(O(O))=R(O(O))+1:Q=Q-1:X=O(O):Y=R(O(O)):C=G(O(O),R(O(O))):GOSUB 700:CL=CL+1
2630 X=5:Y=17:C=P(Q):GOSUB 700
2640 O=O-1
2645 PLAY"L100O1BD"
2650 RETURN
