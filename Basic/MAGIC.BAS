0 ' COPYRIGHT 1989 FALSOFT, INC
10 ' WINTER MAGIC
20 ' COPYRIGHT 1989
30 ' BY JOHN H. MOSLEY
40 POKE65497,0:PCLEAR4:CLEAR3000
50 PALETTE12,0:PALETTE13,18
60 FORT=&HF00 TO &HF56:READ A$:A$="&H"+A$:POKET,VAL(A$):NEXTT
70 DATA 8E,10,00,C6,A0,A6,84,3D,1F,02,31,A9,40,00,A6,01,31,A6,8C,15,00,27,38,8D,23,A6,03,A7,A4,A6,84,AB,02,A7,84,C6,A0,3D,1F,02,31,A9,40,00,A6,01,31,A6,8D,0A,A6,A4,A7,03,6F,A4
80 DATA 30,04,20,C7,C6,30,10,8C,60,00,2B,07,5C,31,A9,E0,00,20,F3,F7,FF,A2,39,86,7A,B7,FF,A2,39,00,00
90 FORT=&HF80 TO &HFBB:READ A$:A$="&H"+A$:POKET,VAL(A$):NEXTT
100 DATA 8E,10,00,C6,A0,A6,84,3D,1F,02,31,A9,40,00,A6,01,31,A6,8C,15,00,27,1D,8D,08,A6,A4,A7,03,30,04,20,E2,C6,30,10,8C,60,00,2B,07,5C,31,A9,E0,00,20,F3,F7,FF,A2,39,86,7A,B7,FF,A2,39,00,00
110 CLS:INPUT"      MONIOR TYPE:                    (1)-COMPOSITE                   (2)-RGB                         ---> ";A$
120 IF A$="1" THEN M=0
130 IF A$="2" THEN M=1
140 IF A$<>"1" AND A$<>"2" THEN SOUND100,3:GOTO 110
150 GOSUB 580:FORT=0 TO 15:PALETTET,C(T):NEXTT:GOSUB300
160 X=0:FORT=&H1000 TO &H113C STEP 4:POKET,RND(256)-1:POKET+1,X:X=X+1:NEXTT
170 X=176:FORT=&H1140 TO &H127C STEP 4:POKET,RND(256)-1:POKET+1,X:X=X+1:NEXTT
180 FORT=&H1002 TO &H127E STEP 20:POKET,2:POKET+&H280,2:POKET+4,4:POKET+&H284,4:POKET+8,1:POKET+&H288,1:POKET+12,3:POKET+&H28C,3:POKET+16,5:POKET+&H290,5:NEXTT
190 X=0:FORT=&H1280 TO &H13BC STEP 4:POKET+1,X
200 D=PEEK(T-&H280):E=D+128:IFE>255 THEN E=E-256
210 POKET,E
220 X=X+1:NEXTT
230 X=176:FORT=&H13C0 TO &H14FC STEP 4:POKET+1,X
240 D=PEEK(T-&H280):E=D+128:IFE>255 THEN E=E-256
250 POKET,E
260 X=X+1:NEXTT
270 EXEC&HF80
280 FORT=0 TO 15:PALETTET,C(T):NEXTT
290 EXEC&HF00:GOTO 290
300 HSCREEN2:HCLS 5:GOSUB 500:HDRAW"C0BM0,84R9ER9ER15ER33FR29FR9FR12FR9FR16FR15FR25FR10ER16ER19ER9ER16ER12ER21ER40":HPAINT(300,191),0,0
310 C$="C13U4RD4RU4RND4UC7RER6ER3ERER2EH6LH3LH3UDF3NL6RFR4ER2E2L2HLH2LHUH2L2HL2HFR2FR4ERE3LH6UHUNH5R3EH5UHUH2UH2UHGDGDG5LG3LGLGR2FRF2R4NEL4HG4LG3FR3FR3NE4DG5LG2L2F2R2FR3FR2FR2L2HL2GDG2LGLGLGLGL2FRFRFRFR2FR2FR3FR9BU5BL17RE2UEUE"
320 E$="L2H3LHUH2UBU3BL3E2U2EU3EU2BR5BDH2UHUHUHU2BU4BLE2UEU2":HDRAW"BM234,162;"+C$:HDRAW"BM244,151;"+E$:HPAINT(240,120),8,7:HDRAW"C14;BM242,166LH2BL2BD4L6BH2RE2BR3D2":HDRAW"BM169,124RE3BR9FRFRBG2BDL3GL5HLBE2UBE2BR2FDFBD20BRL3GL2GLGLG2LGLGLG2LG3LG5"
330 HDRAW"BM139,113L4GL2GLGL5GLGLGLG2LG4LGDBU26BL13LGL2G2LG2LGLGLG2LG":HDRAW"BM75,144R9FR3FR2FR4FR4FR3BD23BL10R9FR3FR2FR5FR4FR2":HDRAW"BM12,89D7BR31BDEUE3UBD25BR7LGLGLGLG2LG3D":HDRAW"BM15,115U2EUEUE2"
340 HDRAW"BM0,99R37FR3FRF2RFRFRFR2FR3FRFR2FRFR2FRFRFRF2RFRFRFRFRFRFRFRF2RFR2F2R2FRFRFRF2RFRF4RF4DF5RF2DF9D2FDF3RFRFRFRF4RF3RF9RF9"
350 HDRAW"BM0,102R15FR12FR4FRF2RFR2F2R3FRFR3FRFR3F2RFR2FRFRFRFRFR2F2R2F2RFR2F3RF2RFRFRF3RFRFD2F2DF4DF4RF4DF5DF4DF2DF3DF3DF3DF4DF9":HPAINT(1,100),3,14
360 HDRAW"C12BM175,120R5U17EU5EU2EU3EUEUE2UE4RER6FR3F6LU2EUL2H2ER3UL7HL2UE5UG5UGDL2GL3GL2U2LD2GDG3DGDGD2L2U30EU4EUE6REUE2RERER2ER2ER2ER16ER4FHL8HL13GL2GL2GL2GLGLU3GD2LDGLDGLG4DGLU22E2U3E6LGL2DRGLDLDLHU2HU7HU2LD11L3FRDFD27LH2UH4LHL2FR2"
370 HDRAW"BM168,41DRDRDRDRD2FDFDFD4FD30U3LHUH2UH4UHUHGH2LHL9GL5G2LG3DGRURURURUR3ULER6UNR11DR11D2LDR2F4DFDF2DFDFD2FD2FD27":HPAINT(178,110),12,12
380 HDRAW"C4BM20,101;R8BR7R2FRFRFR2FBD4BR6R2FR2FRFBR5R2FRF2RBD2RFRFR2FBD3BR8RF2RFR2F2RBR11BD9F3RF7BU3BR3FDFRF8DF2DFDBL4BD4F10DF4BU4BR3RF11DF4"
390 H$="C14E2BR5RFBL4BDU2BU2BL2C13U3RD3RU3RND3UC7R7ER5ER2H2LH2LH7UFRFR2FR3H8UHU2NL4RFR4H6UHUH2U2HGDG3DG6LG2DNLR7EREGLGLG2DG6LGFR5NE3G6L2GR3F2R3FR18":HDRAW"BM284,100;"+H$:D$="DFDFBD7BL3DGDGDGDBR5BUDFDF2RF3BL9BU2DG3BU6BL4DG2LG"
400 HDRAW"C12BM189,74;U5HUH2F2DFRU6EGD11U3E3U3E2G2D2R2ER":HDRAW"BM206,62;D4GD3ER3E":HDRAW"BM210,76;E2UEU2EUEU6EU3D3GD5EUE6":HDRAW"BM210,78;R3HR10FRFHLHL8URER2E10REGLG7R2ER4ER2":HDRAW"BM210,81;DRDR6EGL6DF4DF":HDRAW"BM209,86D4GD3U3EU4RF3DF2DFDF"
410 HDRAW"BM30,150;"+H$:HDRAW"BM80,180;"+C$:HDRAW"BM34,112;"+D$:HDRAW"BM90,169;"+E$:HPAINT(36,120),8,7:HPAINT(86,150),8,7:HDRAW"BM288,62;"+D$:HPAINT(290,70),8,7:HDRAW"C14BM78,182;G2LRBF2LR7BE2BR2LH2BL4D2"
420 HDRAW"BM90,95;"+H$:HDRAW"BM94,57;"+D$:HPAINT(96,65),8,7:HDRAW"BM296,146;"+H$:HDRAW"BM300,108;"+D$:HPAINT(302,116),8,7
430 HDRAW"C12BM190,44R3UR6UR4EGL4DFR2F":HDRAW"BM192,36U2RU9EU2D2GD5RU2EUEUER5FHL4E2RE":HDRAW"BM204,34RUEUEUEUEUEU3EU3D3GRE2R3L3G2LD5UERERER2":HDRAW"BM207,29R2ER2ER2E":HDRAW"BM216,33R3UR6FRFRLHLHL3URE3":HDRAW"BM217,37R3FRFDF3H3UHUNL3R3F2R3NF3E3U"
440 HDRAW"BM205,29U2HUH":HDRAW"BM207,37R3FRFD4FD4U4HU4F6R2FR5L5HL2FDFDF":HDRAW"BM189,16NLNHU3EU3ENU6E2RERE":HDRAW"BM189,15;R6DNR5UERERE4U"
450 HDRAW"BM183,17U4H2F2RE2UE":HDRAW"BM179,10U2EU2NE3DR2F2":HDRAW"BM177,6U5E":HDRAW"BM175,6UH2LH":HDRAW"BM170,5D5FD2FD3RLHL2UL4GER4UH2U2HNU3L2G2":HDRAW"BM175,39UHNU5H2LH"
460 HDRAW"BM164,41L2GLDNL4G3DG":HDRAW"BM171,47L3GL2":HDRAW"BM169,40U2HU9EUEUDGDGLDUHUH2U":HDRAW"BM165,39LULULULDU3HU5EUEGDGD3LUHU7EGD6H3LHL":HDRAW"BM161,36L2HL3GL2G3DG2E2UE3R2E2RL6HUHUHUHFDFDFDL5UH2UHUHFDFDF2DL3GL2G2"
470 HDRAW"BM166,70ULU2LU15EGD11LU2H2UH2U":HDRAW"BM161,73L3GLGNL4DG2L":HDRAW"BM160,68H4NU5H3UH2":HDRAW"BM154,68L7EL3ENL10L3ULH4UDF4RFENU5U2H2U2HU2H"
480 HDRAW"BM139,75L12GL2GER2ER6UH3UH2F2DF3D2LGL2G2":HDRAW"BM145,74D4LD2GD3U3EU2RFD3FD2":HDRAW"BM138,78D2GDGDFDUHUEUEUG4NL5G2D2G"
490 RETURN
500 HCOLOR6:FORT=0 TO 90 STEP .45:A=900-T*10
510 X=RND(640+A)-(160+A/2):Y=RND(640+A)-(160+A/2)
520 IF X<0 THEN X=0
530 IF X>319 THEN X=319
540 IF Y<0 THEN Y=0
550 IF Y>319 THEN Y=319
560 HLINE(X,T)-(Y,T),PSET:NEXTT
570 RETURN
580 DIMC(32):FORT=0 TO 31:READ C(T):NEXTT
590 DATA 63,7,9,11,28,60,32,1,17,33,37,52,5,20,16,0,63,36,45,9,25,59,56,2,16,18,52,54,34,48,7,0
600 FORT=0 TO 15:C(T)=C(T+M*16):NEXTT
610 RETURN
