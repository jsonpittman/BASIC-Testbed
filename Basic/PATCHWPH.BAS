11 SS=1:SF=1:FC=1:CD=7
16 HCOLOR3:ON BRK GOTO715
18 ON ERR GOTO7000
50 HSCREENH:HBUFF1,399:HGET(8,152)-(9,152+D),1
70 IFQ=1 AND Z<>U AND L+4>W-1THENFL=1:GOTO195
82 IFSCI=1THEN960ELSEIFSCI=2 AND KS=1THEN2020ELSEIFSCI=2THEN2030
115 IFK=32THENZ=L+S:IFL+8<W THENHLINE(L,T)-(L+7,T+D),PRESET,BF:L=L+S:GOTO65ELSEHLINE(L,T)-(L+1,T+D),PRESET,BF:L=U:IFT<P AND T<191-2*D THENT=T+1+D:GOTO65ELSEFL=0:GOTO2080
130 IFK=8THENL=2*INT(.5*L):HLINE(L,T)-(L+1,T+D),PRESET,BF:IFL>1THENL=L-2:GOTO65ELSEL=0:GOTO65
171 IFK=95THENI=2*H+2:HPUT(L,T)-(L+1,T+D),1:IFL>W*.5THENHGET(U,T)-(W-I-1,T+D),6:HPUT(U+I,T)-(W-1,T+D),6ELSEHGET(U+I,T)-(W-1,T+D),6:HPUT(U,T)-(W-1-I,T+D),6
175 IFK<>95THENHPUT(L,T)-(L+1,T+D),1:GOTO65ELSE65
185 IFQ=0 OR Z=U THENL=U:IFT<P AND T<191-2*D THENT=T+D+1:GOTO90ELSE90
190 FL=2
210 HGET(Z,T)-(L,T+D),6:HPUT(Z,T)-(L,T+D),4:L1=L-Z:L=U:Z=U:IFT<P AND T<191-2*D THENT=T+D+1ELSE2080
220 IFSCI<>2THENHPUT(L,T)-(L+L1,T+D),6:L=L+L1+L2:L=2*INT(.5*L+.5):L2=0ELSEL=U:GOSUB2400:KS=KS+1:GOTO2030
223 N=FL+1:ON N GOTO65,75,90
265 IFK$="I" OR K$="i"THEN3060
385 GOSUB545
387 HGET(L,T)-(L+1,T+D),1:GOTO65
390 POKE&HE6E4,&HE6:HSCREENH:POKE&HE6E4,&HE7:HGET(16,20)-(111,170),5:HPUT(16,20)-(111,95),4:HPUT(16,96)-(111,170),4
400 Y=10:OPEN"I",#1,"FONTMENU"
410 FORI=0TO9:GOSUB485:LINEINPUT#1,A$:Y=Y+16:HDRAW"S4BM24,"+STR$(Y)+A$:NEXT:CLOSE#1
541 CLS:LOCATE6,12:PRINT"DO YOU WANT TO CHANGE THE":LOCATE6,13:PRINT"BOTTOM MARGIN?  (Y/N) ";
542 K$=INKEY$:IFK$=""THEN542ELSEIFK$="N" OR K$="n"THENL=U:T=V:RETURNELSEIFK$="Y" OR K$="y"THEN543ELSESOUND60,5:GOTO542
543 LOCATE6,16:PRINT"DO YOU WANT IT AT THE MOST":LOCATE6,17:PRINT"RECENT CURSOR POSITION?  (Y/N) ":LOCATE6,18:PRINT"IF NOT, IT WILL BE SET TO THE":LOCATE6,19:PRINT"LOWEST POSSIBLE CURSOR POSITION.":LOCATE37,17:IFV$="B" OR V$="b"THENGOSUB980
544 K$=INKEY$:IFK$=""THEN544ELSEIFK$="N" OR K$="n"THENGOSUB980:GOTO545ELSEIFK$="Y" OR K$="y"THENP=T:L=U:T=V:RETURNELSESOUND65,0:GOTO544
545 P=V+(D+1)*(-1+INT((192-V)/(D+1))):RETURN
617 PRINT"     SHIFT ";CHR$(94)+": MOVE CHAR-LINE TOWARD":PRINT"              CURSOR HALF OF SCREEN"
715 RGB:CLS3:POKE&HFFD8,0:DRIVE0
720 END
960 POKE&H23,A1:POKE&H24,A2:IFKS<=LEN(AC$)THENK$=MID$(AC$,KS,1):KS=KS+1:GOSUB970:GOTO90ELSESCI=0:HPUT(L,T)-(L+1,T+D),1:U=UT:GOTO65
970 IFASC(K$)=94THENK$=CHR$(13):RETURNELSERETURN
980 V=192-(D+1)*INT(192/(D+1)):T=V:RETURN
2020 POKE&HFFD8,0:IFEOF(1)=-1THENCLOSE#1:POKE&HFFD9,0:SCI=0:HPUT(L,T)-(L+1,T+D),1:U=UT:GOTO65ELSEGOSUB490:LINEINPUT#1,SK$:POKE&HFFD9,0
2025 IFSK=0THENSCI=0:U=UT:GOTO2200
2030 POKE&H23,A1:POKE&H24,A2:IFKS<=LEN(SK$)THENK$=MID$(SK$,KS,1)ELSE2100
2032 IFASC(K$)=91THENK$=CHR$(13):RS=1
2035 IFL>U AND KS=1 AND K$=" "THENHPUT(L,T)-(L+1,T+D),1:L=U:IFT<P AND T<191-2*D THENT=T+1+D ELSESK=0:GOTO2025
2040 KS=KS+1:GOTO90
2050 IFH=1THENU=4*INT(.25*L):RETURNELSEU=8*INT(.125*L):RETURN
2080 IFSCI<>2THEN223ELSESK=0:GOTO2025
2100 IFSK$=""THENHPUT(L,T)-(L+1,T+D),1:L=U ELSEKS=1:IFRS=1THENRS=0:GOTO2020ELSEIFL+S+8>W THEN3100ELSEK$=" ":GOTO90
2110 IFT<P AND T<191-2*D THENT=T+1+D:GOTO90ELSESK=0:GOTO2025
2200 T=V:HSCREEN0:CLS:ATTR0,4
2210 LOCATE4,8:PRINT"Do you want to save on disk the         rest of the ASCII strings of":LOCATE13,10:PRINTFA$;":";ZA$:LOCATE4,11:PRINT"for later translation to their          font images? (Y/N)  ";
2220 K$=INKEY$:IFK$=""THEN2220
2230 IFK$="N" OR K$="n"THENCLOSE#1:GOTO320
2240 IFK$="Y" OR K$="y"THENLOCATE4,14:PRINT"The rest of the strings will be         saved in REST:";ZA$;
2300 IFFA$="REST"THENRE$="TEMP"ELSERE$="REST
2301 POKE&HFFD8,0:OPEN"O",#2,RE$+":"+ZA$
2305 GOSUB2400:IFKS>=LEN(SK$)THEN2310
2307 PRINT#2,RIGHT$(SK$,LEN(SK$)-KS)
2310 IFEOF(1)=-1THENCLOSE#1:CLOSE#2:GOTO2330
2320 GOSUB490:LINEINPUT#1,SK$:PRINT#2,SK$:GOTO2310
2330 IFRE$="TEMP"THENKILL"REST/DAT:"+ZA$:RENAME"TEMP/DAT:"+ZA$ TO"REST/DAT:"+ZA$
2340 GOTO320
2400 KS=KS-1:IFKS=0THENRETURNELSEIFMID$(SK$,KS,1)<>" "THEN2400ELSERETURN
3040 GOSUB485:SK=6:KS=1:SCI=2:CLS:LOCATE4,8:PRINT"Type filename of ASCII file you         want translated:  ";:LINEINPUTFA$:Z$=RIGHT$(FA$,2):ZA$="0":IFASC(Z$)=58THENZA$=RIGHT$(Z$,1):FA$=LEFT$(FA$,LEN(FA$)-2)
3050 POKE&HFFD8,0:OPEN"I",#1,FA$+":"+ZA$:RETURN
3060 GOSUB485:CLS:LOCATE11,10:PRINT"1: SCREEN FILE":LOCATE11,11:PRINT"2: ASCII FILE"
3070 K$=INKEY$:IFK$=""THEN3070ELSEIFK$="1"THENGOSUB30:GOTO230ELSEIFK$="2"THEN3080ELSESOUND60,5:GOTO230
3080 Q=1:UT=U:GOSUB3040:GOTO320
3100 HPUT(L,T)-(L+1,T+D),1:L=U:IFT<P AND T<191-2*D THENT=T+D+1:GOTO2020ELSESK$="":GOTO2110
3600 CLOSE#1:FORI=0TO3000:NEXT:GOTO230
7000 IFERLIN=2330THEN2340
7005 IFERLIN=170THENT1=T:FORI=1TOSF:HPUT(U,T)-(W-1,T+INT(D/SF)),4:T=T+INT(D/SF):NEXT:T=T1:L=U:GOTO65
7010 IFERLIN=2320 AND ERNO=23 THENCLOSE#1:CLOSE#2:GOTO2330
7020 IFERLIN=30 OR ERLIN=3050 THENSCI=0:SOUND60,5:LOCATE5,12:PRINT"THERE IS NO FILE BY THAT NAME":LOCATE7,13:PRINT"ON THE DISK IN DRIVE ";:IFZ$=""THENPRINT"0":GOTO3600ELSEIFASC(Z$)=58THENPRINTRIGHT$(Z$,1):GOTO3600ELSEPRINT"0":GOTO3600
7030 IFERLIN=25THENKILLF$+"/HR1":KILLF$+"/HR2":RENAME"OUT1/BIN"TOF$+"/HR1":RENAME"OUT2/BIN"TOF$+"/HR2":GOTO230
7040 GOTO715
