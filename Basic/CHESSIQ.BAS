0 'COPYRIGHT 1990 FALSOFT, INC.
1 ''''''''''''''''''''''''''''''
2 '          COCO IQ           '
3 '            BY              '
4 '        RICK COOPER         '
5 '    COPYRIGHT (C) 1989      '
6 ''''''''''''''''''''''''''''''
10 DIM CB(12,12),LO(8,8,2),SL(8,2),SX(8,2)
20 ON BRK GOTO 1480
30 ON ERR GOTO 1480
40 POKE &HFFD9,0
50 BS=&H6400
60 MD=0
70 FOR X=1 TO 12:FOR Y=1 TO 12:READ CB(X,Y):NEXTY:NEXTX
80 READ A$
90 FOR X=1 TO LEN(A$):POKE BS+X,ASC(MID$(A$,X,1))-65:NEXTX
100 FOR X=1 TO 8
110 FORY=1 TO 8
120 LO(X,Y,1)=Y*20+20
130 LO(X,Y,2)=X*20
140 NEXT Y,X
150 FOR X=1 TO 10:HBUFF X,300:NEXTX
160 FOR X=11 TO 18:HBUFF X,100:NEXTX
170 REM KNIGHT
180 PC$="R12U1H2R1U1H3E1R1F2E1U1H1U1R2F1E1U1H2L1H3L2BD3D1R1U1L1BU3L1H1L1G1D1G1D1G1D1G1D4F1G1D1R1G2D1"
190 FOR X=0 TO 4:PALETTE X,0:NEXTX
200 HCOLOR 0,1
210 HSCREEN2
220 HDRAW"BM102,98"+PC$
230 HPAINT(102,98),1,0
240 HLINE(100,100)-(120,80),PSET,B
250 HGET(100,100)-(118,80),1
260 FOR X=11 TO 18
270 HCLS
280 HPRINT (14,10),CHR$(X+54)
290 HGET(111,79)-(119,87),X
300 NEXT X
310 HCLS
320 PALETTE 0,0:PALETTE 1,63:PALETTE 2,60:PALETTE 3,0:PALETTE 4,36
330 HCOLOR 4,0:HPRINT(30,4),"T H E":HPRINT(28,6),"C H E S S":HPRINT(31,8),"I Q"
340 HCOLOR 0,0:HPRINT(32,10),"by":HPRINT(27,11),"Rick Cooper"
350 HPRINT(30,12),"C 1990"
360 HLINE(207,23)-(308,108),PSET,B
370 HCOLOR 4,0:HLINE(208,24)-(307,107),PSET,B
380 HCOLOR 0,0:HLINE(209,25)-(306,106),PSET,B
390 HPRINT(27,15),"A) CHESS IQ":HPRINT(27,16),"B) DEMO"
400 I$=INKEY$
410 IF I$<>"A" AND I$<>"B" THEN 400
420 HCOLOR 1,0:HPRINT(27,15),"A) CHESS IQ":HPRINT(27,16),"B) DEMO"
430 IF I$="B" THEN MD=2 ELSE MD=0
440 HCOLOR 0,0
450 HPRINT(30,16),"MOVES"
460 HPRINT(32,18),"0"
470 FOR X=1 TO 8
480 FOR Y=1 TO 8
490 HLINE(LO(X,Y,1),LO(X,Y,2))-(LO(X,Y,1)+20,LO(X,Y,2)+20),PSET,B
500 NEXT Y,X
510 FOR X=3 TO 10
520 IF X/2=INT(X/2) THEN C1=3 ELSE C1=1
530 FOR Y=3 TO 10
540 GOSUB 910
550 IF C1=3 THEN C1=1 ELSE C1=3
560 NEXT Y
570 NEXT X
580 MO=0
590 X=8:Y=1
600 DI=1
610 N1=8:N2=1
620 HGET(LO(N1,N2,1),LO(N1,N2,2))-(LO(N1,N2,1)+20,LO(N1,N2,2)+20),2
630 HPUT(LO(N1,N2,1),LO(N1,N2,2))-(LO(N1,N2,1)+18,LO(N1,N2,2)+20),1
640 IF N1=X AND N2=Y THEN GOSUB 1200
650 GOSUB 960:REM GET NEW SQUARES
660 IF MD>0 THEN I=PEEK(BS+MO+1):GOTO 700
670 I$=INKEY$:IF I$="" THEN 670
680 I=ASC(I$)-65
690 IF I<0 OR I=>T1 THEN 670
700 MO=MO+1
710 IF MD>0 THEN 730
720 POKE BS+MO,I
730 GOSUB 1140:REM MOVE KNIGHT
740 HPUT(LO(N1,N2,1),LO(N1,N2,2))-(LO(N1,N2,1)+20,LO(N1,N2,2)+20),2
750 N1=SX(I,1):N2=SX(I,2):REM NEW LOCATION OF KNIGHT
760 MO$=" "+STR$(MO-1):HCOLOR 1,0:HPRINT(30,18),MO$
770 MO$=" "+STR$(MO):HCOLOR 0,1:HPRINT(30,18),MO$
780 GOTO 620
790 DATA 0,0,0,0,0,0,0,0,0,0,0,0
800 DATA 0,0,0,0,0,0,0,0,0,0,0,0
810 DATA 0,0,1,1,1,1,1,1,1,1,0,0
820 DATA 0,0,1,1,1,1,1,1,1,1,0,0
830 DATA 0,0,1,1,2,1,1,2,1,1,0,0
840 DATA 0,0,1,2,1,2,2,1,2,1,0,0
850 DATA 0,0,1,1,1,1,1,1,1,1,0,0
860 DATA 0,0,1,1,2,1,1,2,1,1,0,0
870 DATA 0,0,1,2,1,2,2,1,2,1,0,0
880 DATA 0,0,1,1,1,1,1,1,1,1,0,0
890 DATA 0,0,0,0,0,0,0,0,0,0,0,0
900 DATA 0,0,0,0,0,0,0,0,0,0,0,0
910 L1=(Y-3)*20+45
920 L2=(X-3)*20+25
930 IF CB(X,Y)=2 THEN C2=4 ELSE C2=C1
940 HPAINT(L1,L2),C2,0
950 RETURN
960 REM GET NEW SQUARES
970 T1=0
980 K1=N1+2:K2=N2+2
990 IF CB(K1-2,K2-1)=1 THEN SL(T1,1)=LO(K1-4,K2-3,1):SL(T1,2)=LO(K1-4,K2-3,2):SX(T1,1)=K1-4:SX(T1,2)=K2-3:T1=T1+1
1000 IF CB(K1-2,K2+1)=1 THEN SL(T1,1)=LO(K1-4,K2-1,1):SL(T1,2)=LO(K1-4,K2-1,2):SX(T1,1)=K1-4:SX(T1,2)=K2-1:T1=T1+1
1010 IF CB(K1-1,K2+2)=1 THEN SL(T1,1)=LO(K1-3,K2,1):SL(T1,2)=LO(K1-3,K2,2):SX(T1,1)=K1-3:SX(T1,2)=K2:T1=T1+1
1020 IF CB(K1+1,K2+2)=1 THEN SL(T1,1)=LO(K1-1,K2,1):SL(T1,2)=LO(K1-1,K2,2):SX(T1,1)=K1-1:SX(T1,2)=K2:T1=T1+1
1030 IF CB(K1+2,K2+1)=1 THEN SL(T1,1)=LO(K1,K2-1,1):SL(T1,2)=LO(K1,K2-1,2):SX(T1,1)=K1:SX(T1,2)=K2-1:T1=T1+1
1040 IF CB(K1+2,K2-1)=1 THEN SL(T1,1)=LO(K1,K2-3,1):SL(T1,2)=LO(K1,K2-3,2):SX(T1,1)=K1:SX(T1,2)=K2-3:T1=T1+1
1050 IF CB(K1+1,K2-2)=1 THEN SL(T1,1)=LO(K1-1,K2-4,1):SL(T1,2)=LO(K1-1,K2-4,2):SX(T1,1)=K1-1:SX(T1,2)=K2-4:T1=T1+1
1060 IF CB(K1-1,K2-2)=1 THEN SL(T1,1)=LO(K1-3,K2-4,1):SL(T1,2)=LO(K1-3,K2-4,2):SX(T1,1)=K1-3:SX(T1,2)=K2-4:T1=T1+1
1070 IF MD>0 THEN 1130
1080 FOR J=0 TO T1-1
1090 HGET(SL(J,1),SL(J,2))-(SL(J,1)+20,SL(J,2)+20),3+J
1100 IF HPOINT(SL(J,1)+2,SL(J,2)+2)=3 THEN C3=1 ELSE C3=0
1110 HPUT(SL(J,1)+4,SL(J,2)+4)-(SL(J,1)+12,SL(J,2)+12),J+11
1120 NEXT J
1130 RETURN
1140 REM MOVE KNIGHT
1150 IF MD>0 THEN RETURN
1160 FOR J=0 TO T1-1
1170 HPUT(SL(J,1),SL(J,2))-(SL(J,1)+20,SL(J,2)+20),3+J
1180 NEXT J
1190 RETURN
1200 HPUT(LO(N1,N2,1),LO(N1,N2,2))-(LO(N1,N2,1)+20,LO(N1,N2,2)+20),2
1210 HPAINT(LO(N1,N2,1)+2,LO(N1,N2,2)+2),2,0
1220 HGET(LO(N1,N2,1),LO(N1,N2,2))-(LO(N1,N2,1)+20,LO(N1,N2,2)+20),2
1230 HPUT(LO(N1,N2,1),LO(N1,N2,2))-(LO(N1,N2,1)+18,LO(N1,N2,2)+20),1
1240 IF DI=1 THEN Y=Y+1 ELSE Y=Y-1
1250 IF DI=1 AND Y=9 THEN DI=2:Y=8:X=X-1
1260 IF DI=2 AND Y=0 THEN DI=1:Y=1:X=X-1
1270 IF HPOINT(LO(X,Y,1)+4,LO(X,Y,2)+4)=4 THEN 1240
1280 IF X=0 THEN 1310
1290 SOUND RND(50)+30,1
1300 RETURN
1310 IF MD=2 THEN 190
1320 FOR X=1 TO 4
1330 PALETTE X,RND(64)-1
1340 NEXT X
1350 MD=0
1360 IF INKEY$="" THEN 1310
1370 HCOLOR 1,0:HPRINT(30,16),"MOVES"
1380 HPRINT(30,18),MO$
1390 HCOLOR 0,1:HPRINT(26,16),"A) RECORD DEMO"
1400 HPRINT(26,17),"B) MAIN MENU"
1410 HPRINT(26,18),"C) QUIT"
1420 I$=INKEY$:IF I$="" THEN 1420
1430 IF I$="A" THEN MD=1:GOTO 1470
1440 IF I$="B" THEN MD=0:GOTO 1470
1450 IF I$="C" THEN 1480
1460 GOTO 1420
1470 GOTO 200
1480 POKE &HFFD8,0
1490 RGB
1500 END
1510 DATA BFCAAECDBCEAEDBCCAAFBCCAABDADCACFFCADACFAECBEFCCAEBCDCBCBCBCFBAFDADGDABBFDBAACGADEACCEBBAABCDAAACGABACAACAACBDABGCCGCCBABEAADBCBCBAABBAEABBACCDCBACBACCDBBD
