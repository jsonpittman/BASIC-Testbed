10 ' 8503.10/23:00 MOD:8607.26
20 CLEAR200:PCLEAR8
30 'POKE65495,0'SPEED POKE
40 GOTO 1760
50 '
60 'JOYSTICK ROUTINES
70 '
80 PLAY"L150ABCDEFG":A$=INKEY$
90 FR=0:P=PEEK(65280):AR=JOYSTK(0):BR=JOYSTK(1):AL=JOYSTK(2):BL=JOYSTK(3)
100 IF KJ<>1 THEN IF INKEY$<>"" THEN KJ=1:GOTO 80
110 IF KJ<>2 THEN IF P=126 OR P=254 THEN KJ=2:GOTO 80 
120 IF KJ<>3 THEN IF P=125 OR P=253 THEN KJ=3:PLAY"L150ABCDEFG":GOTO80
130 ON KJ GOTO 190,260,310
140 '
150 'DEVICE 1 = KEYBOARD
160 'DEVICE 2 = RIGHT JOYSTICK
170 'DEVICE 3 = LEFT  JOYSTICK
180 '
190 'KEYBOARD DETECTION
200 IF PEEK(345)=247 THEN POKE 345,255:FR=1:RETURN
210 IF PEEK(343)=247 THEN POKE 343,255:A=A-1
220 IF PEEK(341)=247 THEN POKE 341,255:B=B-1
230 IF PEEK(342)=247 THEN POKE 342,255:B=B+1
240 IF PEEK(344)=247 THEN POKE344,255:A=A+1
250 RETURN
260 'RIGHT JOYSTICK DETECTION
270 A=AR:B=BR
280 IF (P AND 3)<3 THEN FR=1
290 RETURN 
300 '
310 'LEFT  JOYSTICK DETECTION 
320 '
330 A=AL:B=BL
340 IF (P AND 3)<3 THEN FR=1
350 RETURN  
360 '
370 PCOPY5TO1:PCOPY6TO2:PCOPY7TO3:PCOPY8TO4:RETURN
380 FORU=1TO4:PCOPY U TO U+4:NEXT:RETURN
390 PUT(210,79)-(253,119),K,PSET:RETURN
400 '
410 'DRAW & GET PENCIL
420 '
430 PMODE4,1:PCLS1:COLOR0
440 DRAW"BM0,22;"+P$
450 GET(0,0)-(23,22),P
460 PCLS:COLOR1:DRAW"BM0,22;U5E17R2F3D2G17L5":PAINT(2,17),1,1
470 GET(0,0)-(23,22),M
480 GOSUB370:X=99:PRINT@96+32+32,"";:GOSUB2270
490 PRINT:PRINT"    PRESS ANY KEY TO BEGIN    ":EXEC44539
500 PMODE4:SCREEN1,1
510 IF FR=1 THEN 520 ELSE 550
520 IF X>194 THEN 1340
530 PLAY"T200AB":IF L=0 AND TP=0 THEN L1=X:L2=Y:L=1:GOTO550 ELSE IF TP=1 THENGOSUB370:PMODE3,1: PAINT(X,Y),CO,1:PMODE4,1:GOSUB380:GOTO560
540 IF L=1 THEN PMODE3,5:COLOR1:LINE(L1,L2)-(X,Y),PSET:PMODE4:L=0
550 GOSUB90:SCREEN1,1:IF A=C AND B=D THEN 510
560 C=A:D=B
570 X=C*4:IF X>232 THEN X=232
580 IF X<0 THEN X=0
590 Y=D*3:IF Y<24 THEN Y=24
600 IF L=1 AND TP=0 THEN PCOPY5TO1:PCOPY6TO2:PCOPY7TO3:PCOPY8TO4:PMODE3,1:COLOR1:LINE(L1,L2)-(X,Y),PSET:PMODE4,1:GOTO620
610 PMODE4,5:GET(OX,OY-22)-(OX+23,OY),S,G:PMODE4,1:PUT(OX,OY-22)-(OX+23,OY),S,PSET
620 PUT(X,Y-22)-(X+23,Y),M,OR
630 DRAW"BM=X;,=Y;C0"+P$
640 OX=X:OY=Y
650 GOTO550
660 '
670 'DRAW SCREEN
680 '
690 PMODE4,5:PCLS1
700 BD=1:S=18:MX=8:MY=1:DRAW"S15":M$="COCO  NECT  A  DOT":GOSUB1250
710 DRAW"BM81,8;S4U6BM166,8;"+D$+"BM198,8;"+D$
720 PMODE3,5:COLOR1
730 LINE(0,20)-(200,185),PSET,B
740 LINE(6,186)-(200,191),PSET,BF
750 LINE(200,28)-(205,191),PSET,BF
760 LINE(210,20)-(250,68),PSET,B
770 MX=214:MY=113:M$="COL":GOSUB1190
780 MX=236:MY=113:M$="OR":GOSUB1190
790 MX=214:MY=97:M$="LINES":GOSUB1190
800 MX=218:MY=81:M$="DOTS":GOSUB1190
810 LINE(251,28)-(256,73),PSET,BF
820 LINE(216,69)-(256,73),PSET,BF
830 MX=230:MY=42:M$="BY":GOSUB1230
840 MX=216:MY=50:M$="ERIC":GOSUB1230
850 MX=214:MY=59:M$="WH":GOSUB1230
860 MX=228:MY=59:M$="I":GOSUB1230
870 MX=234:MY=59:M$="TE":GOSUB1230
880 BD=0:PMODE3,5:COLOR1:LINE(210,128)-(253,135),PSET,BF
890 COLOR2:LINE(210,144)-(253,151),PSET,BF
900 COLOR3:LINE(210,160)-(253,167),PSET,BF
910 COLOR0:LINE(200,15)-(208,18),PSET,BF:COLOR1:LINE(210,176)-(253,183),PSET,B
920 LINE(210,79)-(253,87),PSET,B
930 LINE(210,95)-(253,103),PSET,B
940 LINE(210,111)-(253,119),PSET,B
950 GET(210,79)-(253,119),K,G
960 PUT(212,96)-(251,102),L,NOT
970 GOSUB1000:GOTO430
980 RETURN
990 '
1000 ' READ DATA & PLOT POINTS
1010 '
1020 DN=1
1030 PMODE4,5
1040 COLOR0
1050 READ MX,MY,M$:IF M$="OUT"THEN RESTORE:GOTO1050 ELSE GOSUB1190
1060 READ PX,PY,OF$:IF OF$="END" THEN 1150
1070 IF OF$="R "THEN OF=8
1080 IF OF$="L "THEN OF=-6:IF DN>9 THEN OF=-12
1090 DRAW"BM=PX;,=PY;"+D$:PX=PX+OF:PY=PY-1:DRAW"BM=PX;,=PY;A1BD3"
1100 IF DN<10 THEN DRAW N$(DN):GOTO1130
1110 DN$=STR$(DN)
1120 DRAW N$(VAL(MID$(DN$,2,1)))+"BL6BU6"+N$(VAL(RIGHT$(DN$,1)))
1130 DN=DN+1
1140 GOTO1060
1150 'FINISHED READING DATA
1160 DRAW"A0"
1170 RETURN
1180 '
1190 'HI-RES PRINTING SHOP
1200 'NEEDS M$="MESSAGE"
1210 '      MX=X POS
1220 '      MY=Y POS
1230 DRAW"S4":S=8
1240 PMODE4,5:COLOR0
1250 FORM=1 TO LEN(M$)
1260 N=ASC(MID$(M$,M,1))-64
1270 IF N=-32 THEN MX=MX+6:NEXTM:RETURN
1280 IF N=0 THEN LINE(MX,MY+4)-(MX+6,MY+4),PSET:MX=MX+8:NEXT:RETURN
1290 IF N=-18 THEN PSET(MX+2,MY+4,0):NEXTM:RETURN
1300 DRAW"BM=MX;,=MY;A1C0"+A$(N)
1310 BX=MX+1:DRAW"BM=BX;,=MY;A1C0"+A$(N)
1320 MX=MX+S:NEXTM:RETURN
1330 '
1340 ' MENU
1350 '
1360 IF X<210 THEN550
1370 IF Y>79 AND Y<88 THEN 1420
1380 IF Y>96 AND Y<104 THEN 1490
1390 IF Y>111 AND Y<120 THEN 1530
1400 GOTO550
1410 '
1420 'DOTS
1430 '
1440 PLAY"T200CD":PMODE4,5:SCREEN1,1:GOSUB390
1450 PUT(212,80)-(251,86),L,NOT
1460 COLOR1:LINE(2,21)-(198,184),PSET,BF
1470 L=0:GOSUB1000:GOSUB390:PUT(212,96)-(251,102),L,NOT:GOSUB370:PMODE4:SCREEN1,1:TP=0:GOTO570
1480 '
1490 'LINES
1500 '
1510 PLAY"T200CD":L=0:TP=0:PMODE4,5:GOSUB390:PUT(212,96)-(251,102),L,NOT:GOSUB370:GOTO570
1520 '
1530 'COLOR
1540 '
1550 PLAY"T200CD":OO=B:PMODE4,5:GOSUB390:PUT(212,112)-(251,118),L,NOT:GOSUB370
1560 L=0:TP=1:PMODE3
1570 GOSUB90
1580 IF K>1 THEN B=INT(B/16) ELSE B=B AND 3
1590 COLOR1:LINE(209,B*16+127)-(255,B*16+136),PSET,B:COLOR0:LINE(209,B*16+127)-(255,B*16+136),PSET,B:OB=B
1600 IF FR=0 THEN 1570
1610 CO=PPOINT(235,B*16+129)
1620 B=OO:GOTO570
1630 '
1640 ' DOT DATA
1650 '
1660 DATA 4,175,WHEN YOU WISH APON A @@@@.,100,36,R ,140,148,R ,30,72,L ,160,72,R ,52,148,L ,100,36,L ,0,0,END
1670 DATA 16,175,YOU ARE MY SWEET @@@@@.,108,167,R ,168,99,R ,172,67,R ,140,48,R ,104,67,L ,76,48,L ,44,67,L ,48,99,L ,108,167,L,  0,0,END
1680 DATA 12,175,LIKE A BOLT OF @@@@@@@@.,176,36,L ,48,95,L ,100,103,R ,28,169,L ,164,106,R ,120,87,L ,176,36,R ,0,0,END
1690 DATA 44,175,LITE AS A @@@@.,56,160,L ,172,104,R ,80,36,L ,56,160,R ,160,32,R ,80,36,R ,172,104,L ,0,0,END
1700 DATA 12,175,SHINES LIKE A @@@@@@@.,24,68,R ,99,160,L ,64,68,L ,99,36,L ,136,68,R ,99,160,R ,184,68,L ,24,68,L ,80,36,L ,120,36,R ,184,68,R ,0,0,END
1710 DATA 22,175,YOUR MY @@@ @@ @@@.,124,132,L ,148,72,L ,164,82,R ,152,108,R ,132,118,L ,156,56,R ,36,56,L ,68,132,R ,184,132,R ,136,148,L ,56,148,R ,16,132,R ,68,132,L ,0,0,END
1720 DATA 22,175,YOU @@@@@ UP MY LIFE.,72,32,R ,128,32,R ,156,104,R ,88,104,L ,72,148,L ,84,160,R ,76,168,L ,124,168,R ,116,160,L ,128,148,R ,112,104,R ,44,104,L ,72,32,L ,0,0,END
1730 DATA 12,176,AS COLORFUL AS A @@@@@@.,96,60,L ,72,84,R ,60,68,L ,128,50,R ,128,68,R ,56,56,L ,68,36,L ,120,84,R ,100,92,L ,92,30,L ,116,32,R ,72,104,R ,44,92,L ,36,76,L ,60,84,L ,88,140,L ,20,140,L ,52,168,L ,148,168,R ,180,140,R ,88,140,R ,0,0,END
1740 DATA 0,0, OUT
1750 '
1760 DIM P(13),M(13),S(13),A$(26),N$(25),K(80),L(10)
1770 A=54:B=15:OY=45:OX=216:KJ=1:X=OX:Y=OY
1780 '
1790 ' CHARACTER DATA
1800 '
1810 D$="EFGHRBU3" 'DOT
1820 P$="U5E15F5G3H3G11BF2E11H4E5R2F3D2G17L5E"
1830 N$(0)="BRNR2HU2ER2FD2GBR3"
1840 N$(1)="BEHR4BD2BR2"
1850 N$(2)="U3EFD3R2NU4BR2"   
1860 N$(3)="U3EFND2EFD3BR2"
1870 N$(4)="BU3NR4F3NU4BR3" 
1880 N$(5)="NU4R2U3EFD3BR2"
1890 N$(6)="BU3BNED2FR2HU2EFD2GBR3" 
1900 N$(7)="U4RF3BD2BR2"
1910 N$(8)="BRHU2EFND2EFD2GHGBR5"
1920 N$(9)="BRHU2ENR2FD2GBR2BEU2HB"
1930 A$(1)="BRNR3HU2ERND4R2BD4BR2"
1940 A$(2)="NR4U3EFND3EFD3BR2"
1950 A$(3)="BRNR2HU2EBR2FD2GBR3"
1960 A$(4)="NR4U3ER2FD3BR2"
1970 A$(5)="NU3R2NU2R2NU4BR2" 
1980 A$(6)="NU4R2NU2R2BR2" 
1990 A$(7)="NR4U4BR2NDRFD3BR2"
2000 A$(8)="R2NR2U4NL2R2BD4BR2"
2010 A$(9)="BU2R4BD2BR2"  
2020 A$(10)="BU4R3FD2GLBR4"
2030 A$(11)="NR4BU4F2ND2E2BD4BR2"   
2040 A$(12)="R4NU4BR2"  
2050 A$(13)="NR4E2H2R4BD4BR2"
2060 A$(14)="NR4E4NL4BD4BR2" 
2070 A$(15)="BRNR2HU2ER2FD2GBR3"
2080 A$(16)="NR4U3EFD3BR4"
2090 A$(17)="BRNR2HU2ER2FDNNLNRDGBR3"  
2100 A$(18)="NR4U3EFND3BDE2BD4BR2"  
2110 A$(19)="BU3NBED2FEU2EFD3BGBR3" 
2120 A$(20)="U2NU2R4BD2BR2" 
2130 A$(21)="NR3BU4R3FD2GBR3"   
2140 A$(22)="NR2BU4R2F2G2BR4"
2150 A$(23)="NR4BU4R4G2F2BR2"
2160 A$(24)="E4BL4F4BR2"
2170 A$(25)="BU4F2NG2R2BD2BR2"
2180 A$(26)="U4F4NU4BR2" 
2190 '
2200 FORX=1TO16:PRINTSTRING$(32,32);:NEXTX
2210 PRINT"********************************";
2220 PRINT"* BASIC COCO-NECT A DOT  V:1.0 *";
2230 PRINT"* COPYRIGHT 1986 BY ERIC WHITE *";
2240 PRINT"*      ALL RIGHTS RESERVED     *";
2250 PRINT"********************************";
2260 PRINT:PRINT"      AFTER PROGRAM STARTS     "
2270 PRINT:PRINT"      PRESS THE SPACEBAR      "
2280 PRINT"    TO SELECT THE KEYBOARD    "
2290 PRINT"              OR              "
2300 PRINT"     PRESS THE FIRE BUTTON    "
2310 PRINT"    TO SELECT THE JOYSTICK    "
2320 PRINT:PRINT"       FOR INPUT DEVICE       "
2330 IF X<>99 THEN GOTO 690 ELSE RETURN
