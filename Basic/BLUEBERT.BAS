10 CLS
20 SCREEN 0,0
30 PRINT @167,"BATTLING BLUE BERT"
40 PRINT@264,"'BARRIER BUSTER'"
50 PMODE 1,1
60 PCLS
70 DIM I$(4)
80 DIM XN(4):DIM YN(4)
90 DIM XO(4):DIM YO(4)
100 DIM VC(0,28):DIM V(0,28)
110 DIM O(0,28):DIM B(0,28)
120 DIM VB(0,28)
130 I$(1)="U24":I$(2)="D24"
140 I$(3)="L24":I$(4)="R24"
150 GET (2,2)-(22,22),VC,G
160 COLOR 2,1
170 DRAW "BM34,2R16D20L16U20D6BR4R2BR4R2BD2BL4D4BD4BR4L8"
180 GET (32,2)-(52,22),O,G
190 DRAW "BM64,2R16D20L16U20D6BR4R1BR7R1BD4BL4L1BL4BD2D2R8U2"
200 GET (62,2)-(82,22),V,G
210 COLOR 3,1
220 DRAW "BM94,2R16L2D20L12U20D10R12"
230 GET (92,2)-(112,22),B,G
240 DRAW "BM124,2R16D20L16U20BD4BR4R8BD2BL1L1BL3L1BD4BR2R0BD4BL4R8"
250 GET (122,2)-(142,22),VB,G
260 PCLS
270 COLOR 4,1
280 DRAW "BM20,12R216D168L216U168"
290 PAINT (0,0),3,4
300 FOR V=1 TO 4
310 XN(V)=24*RND(8)+32
320 YN(V)=24*RND(6)+24
330 XO(V)=24*RND(8)+32
340 YO(V)=24*RND(6)+24
350 PUT (XO(V)-10,YO(V)-10)-(XO(V)+10,YO(V)+10),O,PSET
360 PUT (XN(V)-10,YN(V)-10)-(XN(V)+10,YN(V)+10),B,PSET
370 NEXT V
380 FOR V=1 TO 8
390 FOR Z=1 TO 6
400 PSET(20+24*V,12+24*Z,4)
410 NEXT Z:NEXT V
420 XM=24*RND(8)+32
430 YM=24*RND(6)+24
440 CX=XM:CY=YM
450 CLS
460 SCREEN 1,0
470 FOR Z=1 TO 4
480 IF (XM=XN(Z) AND YM=YN(Z)) THEN GOSUB 850
490 IF (XM=XO(Z) AND YM=YO(Z)) THEN GOSUB 940
500 NEXT Z
510 KA=XO(1)+XO(2)+XO(3)+XO(4)
520 DRAW "BM"+STR$(RND(8)*24+20)+","+STR$(RND(6)*24+12)+I$(RND(4))
530 J1=JOYSTK(0):J2=JOYSTK(1)
540 IX=0
550 IF J1<2 THEN IX=-12
560 IF J1>61 THEN IX=12
570 YR=(YM)/24
580 YT=YR-INT(YR)
590 IF BF=0 THEN GOSUB 680 ELSE GOSUB 700
600 IY=0
610 IF J2<2 THEN IY=-12
620 IF J2>61 THEN IY=12
630 XR=(XM-8)/24
640 XT=XR-INT(XR)
650 IF BF=0 THEN GOSUB 730 ELSE GOSUB 780
660 IF XM>230 OR XM<26 OR YM>174 OR YM<18 THEN GOTO 970
670 GOTO 470
680 IF PPOINT(XM+IX,YM)<>4 AND YT=0 THEN XM=XM+IX/2
690 RETURN
700 IF YT=0 THEN XM=XM+IX/2
710 IF KA<>0 THEN GOSUB 880
720 RETURN
730 IF PPOINT(XM,YM+IY)<>4 AND XT=0 THEN YM=YM+IY/2
740 PUT (CX-10,CY-10)-(CX+10,CY+10),VC,PSET
750 PUT (XM-10,YM-10)-(XM+10,YM+10),V,PSET
760 CX=XM:CY=YM
770 RETURN
780 IF XT=0 THEN YM=YM+IY/2
790 IF KA<>0 THEN GOSUB 910
800 PUT (CX-10,CY-10)-(CX+10,CY+10),VC,PSET
810 PUT (XM-10,YM-10)-(XM+10,YM+10),VB,PSET
820 CX=XM:CY=YM
830 BF=BF-1
840 RETURN
850 XN(Z)=0
860 BF=20
870 RETURN
880 IF XM>224 THEN XM=224
890 IF XM<32 THEN XM=32
900 RETURN
910 IF YM>168 THEN YM=168
920 IF YM<24 THEN YM=24
930 RETURN
940 XO(Z)=0
950 PSET(10,Z*30,2)
960 RETURN
970 PCLS
980 PRINT @225,"BERT BASHES THE BARRIERS AGAIN"
990 FOR I=1 TO 1400:NEXT I
1000 CLS
1010 STOP
