1 POKE &HFFD9,0 'SPEED UP CPU TO 1.78MHZ
2 REM PRESS ANY KEY TO UPDATE
3 REM  MENORAH FOR NEXT DAY
4 REM <(<(<(<(<(!)>)>)>)>)>
5 REM # RENARD  DELLAFAVE #
6 REM #   COPYRIGHT (C)   #
7 REM #       1987        #
8 REM #   VERSION #:2.4   #
9 REM <(<(<(<(<(!)>)>)>)>)>
100 CLS:INPUT"ARE YOU USING A RGB MONITOR";MN$:IF LEFT$(MN$,1)="Y" THEN MS=-1
110 MO=MS+1
120 REM NORMALIZE ON <BREAK>
130 ON BRK GOTO 150
140 GOTO 170
150 IF MS=0 THEN PALETTE CMP ELSE PALETTE RGB
160 CLS:PRINT"****PROGRAM EXIT****":POKE 65496,0:END
170 HSCREEN 2
180 HBUFF1,153 'BUFFER FOR FLAME
190 REM SET UP PALETTES
200 DIM B(1),S(1) 'FLAME ANIMATION COLORS FOR EACH MONITOR
210 B(0)=32:B(1)=5:S(0)=52:S(1)=39
220 DATA 0,12,28,35,42,44,0,63,5,43,39,5,39,0,0,0
230 FOR CA=0 TO 15:READ CS:PALETTE CA,CS:NEXT CA
240 IF MS=-1 THEN PALETTE 3,54:PALETTE 4,42:PALETTE 5,27:PALETTE 11,32:PALETTE 12,53
250 REM DRAW AND GET FLAME IMAGE
260 DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
270 DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
280 DATA 0,0,0,0,0,0,0,0,6,6,0,0,0,0,0,0
290 DATA 0,0,0,0,0,0,0,6,6,6,6,0,0,0,0,0
300 DATA 0,0,0,0,0,0,6,6,3,6,6,0,0,0,0,0
310 DATA 0,0,0,0,6,6,3,3,3,5,5,0,0,0,0,0
320 DATA 0,0,0,6,6,6,6,3,7,5,6,6,0,0,0,0
330 DATA 0,0,0,6,6,6,3,7,7,5,6,6,0,0,0,0
340 DATA 0,0,0,6,6,6,3,7,7,7,6,6,0,0,0,0
350 DATA 0,0,6,6,6,7,7,7,7,7,6,6,0,0,0,0
360 DATA 0,0,6,6,6,7,7,7,7,7,6,6,0,0,0,0
370 DATA 0,0,6,6,6,7,7,7,7,7,7,6,0,0,0,0
380 DATA 0,0,0,6,6,7,7,4,7,7,7,6,0,0,0,0
390 DATA 0,0,0,6,7,7,7,4,4,7,6,6,0,0,0,0
400 DATA 0,0,0,6,7,7,7,4,4,7,6,0,0,0,0,0
410 DATA 0,0,0,6,6,7,7,4,4,7,6,0,0,0,0,0
420 DATA 0,0,0,0,6,6,7,4,7,6,0,0,0,0,0,0
430 REM SCAN FLAME IMAGE FROM DATA
440 FOR Y=0 TO 32 STEP 2:FOR X=0 TO 30 STEP 2
450 READ V:IF V=0 THEN HRESET(X,Y):GOTO 480
460 C=V+5 'COMPUTE CORRECT COLOR
470 HSET(X/2,Y/2,C)
480 NEXT X,Y
490 REM STORE FLAME IN HBUFFER #1
500 HGET (0,0)-(16,16),1
510 HCLS0
520 REM DRAW AND GET DRADLES
530 DATA 0,0,0,0,0,0,0,0,0,0,1,1,0,0,0
540 DATA 0,0,0,0,0,0,0,0,0,0,1,1,0,0,0
550 DATA 0,0,0,0,0,0,0,0,0,1,1,1,0,0,0
560 DATA 0,0,0,0,0,0,0,0,0,1,1,0,0,0,0
570 DATA 0,0,0,2,2,0,0,0,1,1,1,0,0,0,0
580 DATA 0,0,0,2,2,2,2,0,1,1,0,0,0,0,0
590 DATA 0,0,2,2,2,2,2,2,1,2,2,2,0,0,0
600 DATA 0,0,2,2,2,2,2,2,2,2,2,2,2,0,0
610 DATA 0,0,2,2,2,2,2,2,2,2,2,2,2,0,0
620 DATA 0,0,2,2,2,2,2,2,2,2,2,2,2,0,0
630 DATA 0,2,2,2,2,2,2,2,2,2,2,2,2,0,0
640 DATA 0,2,2,2,2,2,2,2,2,2,2,2,0,0,0
650 DATA 0,2,2,2,2,2,2,2,2,2,2,2,0,0,0
660 DATA 2,2,2,2,2,2,2,2,2,2,2,2,0,0,0
670 DATA 2,2,2,2,2,2,2,2,2,2,2,2,0,0,0
680 DATA 2,2,2,2,2,2,2,2,2,2,2,0,0,0,0
690 DATA 0,1,2,2,2,1,2,2,2,2,2,0,0,0,0
700 DATA 0,0,1,1,1,1,1,2,2,2,0,0,0,0,0
710 DATA 0,0,1,1,1,1,1,1,1,1,0,0,0,0,0
720 DATA 0,0,0,1,1,1,1,1,1,0,0,0,0,0,0
730 DATA 0,0,0,1,1,1,1,0,0,0,0,0,0,0,0
740 DATA 0,0,0,0,1,0,0,0,0,0,0,0,0,0,0
750 REM SCAN DATA FOR DRADLE TO SCREEN
760 FOR Y=0 TO 21:FOR X=3 TO 17
770 READ V
780 IF V=0 THEN GOTO 800 ELSE IF V=1 THEN C=4 ELSE IF V=2 THEN C=5
790 HSET(X,Y,C):HSET(X+40,Y,C):HSET(X+80,Y,C):HSET(X+120,Y,C)
800 NEXT X,Y
810 REM SET UP "CORNERS" WITH HLINES
820 HCOLOR 4
830 REM FRAME 0 CORNER LINES
840 HLINE(6,5)-(4,15),PSET
850 HLINE(7,5)-(4,15),PSET
860 HLINE(15,7)-(11,17),PSET
870 HLINE(15,8)-(12,17),PSET
880 REM FRAME 1 CORNER LINES
890 HLINE(8+40,5)-(5+40,15),PSET
900 HLINE(8+40,6)-(5+40,16),PSET
910 HLINE(9+40,6)-(6+40,16),PSET
920 HLINE(10+40,6)-(7+40,16),PSET
930 REM FRAME 2 CORNER LINES
940 HLINE(10+80,7)-(8+80,16),PSET
950 HLINE(11+80,7)-(9+80,16),PSET
960 HLINE(12+80,6)-(9+80,16),PSET
970 REM FRAME 3 CORNER LINES
980 HLINE(13+120,6)-(10+120,16),PSET
990 HLINE(14+120,6)-(10+120,17),PSET
1000 HLINE(14+120,7)-(11+120,17),PSET
1010 REM *"GET" DRADLE FRAMES INTO
1020 REM  APPROPRIATE HBUFFER AREAS
1030 HBUFF 2,242
1040 HGET (0,0)-(20,21),2    'FRAME 0
1050 HBUFF 3,242
1060 HGET (40,0)-(60,21),3   'FRAME 1
1070 HBUFF 4,242
1080 HGET (80,0)-(100,21),4  'FRAME 2
1090 HBUFF 5,242
1100 HGET (120,0)-(140,21),5 'FRAME 3
1120 HCLS
1130 REM DRAW MENORAH
1140 HDRAW "C1;BM55,36;M62,36;M62,48;M69,48;M69,96;M76,96;M76,102;M90,102;M90,108;M132,108;M132,96;M90,96;M90,90;M83,90;M83,36;M90,36;M90,78;M97,78;M97,84;M132,84;M132,78;M111,78;M111,72;M104,72;M104,36;M111,36;M111,60;M118,60;M118,66"
1150 HDRAW "M132,66;M132,54;M125,54;M125,36;M132,36;M132,48;M139,48;M139,54;M146,54;M146,30;M160,30;M160,54;M167,54;M167,48;M174,48;M174,36;M181,36;M181,54;M174,54;M174,66;M188,66;M188,60;M195,60;M195,36;M202,36;M202,72;M195,72;M195,78"
1160 HDRAW "M174,78;M174,84;M209,84;M209,78;M216,78;M216,36;M223,36;M223,90;M216,90;M216,96;M174,96;M174,108;M216,108;M216,102;M230,102;M230,96;M237,96;M237,48;M244,48;M244,36;M251,36;M251,60;M244,60;M244,108;M237,108;M237,114;M223,114"
1170 HDRAW "M223,120;M174,120;M174,138;M167,138;M167,144;M160,144;M160,156;M167,156;M167,168;M174,168;M174,174;M188,174;M188,180;M209,180;M209,186;M216,186;M216,192;M90,192;M90,186;M97,186;M97,180;M118,180;M118,174;M132,174;M132,168;M139,168"
1180 HDRAW "M139,156;M146,156;M146,144;M139,144;M139,138;M132,138;M132,120;M83,120;M83,114;M69,114;M69,108;M62,108;M62,60;M55,60;M55,36"
1190 HPAINT (153,31),1,1
1195 REM "HAPPY HANUKKAH" MESSAGE
1200 HCOLOR 7,0:HPRINT(13,0),"HAPPY HANUKKAH"
1210 REM DRAW STAR OF DAVID
1220 HDRAW "C6;BM62,132;F42;L84;E42;BM62,186;E42;L84;F42"
1230 REM CENTER
1240 HPAINT(62,162),3,6
1250 REM CORNERS
1260 HPAINT(62,138),2,6
1270 HPAINT(85,150),2,6
1280 HPAINT(85,168),2,6
1290 HPAINT(35,168),2,6
1300 HPAINT(35,147),2,6
1310 HPAINT(62,180),2,6
1320 REM PLACE SHAMAS AND 1ST FLAME
1330 HPUT(147,14)-(163,30),1,PSET
1340 HPUT(240,20)-(256,36),1,PSET
1350 REM MAIN LOOP OF PROGRAM
1370 X1=287:X2=307:DX=-2:DM=6:DB=1
1380 IF F=0 THEN F=1:PALETTE 10,B(MO):PALETTE 8,S(MO) ELSE IF F=1 THEN F=0:PALETTE 10,S(MO):PALETTE 8,B(MO) 'FLICKER THE FLAMES
1390 PALETTE 7,RND(63) 'FLASH TEXT
1400 IF INKEY$<>"" THEN GOSUB 1560 'ADD DAY IF KEY PRESSED
1410 CC=CC+1 'UPDATE CYCLE COUNT FOR DRADLE
1420 DB=DB+1:IF DB=6 THEN DB=2 'CALCULATE NEXT DRADLE FRAME BUFFER #
1430 X2=X2+DX:X1=X1+DX 'UPDATE DRADLE POSITION
1440 REM CHECK FOR DRADLE OUT-OF-BOUNDS
1450 IF X2>307 THEN X2=307:X1=287
1460 IF X1<219 THEN X1=219:X2=239
1470 REM DRAW DRADLE IN NEW POSITION, OLD IMAGE OVERWRITTEN
1480 HPUT (X1,170)-(X2,191),DB,PSET
1490 IF CC<=DM THEN 1380 'IF STILL MOVING DRADLE, JUMP BACK TO BEGINNING NOW
1500 DX=3-RND(RND(3)):IF RND(2)=1 THEN DX=-DX 'NEW DRADLE SPEED
1510 IF DX=0 THEN IF RND(3)<>2 GOTO 1500 'KILL ZEROS, ADD DELAY
1520 DM=RND(8)+2 'HOW FOR TO GO AT THAT SPEED
1530 CC=0 'CLEAR CYCLE COUNT
1540 GOTO 1380
1550 REM ADD A FLAME
1560 HD=HD+1
1570 ON HD GOSUB 1600,1610,1620,1630,1640,1650,1660
1580 RETURN
1590 REM HPUT STATEMENTS FOR EACH FLAME
1600 HPUT(212,20)-(228,36),1,PSET:RETURN 'DAY 2
1610 HPUT(193,20)-(209,36),1,PSET:RETURN 'DAY 3
1620 HPUT(170,20)-(186,36),1,PSET:RETURN 'DAY 4
1630 HPUT(122,20)-(138,36),1,PSET:RETURN 'DAY 5
1640 HPUT(101,20)-(117,36),1,PSET:RETURN 'DAY 6
1650 HPUT(80,20)-(96,36),1,PSET:RETURN 'DAY 7
1660 HPUT(52,20)-(68,36),1,PSET:RETURN 'DAY 8
