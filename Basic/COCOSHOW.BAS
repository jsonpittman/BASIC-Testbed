10 WIDTH 40:CLS5:PRINT"       CoCo Show Display Program":PRINT"       For CoCo Max III Pictures":PRINT"         (c) 1987 by Colorware":PRINT"             By Dave Stampe":PRINT:PRINT
20 CLEAR1000,&H6800:DIM D$(15),N$(15),Y(15),T(15),FX$(15),FY(15),FT(15):F=1
30 SC=3:N=0:Y$(0)="NO ":Y$(1)="YES"
40 PRINT:PRINT:PRINT"    R)un  : Run the current sequence":PRINT"    N)ew  : Create a new sequence":PRINT   "    E)dit : Edit current sequence":PRINT   "    Q)uit : Quit CoCo Show Program":PRINT:PRINT"    Selection :";
50 A$=INKEY$:IFA$=""THEN 50
60 IF A$="Q" OR A$="q" THEN PRINT"Quit":PRINT:PRINT"End of Program":END
70 IF A$="R" OR A$="r" THEN PRINT "Run":PRINT:PRINT"    One moment, please...": GOTO530
80 IF A$="E" OR A$="e"  THEN PRINT "Edit":PRINT:PRINT"    One moment, please...":GOTO 100
90 IF A$="N" OR A$="n" THEN PRINT "New":PRINT:PRINT"    One moment, please...":GOTO 120
100 ON ERR GOTO 120
110 OPEN"I",#1,"SAVESEQ":FORA=0TO15:INPUT#1,FX$(A),FY(A),FT(A):NEXT:CLOSE:POKE&HFF40,0
120 SP=0:DSKI$0,17,SC,A$,B$
130 IF SP<128 THEN X$=LEFT$(RIGHT$(A$,128-SP),11) ELSE X$=LEFT$(RIGHT$(B$,256-SP),11)
140 IF ASC(X$)=255 THEN 180
150 IF ASC(X$)=0 OR RIGHT$(X$,3)<>"CM3" THEN 170
160 D$(N)=LEFT$(X$,8):N=N+1:IF N=16 THEN 180
170 SP=SP+32:IF SP<256 THEN130 ELSE SC=SC+1:GOTO 120
180 POKE&HFF40,0:D=0:FORB=0 TO N:FORA=0TO15:IF D$(A)="" OR FX$(B)="" THEN 200
190 IFD$(A)=FX$(B) THEN Y(D)=FY(B):T(D)=FT(B):N$(D)=FX$(B):D$(A)="":D=D+1
200 NEXT:NEXT:FORA=0 TO 15:IF D$(A)<>"" THEN N$(D)=D$(A):D=D+1
210 NEXT
220 WIDTH 40:PRINT"   NUMBER  FILE NAME   SHOW?   TIME":PRINT
230 FORA=1 TO 16:LOCATE 4,A+1 :PRINT A;CHR$(32*(ABS(A<10)));"     ";N$(A-1)
240 LOCATE 24,A+1 :PRINTY$(Y(A-1))"    "T(A-1)
250 NEXT
260 GOSUB 1170:PRINT"   Enter selection to edit, or":INPUT"   press 'S' to save sequence:";R$:IF R$="" THEN 260
270 IF R$="S" OR R$="s" THEN 480
280 ON ERR GOTO 260
290 R=VAL(R$):IF R>N THEN 260 ELSE R=R-1
300 GOSUB 1170:PRINT"   Include in Show? (Y/N):";
310 A$=INKEY$:IFA$=""THEN 310
320 IF A$="N" OR A$="n" THEN Y(R)=0:GOTO350
330 IF A$="Y" OR A$="y" THEN Y(R)=1:GOTO 350
340 GOTO 300
350 LOCATE 24,R+2:PRINTY$(Y(R));:IF T(R)<5 THEN T(R)=5
360 GOSUB 1170:PRINT"    How many seconds should CoCo Show":PRINT"    display this picture before":INPUT"    continuing ";T$:IF T$="" THEN 360
370 ON ERR GOTO 360
380 Q=VAL(T$):IF Q>5 THEN T(R)=Q ELSE T(R)=5
390 LOCATE 31,R+2:PRINTT(R);
400 GOSUB 1170:LOCATE 4,21:PRINT"(Press ENTER to leave unchanged)":LOCATE 4,19:INPUT"New position in sequence:";NW$:IF NW$="" THEN 470
410 ON ERR GOTO 400:NW=VAL(NW$)-1:OL=R:IF NW=OL THEN 470
420 SN$=N$(OL):SY=Y(OL):ST=T(OL):IF OL=15 THEN 440
430 FOR A=OL TO 14:N$(A)=N$(A+1):Y(A)=Y(A+1):T(A)=T(A+1):NEXT
440 IF NW=15 THEN 460
450 FOR A=15 TO NW+1 STEP -1:N$(A)=N$(A-1):Y(A)=Y(A-1):T(A)=T(A-1):NEXT
460 N$(NW)=SN$:Y(NW)=SY:T(NW)=ST:GOTO 220
470 GOSUB 1170:GOTO 260
480 'SAVE CONFIG FILE
490 OPEN"O",#1,"SAVESEQ"
500 FORA=0TO15:WRITE#1,N$(A),Y(A),T(A):NEXT:CLOSE
510 POKE&HFF40,0:CLS:GOTO40
520 WIDTH32:CMP:POKE&HFF40,0:PRINT"I/O ERROR":END
530 WIDTH40:CLS5:PRINT"       *** COCOMAX III DEMO ***"
540 PRINT:PRINT:PRINT"       WHILE THE DEMO IS RUNNING,":PRINT:PRINT"             YOU MAY PRESS:":PRINT::PRINT"  -SPACE BAR- TO SKIP TO NEXT SCREEN":PRINT:PRINT"  -BREAK KEY- TO JUMP TO BEGINNING":PRINT:PRINT"  -P- TO PAUSE, ANY KEY TO RESUME"
550 PRINT:PRINT"  -A- TO TOGGLE THE ANIMATION ON AND OFF"
560 PRINT:PRINT:PRINT"  TO EXIT THE DEMO: USE THE RESET BUTTON":PRINT:PRINT"        PRESS ANY KEY TO START":PRINT:PRINT:PRINTTAB(19)
570 I$=INKEY$:IF I$=""THEN570ELSECLS:PRINTTAB(13);"PLEASE WAIT...":PRINTTAB(18)
580 POKE&HFFD9,0:FORA=&H6800 TO &H6AAF:READB:POKEA,B:NEXT:POKE&HFFD8,0
590 ON ERR GOTO 700:OPEN"I",#1,"SAVESEQ
600 FORA=0TO15:INPUT#1,FX$(A),FY(A),FT(A):NEXT:CLOSE:POKE&HFF40,0:HSCREEN2:POKE &HFF9A,63
610 ON BRK GOTO 610:CLOSE:FORA=0 TO 15:IF FY(A)=0 OR FX$(A)="" THEN A=0
620 OPEN"I",#1,FX$(A)+"/CM3":EXEC&H6800:CLOSE:POKE&HFF40,0
630 T=FT(A):IF T<5 THEN 670
640 FOR Z=0 TO (T-5)*130:I$=INKEY$:IFI$=" " THEN Z=1E8:NEXT
650 IF I$="P"ORI$="p" THEN GOSUB680:NEXT
660 IF I$="A"OR I$="a" THEN GOSUB690:NEXT
670 NEXT:NEXT:GOTO 610
680 I$=INKEY$:IF I$="" THEN680 ELSE Z=1E8:RETURN
690 I$="":F=-F:IF F<0 THEN POKE&HFF03,&H34 ELSE POKE&HFF03,&H35:RETURN
700 CLS:PRINT:PRINT"DISK ERROR"
710 DATA 183,255,217,189,104,79,189,104,209,127,255,64,189,106,14,183
720 DATA 255,216,126,104,51,142,255,172,141,10,134,56,142,255,168,32
730 DATA 3,142,255,164,127,255,145,167,128,76,167,128,76,167,128,76
740 DATA 167,132,57,142,105,197,191,1,13,134,60,189,104,33,190,1
750 DATA 107,48,8,191,105,90,134,52,126,104,21,134,48,32,236,198
760 DATA 1,215,111,141,222,142,255,255,191,105,75,189,105,58,183,104
770 DATA 134,206,104,181,198,16,141,21,206,104,197,198,12,141,14,125
780 DATA 104,134,46,8,198,243,189,105,58,90,38,250,57,189,105,58
790 DATA 167,192,90,38,248,57,0,182,106,159,198,30,129,192,35,2
800 DATA 198,62,247,255,153,142,104,181,206,255,176,127,106,172,127,106
810 DATA 173,198,16,141,8,142,104,197,206,106,162,198,12,166,128,167
820 DATA 192,90,38,249,57,57,142,232,7,32,3,142,232,6,189,232
830 DATA 164,58,134,255,167,132,57,13,0,38,71,10,22,13,4,38
840 DATA 47,127,105,147,141,100,183,105,146,183,106,159,142,128,0,134
850 DATA 128,183,105,148,183,105,149,189,105,125,189,105,116,206,105,151
860 DATA 16,142,105,173,198,160,125,105,150,43,47,104,196,52,1,116
870 DATA 105,148,36,5,118,105,148,51,65,53,1,37,5,182,105,147
880 DATA 32,26,104,164,52,1,116,105,149,36,5,118,105,149,49,33
890 DATA 53,1,37,6,166,137,255,96,32,2,141,14,167,128,183,105
900 DATA 147,90,38,194,122,105,146,38,166,57,52,20,190,105,75,140
910 DATA 124,176,36,9,166,128,191,105,75,53,148,255,255,142,106,176
920 DATA 191,105,75,127,255,145,183,255,216,189,161,118,183,255,217,167
930 DATA 128,13,112,38,5,140,124,176,37,236,134,1,183,255,145,183
940 DATA 255,217,32,200,206,105,173,246,105,150,42,14,57,141,187,206
950 DATA 105,151,183,105,150,42,1,57,198,20,141,174,167,192,90,38
960 DATA 249,57,0,0,0,0,0,252,232,41,253,232,24,52,6,32
970 DATA 15,125,232,0,38,56,252,232,41,52,6,189,232,187,167,1
980 DATA 48,1,79,140,232,23,37,246,53,6,32,37,127,232,5,254
990 DATA 0,136,255,0,0,182,255,2,125,106,172,39,29,122,106,160
1000 DATA 38,24,182,106,162,183,106,160,182,255,190,190,255,188,191,255
1010 DATA 189,246,255,187,247,255,188,183,255,187,125,106,173,39,30,122
1020 DATA 106,161,38,25,182,106,163,183,106,161,190,106,174,166,128,140
1030 DATA 106,172,37,3,142,106,164,183,255,186,191,106,174,59,189,104
1040 DATA 135,189,104,75,26,80,134,96,183,106,156,134,2,183,106,157
1050 DATA 182,106,157,198,214,61,183,106,158,64,139,160,68,52,2,134
1060 DATA 192,176,106,157,68,198,160,61,235,224,137,0,142,128,0,48
1070 DATA 139,182,106,158,141,73,74,39,4,48,1,32,247,182,106,157
1080 DATA 141,61,74,39,6,48,137,0,160,32,245,182,106,158,141,47
1090 DATA 74,39,4,48,31,32,247,182,106,157,141,35,74,39,6,48
1100 DATA 137,255,96,32,245,124,106,157,124,106,157,122,106,156,38,160
1110 DATA 142,248,0,141,10,48,1,140,253,0,37,247,28,175,57,198
1120 DATA 1,247,255,145,230,132,127,255,145,231,132,57,0,0,0,0
1130 DATA 1,7,7,7,15,95,129,19,38,2,134,93,0,0,106,164
1140 REM *** CENTER PRINT
1150 LOCATE (20-LEN(O$)/2),VT:PRINT O$
1160 RETURN
1170 LOCATE 0,18:PRINT:PRINT:PRINT:PRINT:LOCATE 0,19:RETURN
