1 PCLEAR1:CLEAR6000:CMP:WIDTH40:CLS3:GOSUB410:W=640:H=3:F1$="ABCDEFGH":PF=VARPTR(F1$):PF=256*PEEK(PF+2)+PEEK(PF+3):GOTO15
2 P$=RIGHT$(STR$(I),1)+"/HR1":Q$=RIGHT$(STR$(I),1)+"/HR2":RETURN
3 RENAMEF$+"L"+P$TO"L1/BIN":RENAMEF$+"L"+Q$TO"L2/BIN":RETURN
4 POKE&HFFA2,&H70:LOADM"L1":POKE&HFFA2,&H71:LOADM"L2":RETURN
5 RENAME"L1/BIN"TOF$+"L"+P$:RENAME"L2/BIN"TOF$+"L"+Q$:RETURN
6 FORI=0TO29:POKEI+&H1321,PEEK(K+I):NEXT:RETURN
7 K=&H135F:GOSUB6:POKE&H127F,1:POKE&H1283,&H50:POKE&H12DE,0:POKE&H1263,&H10:POKE&H1280,&H21:GOSUB404:FORI=1TO4:GOSUB2:GOSUB3:GOSUB4:POKE&HFFA2,&H7A:GOSUB5:EXEC&H12CB:NEXT:RETURN
8 K=&H1341:GOSUB6:POKE&H127F,&H15:POKE&H1283,&H3C:POKE&H12DE,0:POKE&H1263,0:POKE&H1280,&H1E:GOSUB404:FORI=1TO4:GOSUB2:GOSUB3:RENAMEF$+"R"+P$TO"R1/BIN":RENAMEF$+"R"+Q$TO"R2/BIN"
9 GOSUB4:POKE&HFFA2,&H72:LOADM"R1":POKE&HFFA2,&H73:LOADM"R2":POKE&HFFA2,&H7A:GOSUB5:RENAME"R1/BIN"TOF$+"R"+P$:RENAME"R2/BIN"TOF$+"R"+Q$:EXEC&H12CB:NEXT:RETURN
10 K=&H1341:GOSUB6:POKE&H127F,&H29:POKE&H1283,&H28:POKE&H12DE,&H12:POKE&H1280,&H1E:GOSUB404:FORI=1TO4:P$=RIGHT$(STR$(I),1)+"/HR":RENAMEF$+"L"+P$TO"L/BIN":RENAMEF$+"M"+P$TO"M/BIN":RENAMEF$+"R"+P$TO"R/BIN"
11 POKE&HFFA2,&H70:LOADM"L":POKE&HFFA2,&H71:LOADM"M":POKE&HFFA2,&H72:LOADM"R":POKE&HFFA2,&H7A:RENAME"L/BIN"TOF$+"L"+P$:RENAME"M/BIN"TOF$+"M"+P$:RENAME"R/BIN"TOF$+"R"+P$:EXEC&H12CB:NEXT
12 POKE&HFFA2,&H72:LOADM"DMENU/HR1:0":POKE&HFFA2,&H7A:RETURN
13 '
14 '
15 HCOLOR3,0:ON BRK GOTO332
16 LOADM"MLR":POKE&HFFA2,&H70:LOADM"DMENU/HR1":POKE&HFFA2,&H71:LOADM"DMENU/HR2":POKE&HFFA2,&H77:LOADM"FMENU/HR1":POKE&HFFA2,&H7A:EXEC&HF00
17 POKE150,18:POKE55455,65:POKE55456,66:POKE55232,0:POKE55318,20
18 ON ERR GOTO22
20 K$=K$+"C":A1=PEEK(VARPTR(K$)+2):A2=PEEK(VARPTR(K$)+3):IFA2<2THENA2=254:A1=A1-1:GOTO36ELSEA2=A2-2:GOTO36
22 POKE&HFFA2,&H7A:GOTO492
24 '
26 GOSUB384:POKE&HFFA2,&H70:SAVEM"OUT1",&H4000,&H5FFF,&HAC73:POKE&HFFA2,&H71:SAVEM"OUT2",&H4000,&H5BFF,&HAC73:POKE&HFFA2,&H7A:RENAME"OUT1/BIN"TOF$+"/HR1":RENAME"OUT2/BIN"TOF$+"/HR2":DRIVE0:RETURN
28 EXEC&HF3C:GOSUB384:POKE&HFFA2,&H70:SAVEM"OUT",&H4000,&H5DFF,&HAC73:POKE&HFFA2,&H7A:RENAME"OUT/BIN"TOF$+"/HR":DRIVE0:RETURN
30 GOSUB404:RENAMEF$+"/HR1"TO"IN1/BIN":RENAMEF$+"/HR2"TO"IN2/BIN":POKE&HFFA2,&H70:LOADM"IN1":POKE&HFFA2,&H71:LOADM"IN2":POKE&HFFA2,&H7A
32 RENAME"IN1/BIN"TOF$+"/HR1":RENAME"IN2/BIN"TOF$+"/HR2":DRIVE0:RETURN
34 GOSUB404:RENAMEF$+"/HR"TO"IN/BIN":POKE&HFFA2,&H70:LOADM"IN":POKE&HFFA2,&H7A:RENAME"IN/BIN"TOF$+"/HR":DRIVE0:EXEC&HF71:RETURN
36 L2=1:P=176:DIMF$(84),M(84):POKE&HFFD9,0
38 C1=63:PALETTE0,63:PALETTE1,63:PALETTE2,63:PALETTE3,0
40 EXEC&H1000:POKE&HE6E4,&HE6:HSCREENH:POKE&HE6E4,&HE7:HBUFF1,399:HGET(8,152)-(9,152+D),1
42 HBUFF4,3200:HBUFF5,2104:HGET(0,0)-(639,19),4:HBUFF6,1520
44 EXEC&HF00:HGET(48,16)-(63,31),5:EXEC&HF00:DX=16:DY=16
46 PALETTE1,0
48 T=V:L=U:K$="F":GOTO138
50 IFZ=U AND L+4>W-1THENL=U:IFT<P THENT=T+D+1
52 IFZ<>U AND L+4>W-1THENFL=1:GOTO112
54 HGET(L,T)-(L+1,T+D),1:HLINE(L,T)-(L+1,T+D),PSET,BF
56 POKE&H23,A1:POKE&H24,A2
58 IFSCI=1THEN420ELSEIFSCI=2 AND KS=1THEN428ELSEIFSCI=2THEN432
60 K$=INKEY$:IFK$=""THEN60
62 K=ASC(K$):IFK>64 AND K<91THENN=K-64:B=N:HLINE(L,T)-(L+1,T+D),PRESET,BF:GOTO106
64 IFK>96 AND K<123THENN=K-96:B=N+26:GOTO106
66 IFK>47 AND K<58THENN=K-47:B=N+52:GOTO106
68 IFK>32 AND K<48THENN=K-32:B=N+62:GOTO106
70 IFK>57 AND K<65THENN=K-57:B=N+77:GOTO106
72 IFK=32THENZ=L+S:IFL+8<W THENHLINE(L,T)-(L+7,T+D),PRESET,BF:L=L+S:GOTO50ELSEHLINE(L,T)-(L+1,T+D),PRESET,BF:L=U:IFT<P AND T<191-2*D THENT=T+1+D:GOTO50ELSEFL=0:GOTO444
74 IFK=13THENHPUT(L,T)-(L+1,T+D),1:L=U
76 IFK=13 AND T<P THENT=T+1+D:GOTO54ELSEIFK=13THEN54
78 IFK=8THENL=2*INT(.5*L):HLINE(L,T)-(L+1,T+D),PRESET,BF:IFL>1THENL=L-2:GOTO50ELSEL=0:GOTO50
80 IFK=93THENIFH=1THENSOUND60,9:GOTO50ELSEZ=U:HLINE(L,T)-(L+1,T+D),PRESET,BF:IFL+DX-1<W THENL=8*INT(.125*L):HPUT(L,T)-(L+DX-1,T+DY-1),5:L=L+DX:GOTO50ELSESOUND60,9:GOTO50
82 IFK=94THENHPUT(L,T)-(L+1,T+D),1:IFT>D THENT=T-1-D:GOTO50
84 IFK=10THENHPUT(L,T)-(L+1,T+D),1:IFT+D<191THENT=T+D+1:GOTO50
86 IFK=91THENZ=U:HPUT(L,T)-(L+1,T+D),1:HDRAW"BM"+STR$(L)+","+STR$(T+1+INT(.75*D))+"R4":L=L+4:GOTO50:IFL>W-5THENL=L-4:GOTO50
88 IFK=9 AND L+4<W THENHPUT(L,T)-(L+1,T+D),1:L=L+4:GOTO50
90 IFK=92THENEXEC&H1000:T=V:L=U:GOTO50
92 IFK=4THENHPUT(L,T)-(L+1,T+D),1:GOTO128
94 IFK=12THENHPUT(L,T)-(L+1,T+D),1:IFT3=0THENT3=1:L=T1:GOTO50ELSEIFT3=1THENT3=0:L=T2:GOTO50
96 IFK=189THENGOSUB374
98 IFK=21THENHPUT(U,T)-(W-1,T+.5*D),4:HPUT(U,T+.5*D)-(W-1,T+D),4:L=U:GOTO50
100 IFK=95THENI=2*H+2:HPUT(L,T)-(L+1,T+D),1:IFL>W*.5THENHGET(U,T)-(W-I-1,T+.5*D+.5),6:HPUT(U+I,T)-(W-1,T+.5*D+.5),6:HGET(U,T+.5*D+1.5)-(W-I-1,T+D),6:HPUT(U+I,T+.5*D+1.5)-(W-1,T+D),6:GOTO104
102 IFK=95THENHGET(U+I,T)-(W-1,T+.5*D+.5),6:HPUT(U,T)-(W-1-I,T+.5*D+.5),6:HGET(U+I,T+.5*D+1.5)-(W-1,T+D),6:HPUT(U,T+.5*D+1.5)-(W-1-I,T+D),6
104 IFK<>95THENHPUT(L,T)-(L+1,T+D),1:GOTO50ELSE50
106 HLINE(L,T)-(L+1,T+D),PRESET,BF:IFL+M(B)<W THENGOSUB126:L=L+2*INT(.5+M(B)*.5)+2:IFL>W-1THENL2=L-W+1:L=W-1:GOTO50ELSE50
108 IFZ=U THENL=U:IFT<P AND T<191-2*D THENT=T+D+1:GOTO62ELSE62
110 FL=2
112 IFH=3THENZ1=8*INT(.125*Z)
114 IFH=1THENZ1=4*INT(.25*Z)
116 Z=Z1
118 HGET(Z,T)-(L,T+D),6:HPUT(Z,T)-(L,T+D),4:L1=L-Z:L=U:Z=U:IFT<P AND T<191-2*D THENT=T+D+1ELSE444
120 IFL+L1<0THENL1=L1+2:GOTO120
122 IFSCI<>2THENHPUT(L,T)-(L+L1,T+D),6:L=L+L1+L2:L=2*INT(.5*L+.5):L2=0ELSEL=U:GOSUB476:KS=KS+1:GOTO432
124 N=FL+1:ON N GOTO50,54,62
126 HDRAW"BM"+STR$(L)+","+STR$(T)+F$(B):RETURN
128 HSCREEN0:CLS:ATTR0,4:LOCATE10,4:PRINT"A: ART-DESIGNS":LOCATE10,5:PRINT"B: BACK TO SCREEN":LOCATE10,6:PRINT"C: CONVERT WPF":LOCATE10,7:PRINT"D: DIR":LOCATE10,8:PRINT"F: FONT SELECT
130 LOCATE10,9:PRINT"H: HOUSEKEEPING":LOCATE10,10:PRINT"I: INPUT":LOCATE10,11:PRINT"K: KEYS LISTED":LOCATE10,12:PRINT"M: MARGIN SET":LOCATE10,13:PRINT"O: OUTPUT":LOCATE10,14:PRINT"P: PRESENT STATUS
132 LOCATE10,15:PRINT"R: RESOLUTION CHANGE":LOCATE10,16:PRINT"S: SCREEN DUMP":LOCATE10,17:PRINT"T: TAB SET":LOCATE10,18:PRINT"X: EXIT UltraLace":LOCATE14,18:POKE&H23,A1:POKE&H24,A2:POKE&HFFD8,0
134 K$=INKEY$:IFK$=""THEN134
136 IFK$="D" OR K$="d"THENGOSUB326:GOTO128
138 IFK$="F" OR K$="f"THENOD=D:L1=L:EXEC&HF8E:POKE&HE6E4,&HE6:HSCREEN3:POKE&HE6E4,&HE7:GOSUB170:L=L1:EXEC&HF8E:GOTO128
140 IFK$="B" OR K$="b"THEN168
142 IFK$="H" OR K$="h"THENGOSUB324:GOTO396
144 IFK$="I" OR K$="i"THEN482
146 IFK$="K" OR K$="k"THENGOSUB308:GOTO128
148 IFK$="O" OR K$="o"THENIFCC=0 AND HK=0THEN348ELSEIFCC=0THEN346ELSEF$=LEFT$(F1$,HL):DRIVEVAL(RIGHT$(F$,1)):F$=LEFT$(F$,HL-2):IFHK=3THENCLS:GOSUB28:GOTO128ELSECLS:GOSUB26:GOTO128
150 IFK$="M" OR K$="m"THENGOSUB218:GOTO128
152 IFK$="P" OR K$="p"GOSUB400:GOTO128
154 IFK$="R" OR K$="r"THENIFH=1THENH=3:U=2*U:W=2*W:T1=2*T1:T2=2*T2:GOTO128ELSEH=1:U=.5*U:W=.5*W:T1=.5*T1:T2=.5*T2:GOTO128
156 IFK$="T" OR K$="t"THENGOSUB298:GOTO128
158 IFK$="C" OR K$="c"THEN252
160 IFK$="S" OR K$="s"THENGOSUB324:GOSUB322:IFK$="1"THENGOSUB7:GOTO128ELSEIFK$="2"THENGOSUB8:GOTO128ELSEIFK$="3"THENPOKE&H13FF,0:GOSUB10:GOTO128ELSESOUND60,9:GOTO128
162 IFK$="A" OR K$="a"THEN330
164 IFK$="X" ORK$="x"THENGOSUB394:IFK$="Y" OR K$="y"THENCLS3:POKE&HFFD8,0:DRIVE0:ENDELSE128
166 SOUND60,5:SOUND60,5:GOTO128
168 POKE&HE6E4,&HE6:HSCREENH:POKE&HE6E4,&HE7:POKE&HFFD9,0:GOTO202
170 GOTO204
172 POKE&H23,A1:POKE&H24,A2:GOSUB322
174 IFK$<"0" OR K$>"9" THENSOUND60,10:RETURNELSEK$="1"+K$
176 GOSUB212
178 GOSUB216
180 OPEN"I",#1,"FONT"+K$
182 FORI=1TO84:LINEINPUT#1,F$(I):NEXT
184 FORI=1TO84:INPUT#1,M(I):NEXT
186 INPUT#1,D,S:CLOSE#1:IFD>7 AND D<11THEND=11ELSEIFD>11 AND D<15THEND=15ELSEIFD>15THEND=23
188 K=T
190 T=T+INT(.5*(OD-D)):V=T:IFT<0THENT=0:V=0ELSEIFT>P THENT=P-1
192 IFV>=0THENV=V-D-1:GOTO192ELSEV=V+D+1
194 IFK=0THENGOSUB424:GOSUB250
196 RETURN
198 HPUT(16,20)-(111,170),5
200 GOSUB250
202 HGET(L,T)-(L+1,T+D),1:GOTO50
204 POKE&H23,A1:POKE&H24,A2:GOSUB322
206 K=ASC(K$):IFK>96 AND K<122THENK=K-32:K$=CHR$(K)
208 IFK>64 AND K<90THEN176ELSESOUND60,9:GOTO204
210 POKE&H23,A1:POKE&H24,A2:RETURN
212 POKE&H23,A1-1:POKE&H24,A2:RETURN
214 POKE&H23,A1-2:POKE&H24,A2:RETURN
216 POKE&H23,A1-4:POKE&H24,A2:RETURN
218 GOSUB212:CLS:LOCATE6,8:PRINT"ENTER TOP MARGIN (0 - 10): ";:LINEINPUTV$:LOCATE6,10:PRINT"ENTER LEFT MARGIN ";:IFV$=""THENV$=STR$(V)
220 LOCATE24,10:IFH=1THENPRINT"(0 - 200):     ":LOCATE35,10ELSEPRINT"(0 - 400):     ":LOCATE35,10
222 GOSUB214:LINEINPUTU$:GOSUB306:V=VAL(V$):U=VAL(U$):IFH=1THENU=4*INT(.25*U):Z=U ELSEU=8*INT(.125*U):Z=U
224 IFV<0THENV=0
226 IFV>10THENV=10
228 IF U>W-50THENSOUND60,5:LOCATE10,15:PRINT"LEFT MARGIN TOO BIG":LOCATE8,16:PRINT"RELATIVE TO RIGHT MARGIN!":LOCATE14,17:PRINT"TRY AGAIN.":GOTO220
230 IFU<0THENU=0
232 IFH=1 AND U>200THENU=200
234 IFH=3 AND U>400THENU=400
236 GOSUB212:LOCATE4,12:PRINT"ENTER RIGHT MARGIN ( 0 -";320+(H-1)*160;"): ";:LINEINPUTW$:IFW$=""THENW$=STR$(W)
238 W=VAL(W$):IFW<U+50THENSOUND60,5:LOCATE9,15:PRINT"RIGHT MARGIN TOO SMALL":LOCATE8,16:PRINT"RELATIVE TO LEFT MARGIN. ":LOCATE14,17:PRINT"TRY AGAIN.":GOTO236
240 GOSUB290
242 CLS:LOCATE6,12:PRINT"DO YOU WANT TO CHANGE THE":LOCATE6,13:PRINT"BOTTOM MARGIN?  (Y/N) ";
244 GOSUB322:IFK$="N" OR K$="n" OR ASC(K$)=13THENL=U:T=V:RETURNELSEIFK$="Y" OR K$="y"THEN246ELSESOUND60,5:GOTO244
246 LOCATE6,16:PRINT"DO YOU WANT IT AT THE MOST":LOCATE6,17:PRINT"RECENT CURSOR POSITION?  (Y/N) ":LOCATE6,18:PRINT"IF NOT, IT WILL BE SET TO THE":LOCATE6,19:PRINT"LOWEST POSSIBLE CURSOR POSITION.":LOCATE37,17
248 GOSUB322:IFK$="N" OR K$="n"THENGOSUB424:GOTO250ELSEIFK$="Y" OR K$="y"THENP=T:L=U:T=V:RETURNELSESOUND65,0:GOTO248
250 P=V+(D+1)*(-1+INT((192-V)/(D+1))):RETURN
252 GOSUB212:CLS:LOCATE5,8:PRINT"FILENAME INCLUDING EXTENSION:":LOCATE13,9:LINEINPUTF$:Z$=RIGHT$(F$,2):IFASC(Z$)=58THENDRIVEVAL(RIGHT$(Z$,1)):F$=LEFT$(F$,LEN(F$)-2)ELSEDRIVE0
254 N=INSTR(F$,"/"):IFN=0THEN252ELSEG$=LEFT$(F$,N)+"DAT"
256 J=0:IFRIGHT$(F$,3)="DAT"THENRENAMEF$TOLEFT$(F$,N)+"TXT":F$=LEFT$(F$,N)+"TXT"
258 OPEN"D",#1,F$:FIELD#1,128 AS A$,128 AS B$
260 CLOSE#2:OPEN"O",#2,G$
262 IFDN=1THEN288ELSEGOSUB210:J=J+1:GET#1,J:C$=A$
264 B=INSTR(B$,"]"):IFINSTR(A$,"]")>0 OR B>0THENDN=1:IFB>0THENB$=LEFT$(B$,B-1)ELSEC$=LEFT$(C$,INSTR(C$,"]")-1):B$=""
266 N=INSTR(C$,CHR$(13)):IFN>0THENGOSUB286:C$=RIGHT$(C$,LEN(C$)-N):IFC$=""THENC$=B$:GOTO270ELSE266
268 GOSUB276:C$=C$+B$
270 N=INSTR(C$,CHR$(13)):IFN>0THENGOSUB286:C$=RIGHT$(C$,LEN(C$)-N):IFC$=""THEN262ELSE270
272 GOSUB276:IFDN=1THEN288ELSEGOSUB210:J=J+1:GET#1,J:C$=C$+A$
274 GOTO264
276 I=1
278 IFLEN(C$)=I OR C$=STRING$(LEN(C$),32)THENK=0:GOTO284
280 K=INSTR(LEN(C$)+1-I,C$," "):IFK=0THENI=I+1:GOTO278
282 PRINT#2,LEFT$(C$,K-1)
284 C$=RIGHT$(C$,LEN(C$)-K):RETURN
286 IFLEFT$(C$,N)=CHR$(13)THENPRINT#2," [":RETURNELSEPRINT#2,LEFT$(C$,N-1):RETURN
288 CLOSE#1:PRINT#2,C$:CLOSE#2:DRIVE0:DN=0:GOTO128
290 IFH=1 AND W>320THENW=320
292 IFW>640THENW=640
294 IFH=1THENW=4*INT(.25*W)ELSEW=8*INT(.125*W)
296 RETURN
298 GOSUB212:CLS:LOCATE6,8:PRINT"ENTER 1ST TAB VALUE: ";:LINEINPUTT$:GOSUB304:T1=2*INT(VAL(T$)*.5):IFH=1 AND T1>320THENT1=320ELSEIFT1>640THENT1=640
300 GOSUB212:LOCATE6,12:PRINT"ENTER 2ND TAB VALUE: ";:LINEINPUTT$:GOSUB304:T2=2*INT(VAL(T$)*.5):IFH1 AND T2>320THENT2=320ELSEIFT2>640THENT2=640
302 RETURN
304 IFT$="c" OR T$="C" THENT$=STR$(L):RETURNELSERETURN
306 IFU$=""THENU$=STR$(U):RETURNELSERETURN
308 CLS:LOCATE2,2:PRINT"F2:          CALL COMMAND MENU":LOCATE2,3:PRINT"RIGHT ARROW: MOVE CURSOR RIGHT":PRINT"  LEFT ARROW:  BACKSPACE":PRINT"  UP ARROW:    MOVE CURSOR UP 1 LINE":PRINT"  DOWN ARROW:  MOVE CURSOR DOWN 1 LINE
310 LOCATE2,7:PRINT"ENTER:       CARRIAGE RETURN &":LOCATE15,8:PRINT"MOVE CURSOR DOWN 1 LINE":PRINT"  CLEAR:       TAB":LOCATE7,11:ATTR0,4,U:PRINT"KEYS WITH SHIFT HELD DOWN";:ATTR0,4
312 LOCATE2,13:PRINT"RIGHT ARROW: DRAW CLIP ART":PRINT"  LEFT ARROW:  CLEAR LINE":PRINT"  UP ARROW:    MOVE CHAR-LINE TOWARD":LOCATE15,16:PRINT"CURSOR HALF OF SCREEN":PRINT"  DOWN ARROW:  UNDERLINE":PRINT"  CLEAR:       CLEAR SCREEN
314 PRINT"  0:           UPPER/LOWER CASE":LOCATE4,22:ATTR0,4,U:PRINT"PRESS SPACE FOR REST OF KEY LIST";:ATTR0,4:LOCATE4,22:E$="        STOPPED BY ANY KEY OR MARGIN":GOSUB322
316 CLS:LOCATE6,5:ATTR0,4,U:PRINT"KEYS PRESSED AFTER CTRL KEY";:ATTR0,4:LOCATE2,7:PRINT"RIGHT ARROW: MOVE CURSOR RIGHT UNTIL"+E$:PRINT"  LEFT ARROW:  MOVE CURSOR LEFT UNTIL "+E$
318 LOCATE2,11:PRINT"UP ARROW:    MOVE CURSOR UP UNTIL   "+E$:PRINT"  DOWN ARROW:  MOVE CURSOR DOWN UNTIL "+E$
320 LOCATE5,22:PRINT"PRESS ";:ATTR0,4,U:PRINT"SPACE";:ATTR0,4:PRINT" TO RETURN TO MENU";:LOCATE12,22
322 K$=INKEY$:IFK$=""THEN322ELSERETURN
324 CLS:LOCATE8,10:PRINT"1: 1COLUMN/4SCREEN":LOCATE8,11:PRINT"2: 2COLUMN/8SCREEN":LOCATE8,12:PRINT"3: 3COLUMN/12SCREEN":RETURN
326 GOSUB212:CLS:LOCATE12,8:PRINT"DRIVE NUMBER: "
328 GOSUB322:K=VAL(K$):IFK>3THENSOUND60,9:GOTO328ELSEDIRK:PRINT"  FREE GRANULES:";FREE(K):PRINT"     PRESS SPACE TO CONTINUE":GOSUB322:RETURN
330 CLS:LOCATE10,8:PRINT"1: NORMAL":LOCATE10,9:PRINT"2: DOUBLE WIDTH":LOCATE10,10:PRINT"3: DOUBLE WIDTH-LENGTH":LOCATE10,11:MI$=": MIRROR IMAGE OF ":PRINT"4";MI$;"1":LOCATE10,12:PRINT"5";MI$;"2":LOCATE10,13:PRINT"6";MI$;"3":GOTO354
332 GOSUB394:IFK$="Y" OR K$="y"THEN334ELSE128
334 CLS3:POKE&HFFD8,0:DRIVE0
336 IFERNO>-1 AND PEEK(&H13FF)<>9THENPOKE&HFFA1,121:POKE&HFFA2,122ELSEEND
338 IFERNO<25THENAD=&HABAF+ERNO*2ELSEIFERNO>26THENAD=&HC290+2*(ERNO-27)ELSEAD=&H890D
340 WIDTH40:LOCATE8,10:PRINT" ";:PRINTCHR$(PEEK(AD))CHR$(PEEK(AD+1));" ERROR IN LINE";ERLIN
342 LOCATE12,14:PRINT"CONTINUE? (Y,N)":GOSUB322:IFK$="Y" OR K$="y"THENWIDTH40:CLS5:PALETTE0,63:PALETTE1,0:GOTO128
344 END
346 GOSUB404:IFHK=3THENGOSUB28:GOTO128ELSEGOSUB26:GOTO128
348 CLS:LOCATE8,10:PRINT"1: SAVE FULL SCREEN":LOCATE8,12:PRINT"2: SAVE HALF SCREEN"
350 GOSUB322:IFK$="1"THENGOSUB404:GOSUB26:GOTO128ELSEIFK$="2"THENGOSUB404:GOSUB28:GOTO128ELSESOUND60,9:GOTO128
352 GOSUB322:GOTO128
354 GOSUB322:K=VAL(K$):IFK<1 OR K>6THENSOUND60,9:GOTO354ELSEIFK>3THENPOKE&H102A,1:K=K-3ELSEPOKE&H102A,0
356 DK=K:POKE&H1027,K:CLS:EXEC&HF00:POKE&HE6E4,&HE6:HSCREEN3:POKE&HE6E4,&HE7
358 GOSUB322:K=ASC(K$):IFK<48 OR K>51THENSOUND60,9:GOTO358ELSEK=K-48:DX=(K+1)*16:POKE&H1028,2*K+3:IFK>0THEN368
360 GOSUB322:K=ASC(K$):IFK>96 AND K<123THENK=K-97ELSEIFK>64 AND K<77THENK=K-39ELSESOUND60,9:GOTO360
362 POKE&H1029,K:EXEC&H1033:IFDX>48THENDX=48
364 DY=DX:IFDK>1THENDX=2*DX:IFDK=3THENDY=DX
366 IFPEEK(&H102A)=0THENHGET(544,96)-(543+DX,95+DY),5:HSCREEN0:EXEC&HF00:GOTO128ELSEHGET(640-DX,96)-(639,95+DY),5:HSCREEN0:EXEC&HF00:GOTO128
368 IF K>1THEN372
370 GOSUB322:K=ASC(K$):IFK>96 AND K<116THENK=K-97:GOTO362ELSESOUND60,9:GOTO370
372 GOSUB322:K=ASC(K$):IFK>96 AND K<107THENK=K-97:GOTO362ELSESOUND60,9:GOTO372
374 GOSUB322:K=ASC(K$):IFK=8THEN378ELSEIFK=10THEN380ELSEIFK=94THEN382
376 K$=INKEY$:IFL+4<W AND K$=""THENHPUT(L,T)-(L+1,T+D),1:L=L+4:HGET(L,T)-(L+1,T+D),1:HLINE(L,T)-(L+1,T+D),PSET,BF:GOTO376ELSERETURN
378 K$=INKEY$:IFL-4>U AND K$=""THENHPUT(L,T)-(L+1,T+D),1:L=L-4:HGET(L,T)-(L+1,T+D),1:HLINE(L,T)-(L+1,T+D),PSET,BF:GOTO378ELSERETURN
380 K$=INKEY$:IFT+D<191 AND K$=""THENHPUT(L,T)-(L+1,T+D),1:T=T+D+1:HGET(L,T)-(L+1,T+D),1:HLINE(L,T)-(L+1,T+D),PSET,BF:GOTO380ELSERETURN
382 K$=INKEY$:IFT-D>0 AND K$=""THENHPUT(L,T)-(L+1,T+D),1:T=T-D-1:HGET(L,T)-(L+1,T+D),1:HLINE(L,T)-(L+1,T+D),PSET,BF:GOTO382ELSERETURN
384 IFHK=0THENRETURN
386 F$=F$+CHR$(HS)+RIGHT$(STR$(HF),1):HR=HR+1:HF=HF+1:IFHR=5THENHF=1:IFHK=1THENHK=0:CC=0:RETURNELSEIFHK=2THENHS=82:U=8:W=416:GOSUB516ELSEHS=77:U=16:W=304:GOSUB516
388 IFHR=9THENHF=1:IFHK=2THENHK=0:CC=0:RETURNELSEHS=82:U=0:W=288:GOSUB516
390 IFHR=13THENHK=0:CC=0:RETURN
392 V=0:L=U:T=V:GOTO250
394 CLS:LOCATE10,10:PRINT"ARE YOU SURE? (Y/N) ":GOTO322
396 GOSUB322:IFK$<"1" OR K$>"3"THENSOUND60,8:GOTO128ELSEHF=1:HR=1:HS=76:IFK$="1"THENHK=1:U=0:W=640ELSEIFK$="2"THENHK=2:U=64:W=472ELSEHK=3:U=32:W=320
398 GOSUB516:GOSUB392:HF=1:GOTO128
400 CLS:LOCATE11,8:PRINT"TOP MARGIN =";V:LOCATE11,9:PRINT"LEFT MARGIN =";U:LOCATE11,10:PRINT"RIGHT MARGIN =";W:LOCATE11,11:PRINT"BOTTOM MARGIN =";P+D:LOCATE11,12:PRINT"TAB1 =";T1:LOCATE11,13:PRINT"TAB2 =";T2
402 GOTO320
404 GOSUB212:CLS:LOCATE12,8:PRINT"FILENAME: ";:LINEINPUTF$:Z$=RIGHT$(F$,2):Z1$=Z$:IFASC(Z$)=58THENDRIVEVAL(RIGHT$(Z$,1)):F$=LEFT$(F$,LEN(F$)-2)ELSEZ$=":0"
406 IFHK=0 OR I1=1THENRETURNELSEHL=LEN(F$)+2:IFHL>8THENF$=LEFT$(F$,6):HL=8
408 CC=1:FORI=1TOHL:POKEPF-1+I,ASC(MID$(F$+Z$,I,1)):NEXT:RETURN
410 LOCATE15,4:ATTR3,2,U:PRINT"UltraLace";:ATTR2,2:LOCATE8,6:PRINT"THE ULTIMATE SHOESTRING":LOCATE11,8:PRINT"DESKTOP PUBLISHER":ATTR3,2:LOCATE11,12:PRINT"BY H. Allen Curtis":LOCATE13,14:PRINT"COPYRIGHT 1990":LOCATE16,4:ATTR3,2:RETURN
412 CLS:ATTR0,4:OPEN"I",#1,"STR":FORI=1TO6:LINEINPUT#1,AC$:LOCATE4,7+I:PRINTAC$:NEXT
414 GOSUB212:K$=INKEY$:IFK$=""THEN414ELSEIFK$>"6" OR K$<"1"THENSOUND60,5:GOTO414
416 SK=VAL(K$):KS=1
418 FORI=1TOSK:LINEINPUT#1,AC$:NEXT:CLOSE#1:RETURN
420 POKE&H23,A1:POKE&H24,A2:IFKS<=LEN(AC$)THENK$=MID$(AC$,KS,1):KS=KS+1:GOSUB422:GOTO62ELSESCI=0:HPUT(L,T)-(L+1,T+D),1:U=UT:GOTO50
422 IFASC(K$)=94THENK$=CHR$(13):RETURNELSERETURN
424 V=192-(D+1)*INT(192/(D+1)):T=V:RETURN
426 IFH=1THENU=4*INT(.25*L):RETURNELSEU=8*INT(.125*L):RETURN
428 POKE&HFFD8,0:IFEOF(1)=-1THENCLOSE#1:POKE&HFFD9,0:SCI=0:HPUT(L,T)-(L+1,T+D),1:U=UT:GOTO50ELSEGOSUB214:LINEINPUT#1,SK$:POKE&HFFD9,0
430 IFSK=0THENSCI=0:U=UT:GOTO450
432 POKE&H23,A1:POKE&H24,A2:IFKS<=LEN(SK$)THENK$=MID$(SK$,KS,1)ELSE446
434 IFASC(K$)=91THENK$=CHR$(13):RS=1
436 IFASC(K$)=94THENKS=KS+2:IFKS>LEN(SK$)THENKS=1:GOTO428ELSE432
438 IFL=U AND K$=" "THENSZ=1ELSEIFL=U+S AND K$<>" " AND SZ=1THENHPUT(L,T)-(L+1,T+D),1:L=U:SZ=0ELSESZ=0:IFL>U AND KS=1 AND K$=" "THENHPUT(L,T)-(L+1,T+D),1:L=U:IFT<P AND T<191-2*D THENT=T+1+D ELSESK=0:GOTO430
440 KS=KS+1:GOTO62
442 IFH=1THENU=4*INT(.25*L):RETURNELSEU=8*INT(.125*L):RETURN
444 IFSCI<>2THEN124ELSESK=0:GOTO430
446 IFSK$=""THENHPUT(L,T)-(L+1,T+D),1:L=U ELSEKS=1:IFRS=1THENRS=0:GOTO428ELSEIFL+S+8>W THEN488ELSEK$=" ":GOTO62
448 IFT<P AND T<191-2*D THENT=T+1+D:GOTO62ELSESK=0:GOTO430
450 T=V:HSCREEN0:CLS:ATTR0,4
452 LOCATE4,8:PRINT"Do you want to save on disk the         rest of the ASCII strings of":LOCATE13,10::PRINTFA$;":";ZA$:LOCATE4,11:PRINT"for later translation to their          font images? (Y/N)  ";
454 K$=INKEY$:IFK$=""THEN454
456 IFK$="N" OR K$="n"THENCLOSE#1:GOTO168
458 IFK$="Y" OR K$="y"THENLOCATE4,14:PRINT"The rest of the strings will be         saved in REST:";ZA$;
460 IFFA$="REST"THENRE$="TEMP"ELSERE$="REST
462 POKE&HFFD8,0:OPEN"O",#2,RE$+":"+ZA$
464 GOSUB476:IFKS>=LEN(SK$)THEN468
466 PRINT#2,RIGHT$(SK$,LEN(SK$)-KS)
468 IFEOF(1)=-1THENCLOSE#1:CLOSE#2:GOTO472
470 GOSUB214:LINEINPUT#1,SK$:PRINT#2,SK$:GOTO468
472 IFRE$="TEMP"THENKILL"REST/DAT:"+ZA$:RENAME"TEMP/DAT:"+ZA$ TO"REST/DAT:"+ZA$
474 GOTO168
476 KS=KS-1:IFKS=0THENRETURNELSEIFMID$(SK$,KS,1)<>" "THEN476ELSERETURN
478 GOSUB212:SK=6:KS=1:SCI=2:CLS:LOCATE4,8:PRINT"Type filename of ASCII file you         want translated:  ";:LINEINPUTFA$:Z$=RIGHT$(FA$,2):ZA$="0":IFASC(Z$)=58THENZA$=RIGHT$(Z$,1):FA$=LEFT$(FA$,LEN(FA$)-2)
480 POKE&HFFD8,0:OPEN"I",#1,FA$+":"+ZA$:RETURN
482 GOSUB212:CLS:LOCATE11,9:PRINT"1: FULL SCREEN FILE":LOCATE11,10:PRINT"2: HALF SCREEN FILE":LOCATE11,11:PRINT"3: WORD PROCESSOR FILE":LOCATE11,12:PRINT"4: ASCII STRINGS
484 GOSUB322:IFK$="1"THENI1=1:GOSUB30:I1=0:GOTO128ELSEIFK$="2"THENI1=1:GOSUB34:I1=0:GOTO128ELSEIFK$="3"THEN486ELSEIFK$="4"THENSCI=1:UT=U:GOSUB426:GOSUB412:GOTO168ELSESOUND60,5:GOTO128
486 UT=U:GOSUB478:GOTO168
488 HPUT(L,T)-(L+1,T+D),1:L=U:IFT<P AND T<191-2*D THENT=T+D+1:GOTO428ELSESK$="":GOTO448
490 CLOSE#1:FORI=0TO2000:NEXT:GOTO128
492 IFERLIN=472THEN474
494 IFERLIN=40THEN48
496 IFERLIN=328THENSOUND60,9:GOSUB328:GOTO128
498 IFERLIN=98THENT1=T:FORI=1TOSF:HPUT(U,T)-(W-1,T+INT(D/SF)),4:T=T+INT(D/SF):NEXT:T=T1:L=U:GOTO50
500 IFERLIN=470 AND ERNO=23 THENCLOSE#1:CLOSE#2:GOTO472
502 IFERLIN=30 OR ERLIN=34 OR ERLIN=480THEN504ELSE506
504 SCI=0:SOUND60,5:LOCATE5,11:PRINT"THERE IS NO FILE BY THAT NAME":LOCATE7,13:PRINT"ON THE DISK IN DRIVE ";:IFZ$=""THENPRINT"0":GOTO490ELSEIFASC(Z$)=58THENPRINTRIGHT$(Z$,1):GOTO490ELSEPRINT"0":GOTO490
506 IFERLIN=26THENKILLF$+"/HR1":KILLF$+"/HR2":RENAME"OUT1/BIN"TOF$+"/HR1":RENAME"OUT2/BIN"TOF$+"/HR2":DRIVE0:GOTO128
508 IFERLIN=28THENKILLF$+"/HR":RENAME"OUT/BIN"TOF$+"/HR":DRIVE0:GOTO128
510 IFERLIN=12THENWIDTH32:CLS:PRINT"";:WIDTH40:CLS3:LOCATE1,8:PRINT"INSERT ULE DISK IN DRIVE 0 & HIT SPACE";:GOSUB322:POKE&H13FF,9:GOSUB12:GOTO128
512 IFERLIN=180THENCLOSE#1:K$="F":SOUND60,9:EXEC&HF8E:GOTO138
514 GOTO334
516 IFH=1THENU=.5*U:W=.5*W:RETURNELSERETURN
1 PCLEAR1:CLEAR6000:CMP:WIDTH40:CLS3:GOSUB410:W=640:H=3:F1$="ABCDEFGH":PF=VARPTR(F1$):PF=256*PEEK(PF+2)+PEEK(PF+3):GOTO15
2 P$=RIGHT$(STR$(I),1)+"/HR1":Q$=RIGHT$(STR$(I),1)+"/HR2":RETURN
3 RENAMEF$+"L"+P$TO"L1/BIN":RENAMEF$+"L"+Q$TO"L2/BIN":RETURN
4 POKE&HFFA2,&H70:LOADM"L1":POKE&HFFA2,&H71:LOADM"L2":RETURN
5 RENAME"L1/BIN"TOF$+"L"+P$:RENAME"L2/BIN"TOF$+"L"+Q$:RETURN
6 FORI=0TO29:POKEI+&H1321,PEEK(K+I):NEXT:RETURN
7 K=&H135F:GOSUB6:POKE&H127F,1:POKE&H1283,&H50:POKE&H12DE,0:POKE&H1263,&H10:POKE&H1280,&H21:GOSUB404:FORI=1TO4:GOSUB2:GOSUB3:GOSUB4:POKE&HFFA2,&H7A:GOSUB5:EXEC&H12CB:NEXT:RETURN
8 K=&H1341:GOSUB6:POKE&H127F,&H15:POKE&H1283,&H3C:POKE&H12DE,0:POKE&H1263,0:POKE&H1280,&H1E:GOSUB404:FORI=1TO4:GOSUB2:GOSUB3:RENAMEF$+"R"+P$TO"R1/BIN":RENAMEF$+"R"+Q$TO"R2/BIN"
9 GOSUB4:POKE&HFFA2,&H72:LOADM"R1":POKE&HFFA2,&H73:LOADM"R2":POKE&HFFA2,&H7A:GOSUB5:RENAME"R1/BIN"TOF$+"R"+P$:RENAME"R2/BIN"TOF$+"R"+Q$:EXEC&H12CB:NEXT:RETURN
10 K=&H1341:GOSUB6:POKE&H127F,&H29:POKE&H1283,&H28:POKE&H12DE,&H12:POKE&H1280,&H1E:GOSUB404:FORI=1TO4:P$=RIGHT$(STR$(I),1)+"/HR":RENAMEF$+"L"+P$TO"L/BIN":RENAMEF$+"M"+P$TO"M/BIN":RENAMEF$+"R"+P$TO"R/BIN"
11 POKE&HFFA2,&H70:LOADM"L":POKE&HFFA2,&H71:LOADM"M":POKE&HFFA2,&H72:LOADM"R":POKE&HFFA2,&H7A:RENAME"L/BIN"TOF$+"L"+P$:RENAME"M/BIN"TOF$+"M"+P$:RENAME"R/BIN"TOF$+"R"+P$:EXEC&H12CB:NEXT
12 POKE&HFFA2,&H72:LOADM"DMENU/HR1:0":POKE&HFFA2,&H7A:RETURN
13 '
14 '
15 HCOLOR3,0:ON BRK GOTO332
16 LOADM"MLR":POKE&HFFA2,&H70:LOADM"DMENU/HR1":POKE&HFFA2,&H71:LOADM"DMENU/HR2":POKE&HFFA2,&H77:LOADM"FMENU/HR1":POKE&HFFA2,&H7A:EXEC&HF00
17 POKE150,18:POKE55455,65:POKE55456,66:POKE55232,0:POKE55318,20
18 ON ERR GOTO22
20 K$=K$+"C":A1=PEEK(VARPTR(K$)+2):A2=PEEK(VARPTR(K$)+3):IFA2<2THENA2=254:A1=A1-1:GOTO36ELSEA2=A2-2:GOTO36
22 POKE&HFFA2,&H7A:GOTO492
24 '
26 GOSUB384:POKE&HFFA2,&H70:SAVEM"OUT1",&H4000,&H5FFF,&HAC73:POKE&HFFA2,&H71:SAVEM"OUT2",&H4000,&H5BFF,&HAC73:POKE&HFFA2,&H7A:RENAME"OUT1/BIN"TOF$+"/HR1":RENAME"OUT2/BIN"TOF$+"/HR2":DRIVE0:RETURN
28 EXEC&HF3C:GOSUB384:POKE&HFFA2,&H70:SAVEM"OUT",&H4000,&H5DFF,&HAC73:POKE&HFFA2,&H7A:RENAME"OUT/BIN"TOF$+"/HR":DRIVE0:RETURN
30 GOSUB404:RENAMEF$+"/HR1"TO"IN1/BIN":RENAMEF$+"/HR2"TO"IN2/BIN":POKE&HFFA2,&H70:LOADM"IN1":POKE&HFFA2,&H71:LOADM"IN2":POKE&HFFA2,&H7A
32 RENAME"IN1/BIN"TOF$+"/HR1":RENAME"IN2/BIN"TOF$+"/HR2":DRIVE0:RETURN
34 GOSUB404:RENAMEF$+"/HR"TO"IN/BIN":POKE&HFFA2,&H70:LOADM"IN":POKE&HFFA2,&H7A:RENAME"IN/BIN"TOF$+"/HR":DRIVE0:EXEC&HF71:RETURN
36 L2=1:P=176:DIMF$(84),M(84):POKE&HFFD9,0
38 C1=63:PALETTE0,63:PALETTE1,63:PALETTE2,63:PALETTE3,0
40 EXEC&H1000:POKE&HE6E4,&HE6:HSCREENH:POKE&HE6E4,&HE7:HBUFF1,399:HGET(8,152)-(9,152+D),1
42 HBUFF4,3200:HBUFF5,2104:HGET(0,0)-(639,19),4:HBUFF6,1520
44 EXEC&HF00:HGET(48,16)-(63,31),5:EXEC&HF00:DX=16:DY=16
46 PALETTE1,0
48 T=V:L=U:K$="F":GOTO138
50 IFZ=U AND L+4>W-1THENL=U:IFT<P THENT=T+D+1
52 IFZ<>U AND L+4>W-1THENFL=1:GOTO112
54 HGET(L,T)-(L+1,T+D),1:HLINE(L,T)-(L+1,T+D),PSET,BF
56 POKE&H23,A1:POKE&H24,A2
58 IFSCI=1THEN420ELSEIFSCI=2 AND KS=1THEN428ELSEIFSCI=2THEN432
60 K$=INKEY$:IFK$=""THEN60
62 K=ASC(K$):IFK>64 AND K<91THENN=K-64:B=N:HLINE(L,T)-(L+1,T+D),PRESET,BF:GOTO106
64 IFK>96 AND K<123THENN=K-96:B=N+26:GOTO106
66 IFK>47 AND K<58THENN=K-47:B=N+52:GOTO106
68 IFK>32 AND K<48THENN=K-32:B=N+62:GOTO106
70 IFK>57 AND K<65THENN=K-57:B=N+77:GOTO106
72 IFK=32THENZ=L+S:IFL+8<W THENHLINE(L,T)-(L+7,T+D),PRESET,BF:L=L+S:GOTO50ELSEHLINE(L,T)-(L+1,T+D),PRESET,BF:L=U:IFT<P AND T<191-2*D THENT=T+1+D:GOTO50ELSEFL=0:GOTO444
74 IFK=13THENHPUT(L,T)-(L+1,T+D),1:L=U
76 IFK=13 AND T<P THENT=T+1+D:GOTO54ELSEIFK=13THEN54
78 IFK=8THENL=2*INT(.5*L):HLINE(L,T)-(L+1,T+D),PRESET,BF:IFL>1THENL=L-2:GOTO50ELSEL=0:GOTO50
80 IFK=93THENIFH=1THENSOUND60,9:GOTO50ELSEZ=U:HLINE(L,T)-(L+1,T+D),PRESET,BF:IFL+DX-1<W THENL=8*INT(.125*L):HPUT(L,T)-(L+DX-1,T+DY-1),5:L=L+DX:GOTO50ELSESOUND60,9:GOTO50
82 IFK=94THENHPUT(L,T)-(L+1,T+D),1:IFT>D THENT=T-1-D:GOTO50
84 IFK=10THENHPUT(L,T)-(L+1,T+D),1:IFT+D<191THENT=T+D+1:GOTO50
86 IFK=91THENZ=U:HPUT(L,T)-(L+1,T+D),1:HDRAW"BM"+STR$(L)+","+STR$(T+1+INT(.75*D))+"R4":L=L+4:GOTO50:IFL>W-5THENL=L-4:GOTO50
88 IFK=9 AND L+4<W THENHPUT(L,T)-(L+1,T+D),1:L=L+4:GOTO50
90 IFK=92THENEXEC&H1000:T=V:L=U:GOTO50
92 IFK=4THENHPUT(L,T)-(L+1,T+D),1:GOTO128
94 IFK=12THENHPUT(L,T)-(L+1,T+D),1:IFT3=0THENT3=1:L=T1:GOTO50ELSEIFT3=1THENT3=0:L=T2:GOTO50
96 IFK=189THENGOSUB374
98 IFK=21THENHPUT(U,T)-(W-1,T+.5*D),4:HPUT(U,T+.5*D)-(W-1,T+D),4:L=U:GOTO50
100 IFK=95THENI=2*H+2:HPUT(L,T)-(L+1,T+D),1:IFL>W*.5THENHGET(U,T)-(W-I-1,T+.5*D+.5),6:HPUT(U+I,T)-(W-1,T+.5*D+.5),6:HGET(U,T+.5*D+1.5)-(W-I-1,T+D),6:HPUT(U+I,T+.5*D+1.5)-(W-1,T+D),6:GOTO104
102 IFK=95THENHGET(U+I,T)-(W-1,T+.5*D+.5),6:HPUT(U,T)-(W-1-I,T+.5*D+.5),6:HGET(U+I,T+.5*D+1.5)-(W-1,T+D),6:HPUT(U,T+.5*D+1.5)-(W-1-I,T+D),6
104 IFK<>95THENHPUT(L,T)-(L+1,T+D),1:GOTO50ELSE50
106 HLINE(L,T)-(L+1,T+D),PRESET,BF:IFL+M(B)<W THENGOSUB126:L=L+2*INT(.5+M(B)*.5)+2:IFL>W-1THENL2=L-W+1:L=W-1:GOTO50ELSE50
108 IFZ=U THENL=U:IFT<P AND T<191-2*D THENT=T+D+1:GOTO62ELSE62
110 FL=2
112 IFH=3THENZ1=8*INT(.125*Z)
114 IFH=1THENZ1=4*INT(.25*Z)
116 Z=Z1
118 HGET(Z,T)-(L,T+D),6:HPUT(Z,T)-(L,T+D),4:L1=L-Z:L=U:Z=U:IFT<P AND T<191-2*D THENT=T+D+1ELSE444
120 IFL+L1<0THENL1=L1+2:GOTO120
122 IFSCI<>2THENHPUT(L,T)-(L+L1,T+D),6:L=L+L1+L2:L=2*INT(.5*L+.5):L2=0ELSEL=U:GOSUB476:KS=KS+1:GOTO432
124 N=FL+1:ON N GOTO50,54,62
126 HDRAW"BM"+STR$(L)+","+STR$(T)+F$(B):RETURN
128 HSCREEN0:CLS:ATTR0,4:LOCATE10,4:PRINT"A: ART-DESIGNS":LOCATE10,5:PRINT"B: BACK TO SCREEN":LOCATE10,6:PRINT"C: CONVERT WPF":LOCATE10,7:PRINT"D: DIR":LOCATE10,8:PRINT"F: FONT SELECT
130 LOCATE10,9:PRINT"H: HOUSEKEEPING":LOCATE10,10:PRINT"I: INPUT":LOCATE10,11:PRINT"K: KEYS LISTED":LOCATE10,12:PRINT"M: MARGIN SET":LOCATE10,13:PRINT"O: OUTPUT":LOCATE10,14:PRINT"P: PRESENT STATUS
132 LOCATE10,15:PRINT"R: RESOLUTION CHANGE":LOCATE10,16:PRINT"S: SCREEN DUMP":LOCATE10,17:PRINT"T: TAB SET":LOCATE10,18:PRINT"X: EXIT UltraLace":LOCATE14,18:POKE&H23,A1:POKE&H24,A2:POKE&HFFD8,0
134 K$=INKEY$:IFK$=""THEN134
136 IFK$="D" OR K$="d"THENGOSUB326:GOTO128
138 IFK$="F" OR K$="f"THENOD=D:L1=L:EXEC&HF8E:POKE&HE6E4,&HE6:HSCREEN3:POKE&HE6E4,&HE7:GOSUB170:L=L1:EXEC&HF8E:GOTO128
140 IFK$="B" OR K$="b"THEN168
142 IFK$="H" OR K$="h"THENGOSUB324:GOTO396
144 IFK$="I" OR K$="i"THEN482
146 IFK$="K" OR K$="k"THENGOSUB308:GOTO128
148 IFK$="O" OR K$="o"THENIFCC=0 AND HK=0THEN348ELSEIFCC=0THEN346ELSEF$=LEFT$(F1$,HL):DRIVEVAL(RIGHT$(F$,1)):F$=LEFT$(F$,HL-2):IFHK=3THENCLS:GOSUB28:GOTO128ELSECLS:GOSUB26:GOTO128
150 IFK$="M" OR K$="m"THENGOSUB218:GOTO128
152 IFK$="P" OR K$="p"GOSUB400:GOTO128
154 IFK$="R" OR K$="r"THENIFH=1THENH=3:U=2*U:W=2*W:T1=2*T1:T2=2*T2:GOTO128ELSEH=1:U=.5*U:W=.5*W:T1=.5*T1:T2=.5*T2:GOTO128
156 IFK$="T" OR K$="t"THENGOSUB298:GOTO128
158 IFK$="C" OR K$="c"THEN252
160 IFK$="S" OR K$="s"THENGOSUB324:GOSUB322:IFK$="1"THENGOSUB7:GOTO128ELSEIFK$="2"THENGOSUB8:GOTO128ELSEIFK$="3"THENPOKE&H13FF,0:GOSUB10:GOTO128ELSESOUND60,9:GOTO128
162 IFK$="A" OR K$="a"THEN330
164 IFK$="X" ORK$="x"THENGOSUB394:IFK$="Y" OR K$="y"THENCLS3:POKE&HFFD8,0:DRIVE0:ENDELSE128
166 SOUND60,5:SOUND60,5:GOTO128
168 POKE&HE6E4,&HE6:HSCREENH:POKE&HE6E4,&HE7:POKE&HFFD9,0:GOTO202
170 GOTO204
172 POKE&H23,A1:POKE&H24,A2:GOSUB322
174 IFK$<"0" OR K$>"9" THENSOUND60,10:RETURNELSEK$="1"+K$
176 GOSUB212
178 GOSUB216
180 OPEN"I",#1,"FONT"+K$
182 FORI=1TO84:LINEINPUT#1,F$(I):NEXT
184 FORI=1TO84:INPUT#1,M(I):NEXT
186 INPUT#1,D,S:CLOSE#1:IFD>7 AND D<11THEND=11ELSEIFD>11 AND D<15THEND=15ELSEIFD>15THEND=23
188 K=T
190 T=T+INT(.5*(OD-D)):V=T:IFT<0THENT=0:V=0ELSEIFT>P THENT=P-1
192 IFV>=0THENV=V-D-1:GOTO192ELSEV=V+D+1
194 IFK=0THENGOSUB424:GOSUB250
196 RETURN
198 HPUT(16,20)-(111,170),5
200 GOSUB250
202 HGET(L,T)-(L+1,T+D),1:GOTO50
204 POKE&H23,A1:POKE&H24,A2:GOSUB322
206 K=ASC(K$):IFK>96 AND K<122THENK=K-32:K$=CHR$(K)
208 IFK>64 AND K<90THEN176ELSESOUND60,9:GOTO204
210 POKE&H23,A1:POKE&H24,A2:RETURN
212 POKE&H23,A1-1:POKE&H24,A2:RETURN
214 POKE&H23,A1-2:POKE&H24,A2:RETURN
216 POKE&H23,A1-4:POKE&H24,A2:RETURN
218 GOSUB212:CLS:LOCATE6,8:PRINT"ENTER TOP MARGIN (0 - 10): ";:LINEINPUTV$:LOCATE6,10:PRINT"ENTER LEFT MARGIN ";:IFV$=""THENV$=STR$(V)
220 LOCATE24,10:IFH=1THENPRINT"(0 - 200):     ":LOCATE35,10ELSEPRINT"(0 - 400):     ":LOCATE35,10
222 GOSUB214:LINEINPUTU$:GOSUB306:V=VAL(V$):U=VAL(U$):IFH=1THENU=4*INT(.25*U):Z=U ELSEU=8*INT(.125*U):Z=U
224 IFV<0THENV=0
226 IFV>10THENV=10
228 IF U>W-50THENSOUND60,5:LOCATE10,15:PRINT"LEFT MARGIN TOO BIG":LOCATE8,16:PRINT"RELATIVE TO RIGHT MARGIN!":LOCATE14,17:PRINT"TRY AGAIN.":GOTO220
230 IFU<0THENU=0
232 IFH=1 AND U>200THENU=200
234 IFH=3 AND U>400THENU=400
236 GOSUB212:LOCATE4,12:PRINT"ENTER RIGHT MARGIN ( 0 -";320+(H-1)*160;"): ";:LINEINPUTW$:IFW$=""THENW$=STR$(W)
238 W=VAL(W$):IFW<U+50THENSOUND60,5:LOCATE9,15:PRINT"RIGHT MARGIN TOO SMALL":LOCATE8,16:PRINT"RELATIVE TO LEFT MARGIN. ":LOCATE14,17:PRINT"TRY AGAIN.":GOTO236
240 GOSUB290
242 CLS:LOCATE6,12:PRINT"DO YOU WANT TO CHANGE THE":LOCATE6,13:PRINT"BOTTOM MARGIN?  (Y/N) ";
244 GOSUB322:IFK$="N" OR K$="n" OR ASC(K$)=13THENL=U:T=V:RETURNELSEIFK$="Y" OR K$="y"THEN246ELSESOUND60,5:GOTO244
246 LOCATE6,16:PRINT"DO YOU WANT IT AT THE MOST":LOCATE6,17:PRINT"RECENT CURSOR POSITION?  (Y/N) ":LOCATE6,18:PRINT"IF NOT, IT WILL BE SET TO THE":LOCATE6,19:PRINT"LOWEST POSSIBLE CURSOR POSITION.":LOCATE37,17
248 GOSUB322:IFK$="N" OR K$="n"THENGOSUB424:GOTO250ELSEIFK$="Y" OR K$="y"THENP=T:L=U:T=V:RETURNELSESOUND65,0:GOTO248
250 P=V+(D+1)*(-1+INT((192-V)/(D+1))):RETURN
252 GOSUB212:CLS:LOCATE5,8:PRINT"FILENAME INCLUDING EXTENSION:":LOCATE13,9:LINEINPUTF$:Z$=RIGHT$(F$,2):IFASC(Z$)=58THENDRIVEVAL(RIGHT$(Z$,1)):F$=LEFT$(F$,LEN(F$)-2)ELSEDRIVE0
254 N=INSTR(F$,"/"):IFN=0THEN252ELSEG$=LEFT$(F$,N)+"DAT"
256 J=0:IFRIGHT$(F$,3)="DAT"THENRENAMEF$TOLEFT$(F$,N)+"TXT":F$=LEFT$(F$,N)+"TXT"
258 OPEN"D",#1,F$:FIELD#1,128 AS A$,128 AS B$
260 CLOSE#2:OPEN"O",#2,G$
262 IFDN=1THEN288ELSEGOSUB210:J=J+1:GET#1,J:C$=A$
264 B=INSTR(B$,"]"):IFINSTR(A$,"]")>0 OR B>0THENDN=1:IFB>0THENB$=LEFT$(B$,B-1)ELSEC$=LEFT$(C$,INSTR(C$,"]")-1):B$=""
266 N=INSTR(C$,CHR$(13)):IFN>0THENGOSUB286:C$=RIGHT$(C$,LEN(C$)-N):IFC$=""THENC$=B$:GOTO270ELSE266
268 GOSUB276:C$=C$+B$
270 N=INSTR(C$,CHR$(13)):IFN>0THENGOSUB286:C$=RIGHT$(C$,LEN(C$)-N):IFC$=""THEN262ELSE270
272 GOSUB276:IFDN=1THEN288ELSEGOSUB210:J=J+1:GET#1,J:C$=C$+A$
274 GOTO264
276 I=1
278 IFLEN(C$)=I OR C$=STRING$(LEN(C$),32)THENK=0:GOTO284
280 K=INSTR(LEN(C$)+1-I,C$," "):IFK=0THENI=I+1:GOTO278
282 PRINT#2,LEFT$(C$,K-1)
284 C$=RIGHT$(C$,LEN(C$)-K):RETURN
286 IFLEFT$(C$,N)=CHR$(13)THENPRINT#2," [":RETURNELSEPRINT#2,LEFT$(C$,N-1):RETURN
288 CLOSE#1:PRINT#2,C$:CLOSE#2:DRIVE0:DN=0:GOTO128
290 IFH=1 AND W>320THENW=320
292 IFW>640THENW=640
294 IFH=1THENW=4*INT(.25*W)ELSEW=8*INT(.125*W)
296 RETURN
298 GOSUB212:CLS:LOCATE6,8:PRINT"ENTER 1ST TAB VALUE: ";:LINEINPUTT$:GOSUB304:T1=2*INT(VAL(T$)*.5):IFH=1 AND T1>320THENT1=320ELSEIFT1>640THENT1=640
300 GOSUB212:LOCATE6,12:PRINT"ENTER 2ND TAB VALUE: ";:LINEINPUTT$:GOSUB304:T2=2*INT(VAL(T$)*.5):IFH1 AND T2>320THENT2=320ELSEIFT2>640THENT2=640
302 RETURN
304 IFT$="c" OR T$="C" THENT$=STR$(L):RETURNELSERETURN
306 IFU$=""THENU$=STR$(U):RETURNELSERETURN
308 CLS:LOCATE2,2:PRINT"F2:          CALL COMMAND MENU":LOCATE2,3:PRINT"RIGHT ARROW: MOVE CURSOR RIGHT":PRINT"  LEFT ARROW:  BACKSPACE":PRINT"  UP ARROW:    MOVE CURSOR UP 1 LINE":PRINT"  DOWN ARROW:  MOVE CURSOR DOWN 1 LINE
310 LOCATE2,7:PRINT"ENTER:       CARRIAGE RETURN &":LOCATE15,8:PRINT"MOVE CURSOR DOWN 1 LINE":PRINT"  CLEAR:       TAB":LOCATE7,11:ATTR0,4,U:PRINT"KEYS WITH SHIFT HELD DOWN";:ATTR0,4
312 LOCATE2,13:PRINT"RIGHT ARROW: DRAW CLIP ART":PRINT"  LEFT ARROW:  CLEAR LINE":PRINT"  UP ARROW:    MOVE CHAR-LINE TOWARD":LOCATE15,16:PRINT"CURSOR HALF OF SCREEN":PRINT"  DOWN ARROW:  UNDERLINE":PRINT"  CLEAR:       CLEAR SCREEN
314 PRINT"  0:           UPPER/LOWER CASE":LOCATE4,22:ATTR0,4,U:PRINT"PRESS SPACE FOR REST OF KEY LIST";:ATTR0,4:LOCATE4,22:E$="        STOPPED BY ANY KEY OR MARGIN":GOSUB322
316 CLS:LOCATE6,5:ATTR0,4,U:PRINT"KEYS PRESSED AFTER CTRL KEY";:ATTR0,4:LOCATE2,7:PRINT"RIGHT ARROW: MOVE CURSOR RIGHT UNTIL"+E$:PRINT"  LEFT ARROW:  MOVE CURSOR LEFT UNTIL "+E$
318 LOCATE2,11:PRINT"UP ARROW:    MOVE CURSOR UP UNTIL   "+E$:PRINT"  DOWN ARROW:  MOVE CURSOR DOWN UNTIL "+E$
320 LOCATE5,22:PRINT"PRESS ";:ATTR0,4,U:PRINT"SPACE";:ATTR0,4:PRINT" TO RETURN TO MENU";:LOCATE12,22
322 K$=INKEY$:IFK$=""THEN322ELSERETURN
324 CLS:LOCATE8,10:PRINT"1: 1COLUMN/4SCREEN":LOCATE8,11:PRINT"2: 2COLUMN/8SCREEN":LOCATE8,12:PRINT"3: 3COLUMN/12SCREEN":RETURN
326 GOSUB212:CLS:LOCATE12,8:PRINT"DRIVE NUMBER: "
328 GOSUB322:K=VAL(K$):IFK>3THENSOUND60,9:GOTO328ELSEDIRK:PRINT"  FREE GRANULES:";FREE(K):PRINT"     PRESS SPACE TO CONTINUE":GOSUB322:RETURN
330 CLS:LOCATE10,8:PRINT"1: NORMAL":LOCATE10,9:PRINT"2: DOUBLE WIDTH":LOCATE10,10:PRINT"3: DOUBLE WIDTH-LENGTH":LOCATE10,11:MI$=": MIRROR IMAGE OF ":PRINT"4";MI$;"1":LOCATE10,12:PRINT"5";MI$;"2":LOCATE10,13:PRINT"6";MI$;"3":GOTO354
332 GOSUB394:IFK$="Y" OR K$="y"THEN334ELSE128
334 CLS3:POKE&HFFD8,0:DRIVE0
336 IFERNO>-1 AND PEEK(&H13FF)<>9THENPOKE&HFFA1,121:POKE&HFFA2,122ELSEEND
338 IFERNO<25THENAD=&HABAF+ERNO*2ELSEIFERNO>26THENAD=&HC290+2*(ERNO-27)ELSEAD=&H890D
340 WIDTH40:LOCATE8,10:PRINT" ";:PRINTCHR$(PEEK(AD))CHR$(PEEK(AD+1));" ERROR IN LINE";ERLIN
342 LOCATE12,14:PRINT"CONTINUE? (Y,N)":GOSUB322:IFK$="Y" OR K$="y"THENWIDTH40:CLS5:PALETTE0,63:PALETTE1,0:GOTO128
344 END
346 GOSUB404:IFHK=3THENGOSUB28:GOTO128ELSEGOSUB26:GOTO128
348 CLS:LOCATE8,10:PRINT"1: SAVE FULL SCREEN":LOCATE8,12:PRINT"2: SAVE HALF SCREEN"
350 GOSUB322:IFK$="1"THENGOSUB404:GOSUB26:GOTO128ELSEIFK$="2"THENGOSUB404:GOSUB28:GOTO128ELSESOUND60,9:GOTO128
352 GOSUB322:GOTO128
354 GOSUB322:K=VAL(K$):IFK<1 OR K>6THENSOUND60,9:GOTO354ELSEIFK>3THENPOKE&H102A,1:K=K-3ELSEPOKE&H102A,0
356 DK=K:POKE&H1027,K:CLS:EXEC&HF00:POKE&HE6E4,&HE6:HSCREEN3:POKE&HE6E4,&HE7
358 GOSUB322:K=ASC(K$):IFK<48 OR K>51THENSOUND60,9:GOTO358ELSEK=K-48:DX=(K+1)*16:POKE&H1028,2*K+3:IFK>0THEN368
360 GOSUB322:K=ASC(K$):IFK>96 AND K<123THENK=K-97ELSEIFK>64 AND K<77THENK=K-39ELSESOUND60,9:GOTO360
362 POKE&H1029,K:EXEC&H1033:IFDX>48THENDX=48
364 DY=DX:IFDK>1THENDX=2*DX:IFDK=3THENDY=DX
366 IFPEEK(&H102A)=0THENHGET(544,96)-(543+DX,95+DY),5:HSCREEN0:EXEC&HF00:GOTO128ELSEHGET(640-DX,96)-(639,95+DY),5:HSCREEN0:EXEC&HF00:GOTO128
368 IF K>1THEN372
370 GOSUB322:K=ASC(K$):IFK>96 AND K<116THENK=K-97:GOTO362ELSESOUND60,9:GOTO370
372 GOSUB322:K=ASC(K$):IFK>96 AND K<107THENK=K-97:GOTO362ELSESOUND60,9:GOTO372
374 GOSUB322:K=ASC(K$):IFK=8THEN378ELSEIFK=10THEN380ELSEIFK=94THEN382
376 K$=INKEY$:IFL+4<W AND K$=""THENHPUT(L,T)-(L+1,T+D),1:L=L+4:HGET(L,T)-(L+1,T+D),1:HLINE(L,T)-(L+1,T+D),PSET,BF:GOTO376ELSERETURN
378 K$=INKEY$:IFL-4>U AND K$=""THENHPUT(L,T)-(L+1,T+D),1:L=L-4:HGET(L,T)-(L+1,T+D),1:HLINE(L,T)-(L+1,T+D),PSET,BF:GOTO378ELSERETURN
380 K$=INKEY$:IFT+D<191 AND K$=""THENHPUT(L,T)-(L+1,T+D),1:T=T+D+1:HGET(L,T)-(L+1,T+D),1:HLINE(L,T)-(L+1,T+D),PSET,BF:GOTO380ELSERETURN
382 K$=INKEY$:IFT-D>0 AND K$=""THENHPUT(L,T)-(L+1,T+D),1:T=T-D-1:HGET(L,T)-(L+1,T+D),1:HLINE(L,T)-(L+1,T+D),PSET,BF:GOTO382ELSERETURN
384 IFHK=0THENRETURN
386 F$=F$+CHR$(HS)+RIGHT$(STR$(HF),1):HR=HR+1:HF=HF+1:IFHR=5THENHF=1:IFHK=1THENHK=0:CC=0:RETURNELSEIFHK=2THENHS=82:U=8:W=416:GOSUB516ELSEHS=77:U=16:W=304:GOSUB516
388 IFHR=9THENHF=1:IFHK=2THENHK=0:CC=0:RETURNELSEHS=82:U=0:W=288:GOSUB516
390 IFHR=13THENHK=0:CC=0:RETURN
392 V=0:L=U:T=V:GOTO250
394 CLS:LOCATE10,10:PRINT"ARE YOU SURE? (Y/N) ":GOTO322
396 GOSUB322:IFK$<"1" OR K$>"3"THENSOUND60,8:GOTO128ELSEHF=1:HR=1:HS=76:IFK$="1"THENHK=1:U=0:W=640ELSEIFK$="2"THENHK=2:U=64:W=472ELSEHK=3:U=32:W=320
398 GOSUB516:GOSUB392:HF=1:GOTO128
400 CLS:LOCATE11,8:PRINT"TOP MARGIN =";V:LOCATE11,9:PRINT"LEFT MARGIN =";U:LOCATE11,10:PRINT"RIGHT MARGIN =";W:LOCATE11,11:PRINT"BOTTOM MARGIN =";P+D:LOCATE11,12:PRINT"TAB1 =";T1:LOCATE11,13:PRINT"TAB2 =";T2
402 GOTO320
404 GOSUB212:CLS:LOCATE12,8:PRINT"FILENAME: ";:LINEINPUTF$:Z$=RIGHT$(F$,2):Z1$=Z$:IFASC(Z$)=58THENDRIVEVAL(RIGHT$(Z$,1)):F$=LEFT$(F$,LEN(F$)-2)ELSEZ$=":0"
406 IFHK=0 OR I1=1THENRETURNELSEHL=LEN(F$)+2:IFHL>8THENF$=LEFT$(F$,6):HL=8
408 CC=1:FORI=1TOHL:POKEPF-1+I,ASC(MID$(F$+Z$,I,1)):NEXT:RETURN
410 LOCATE15,4:ATTR3,2,U:PRINT"UltraLace";:ATTR2,2:LOCATE8,6:PRINT"THE ULTIMATE SHOESTRING":LOCATE11,8:PRINT"DESKTOP PUBLISHER":ATTR3,2:LOCATE11,12:PRINT"BY H. Allen Curtis":LOCATE13,14:PRINT"COPYRIGHT 1990":LOCATE16,4:ATTR3,2:RETURN
412 CLS:ATTR0,4:OPEN"I",#1,"STR":FORI=1TO6:LINEINPUT#1,AC$:LOCATE4,7+I:PRINTAC$:NEXT
414 GOSUB212:K$=INKEY$:IFK$=""THEN414ELSEIFK$>"6" OR K$<"1"THENSOUND60,5:GOTO414
416 SK=VAL(K$):KS=1
418 FORI=1TOSK:LINEINPUT#1,AC$:NEXT:CLOSE#1:RETURN
420 POKE&H23,A1:POKE&H24,A2:IFKS<=LEN(AC$)THENK$=MID$(AC$,KS,1):KS=KS+1:GOSUB422:GOTO62ELSESCI=0:HPUT(L,T)-(L+1,T+D),1:U=UT:GOTO50
422 IFASC(K$)=94THENK$=CHR$(13):RETURNELSERETURN
424 V=192-(D+1)*INT(192/(D+1)):T=V:RETURN
426 IFH=1THENU=4*INT(.25*L):RETURNELSEU=8*INT(.125*L):RETURN
428 POKE&HFFD8,0:IFEOF(1)=-1THENCLOSE#1:POKE&HFFD9,0:SCI=0:HPUT(L,T)-(L+1,T+D),1:U=UT:GOTO50ELSEGOSUB214:LINEINPUT#1,SK$:POKE&HFFD9,0
430 IFSK=0THENSCI=0:U=UT:GOTO450
432 POKE&H23,A1:POKE&H24,A2:IFKS<=LEN(SK$)THENK$=MID$(SK$,KS,1)ELSE446
434 IFASC(K$)=91THENK$=CHR$(13):RS=1
436 IFASC(K$)=94THENKS=KS+2:IFKS>LEN(SK$)THENKS=1:GOTO428ELSE432
438 IFL=U AND K$=" "THENSZ=1ELSEIFL=U+S AND K$<>" " AND SZ=1THENHPUT(L,T)-(L+1,T+D),1:L=U:SZ=0ELSESZ=0:IFL>U AND KS=1 AND K$=" "THENHPUT(L,T)-(L+1,T+D),1:L=U:IFT<P AND T<191-2*D THENT=T+1+D ELSESK=0:GOTO430
440 KS=KS+1:GOTO62
442 IFH=1THENU=4*INT(.25*L):RETURNELSEU=8*INT(.125*L):RETURN
444 IFSCI<>2THEN124ELSESK=0:GOTO430
446 IFSK$=""THENHPUT(L,T)-(L+1,T+D),1:L=U ELSEKS=1:IFRS=1THENRS=0:GOTO428ELSEIFL+S+8>W THEN488ELSEK$=" ":GOTO62
448 IFT<P AND T<191-2*D THENT=T+1+D:GOTO62ELSESK=0:GOTO430
450 T=V:HSCREEN0:CLS:ATTR0,4
452 LOCATE4,8:PRINT"Do you want to save on disk the         rest of the ASCII strings of":LOCATE13,10::PRINTFA$;":";ZA$:LOCATE4,11:PRINT"for later translation to their          font images? (Y/N)  ";
454 K$=INKEY$:IFK$=""THEN454
456 IFK$="N" OR K$="n"THENCLOSE#1:GOTO168
458 IFK$="Y" OR K$="y"THENLOCATE4,14:PRINT"The rest of the strings will be         saved in REST:";ZA$;
460 IFFA$="REST"THENRE$="TEMP"ELSERE$="REST
462 POKE&HFFD8,0:OPEN"O",#2,RE$+":"+ZA$
464 GOSUB476:IFKS>=LEN(SK$)THEN468
466 PRINT#2,RIGHT$(SK$,LEN(SK$)-KS)
468 IFEOF(1)=-1THENCLOSE#1:CLOSE#2:GOTO472
470 GOSUB214:LINEINPUT#1,SK$:PRINT#2,SK$:GOTO468
472 IFRE$="TEMP"THENKILL"REST/DAT:"+ZA$:RENAME"TEMP/DAT:"+ZA$ TO"REST/DAT:"+ZA$
474 GOTO168
476 KS=KS-1:IFKS=0THENRETURNELSEIFMID$(SK$,KS,1)<>" "THEN476ELSERETURN
478 GOSUB212:SK=6:KS=1:SCI=2:CLS:LOCATE4,8:PRINT"Type filename of ASCII file you         want translated:  ";:LINEINPUTFA$:Z$=RIGHT$(FA$,2):ZA$="0":IFASC(Z$)=58THENZA$=RIGHT$(Z$,1):FA$=LEFT$(FA$,LEN(FA$)-2)
480 POKE&HFFD8,0:OPEN"I",#1,FA$+":"+ZA$:RETURN
482 GOSUB212:CLS:LOCATE11,9:PRINT"1: FULL SCREEN FILE":LOCATE11,10:PRINT"2: HALF SCREEN FILE":LOCATE11,11:PRINT"3: WORD PROCESSOR FILE":LOCATE11,12:PRINT"4: ASCII STRINGS
484 GOSUB322:IFK$="1"THENI1=1:GOSUB30:I1=0:GOTO128ELSEIFK$="2"THENI1=1:GOSUB34:I1=0:GOTO128ELSEIFK$="3"THEN486ELSEIFK$="4"THENSCI=1:UT=U:GOSUB426:GOSUB412:GOTO168ELSESOUND60,5:GOTO128
486 UT=U:GOSUB478:GOTO168
488 HPUT(L,T)-(L+1,T+D),1:L=U:IFT<P AND T<191-2*D THENT=T+D+1:GOTO428ELSESK$="":GOTO448
490 CLOSE#1:FORI=0TO2000:NEXT:GOTO128
492 IFERLIN=472THEN474
494 IFERLIN=40THEN48
496 IFERLIN=328THENSOUND60,9:GOSUB328:GOTO128
498 IFERLIN=98THENT1=T:FORI=1TOSF:HPUT(U,T)-(W-1,T+INT(D/SF)),4:T=T+INT(D/SF):NEXT:T=T1:L=U:GOTO50
500 IFERLIN=470 AND ERNO=23 THENCLOSE#1:CLOSE#2:GOTO472
502 IFERLIN=30 OR ERLIN=34 OR ERLIN=480THEN504ELSE506
504 SCI=0:SOUND60,5:LOCATE5,11:PRINT"THERE IS NO FILE BY THAT NAME":LOCATE7,13:PRINT"ON THE DISK IN DRIVE ";:IFZ$=""THENPRINT"0":GOTO490ELSEIFASC(Z$)=58THENPRINTRIGHT$(Z$,1):GOTO490ELSEPRINT"0":GOTO490
506 IFERLIN=26THENKILLF$+"/HR1":KILLF$+"/HR2":RENAME"OUT1/BIN"TOF$+"/HR1":RENAME"OUT2/BIN"TOF$+"/HR2":DRIVE0:GOTO128
508 IFERLIN=28THENKILLF$+"/HR":RENAME"OUT/BIN"TOF$+"/HR":DRIVE0:GOTO128
510 IFERLIN=12THENWIDTH32:CLS:PRINT"";:WIDTH40:CLS3:LOCATE1,8:PRINT"INSERT ULE DISK IN DRIVE 0 & HIT SPACE";:GOSUB322:POKE&H13FF,9:GOSUB12:GOTO128
512 IFERLIN=180THENCLOSE#1:K$="F":SOUND60,9:EXEC&HF8E:GOTO138
514 GOTO334
516 IFH=1THENU=.5*U:W=.5*W:RETURNELSERETURN
