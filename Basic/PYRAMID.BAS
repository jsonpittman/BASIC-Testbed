0 'PYRAMID                      ** WRITTEN BY GEORGE QUELLHORST ** COPYRIGHT (C) MAY 1991       ** BY FALSOFT, INC.             ** RAINBOW MAGAZINE
1 DATA 284,0,244,24,324,24,204,48,284,48,364,48,164,72,244,72,324,72,404,72,124,96,204,96,284,96,364,96,444,96,84,120,164,120,244,120,324,120,404,120,484,120,44,144,124,144,204,144,284,144,364,144,444,144,524,144
2 CLEAR1000:RGB:HBUFF1,810:HBUFF2,810:HBUFF3,810:HBUFF4,810:HBUFF5,810:SH=1:POKE400,180:EXEC43350:POKE&HF80F,0:POKE&HF84F,0:POKE&HF89C,0:PALETTE0,63:PALETTE1,60:PALETTE2,0:PALETTE3,36:DIMN$(13),X(29),F(29),Y(29),CA(52)
3 POKE65497,.:WIDTH80:CLS1:POKE65434,63:LOCATE27,11:PRINT"PLEASE WAIT DRAWING SCREEN":IFSH=1THENLOCATE30,13:PRINT"AND SHUFFLING CARDS"
4 R=RND(-TIMER):GOSUB50:IFSH=1THENGOSUB55
5 GOSUB43:POKE41598,255:T=25:DE=29:ONBRKGOTO64
6 'Cursor control.
7 P$=INKEY$
8 HCOLOR2:HDRAW"BM"+STR$(X(T))+","+STR$(Y(T))+A$
9 IFDE=52 ANDMO=1 THENGOSUB70
10 IFP$=CHR$(8)THENT=T-1 ELSEIFP$=CHR$(9)THENT=T+1 ELSE13
11 IFT=>29THENT=1ELSEIFT=0THENT=28
12 IFF(T)=0 OR F(T)=2 THEN10ELSEEXEC
13 IFP$=CHR$(13)THENF(T)=2:GOTO19 ELSEIFP$=CHR$(94)THENEXEC:GOTO37
14 IFP$=CHR$(10) THENSH=0:CA(0)=AC:GOTO3ELSEIFP$=" "THENSH=1:GOTO3
15 HCOLOR0:HDRAW"BM"+STR$(X(T))+","+STR$(Y(T))+A$
16 IFP$="Q"THEN64
17 GOTO 7
18 ' The enter key.
19 GOSUB59:Q=0:EC=W:TT=T:T=0:GOSUB59:Q=0:TC=W
20 IFEC-TC=1 OR EC-TC=12 OR TC-EC=1 OR TC-EC=12 THENT=TT:GOTO22
21 GOSUB65:T=TT:F(T)=1:GOTO7
22 EXEC:H=T:Z=3:GOSUB68:Z=2:GOSUB67:H=0:Z=3:GOSUB67
23 H=T-1:Z=4:GOSUB68:H=T+1:Z=5:GOSUB68:CN=T-(Y(T)/24):IFF(1)=2THEN74
24 L=CN-1:R=CN:IFY(L)=Y(R)THEN25ELSEIFX(T)>284THEN28 ELSEIFY(L)<>Y(R)THEN27
25 H=L:Z=1:GOSUB67:H=R:GOSUB67
26 H=T-1:Z=4:GOSUB67:H=T+1:Z=5:GOSUB67:GOTO29
27 H=R:Z=1:GOSUB67:H=T+1:Z=5:GOSUB67:GOTO31
28 H=L:Z=1:GOSUB67:H=T-1:Z=4:GOSUB67:RS=1:GOTO29
29 IFF(T-1)=2 THENTT=T:T=L:F(L)=1:BU=2:GOSUB48:GOSUB59:GOSUB57:Q=0:T=TT
30 IFRS=1THENRS=0:GOTO32
31 IFF(T+1)=2 THENTT=T:T=R:F(R)=1:BU=2:GOSUB48:GOSUB59:GOSUB57:Q=0:T=TT
32 CA(0)=CA(T)
33 T=T+1:IFT=>29THENT=1
34 IFF(T)=0ORF(T)=2 THEN33
35 MO=1:GOTO7
36 ' The up-arrow key.
37 IFDE=52 THENGOSUB65:GOTO7
38 TT=T:DE=DE+1:T=DE:X=52:Y=16:HPUT(X,Y)-(X+67,Y+44),2
39 GOSUB59:HCOLOR2:HDRAW"S4BM52,16"+A$:T=0:GOSUB57
40 HCOLOR0:HPRINT(9,8),53-DE:HCOLOR2:HPRINT(9,8),52-DE
41 T=TT:Q=0:CA(0)=W:GOTO7
42 ' Draw Screen.
43 A$="R67D44L67U44":MO=1:F(0)=2:POKE59065,57:HSCREEN4:POKE59065,32:HCLS1:HCOLOR2:HDRAW"S4BM20,20"+A$:HGET(20,20)-(87,64),1:HCLS0:HGET(500,20)-(567,64),2
44 T=0:X(0)=52:Y(0)=16:BU=2:GOSUB48:RESTORE:BU=1:FORT=1TO21:F(T)=0:READX(T),Y(T):GOSUB48:NEXT:BU=2:FORT=22TO28:F(T)=1:READX(T),Y(T):GOSUB48:NEXT
45 HCOLOR2:HPRINT(52,1),"PYRAMID":HPRINT(59,3),"BY":HPRINT(61,5),"GEORGE QUELLHORST":HPRINT(10,8),"23":HPRINT(6,9),"CARDS LEFT"
46 Q=0:W=0:T=0:GOSUB59:GOSUB57:Q=0:FORT=22TO28:GOSUB59:GOSUB57:Q=0:NEXT
47 POKE59108,230:HSCREEN4:POKE59108,231:POKE65434,63:RETURN
48 HPUT(X(T),Y(T))-(X(T)+67,Y(T)+44),BU:HCOLOR2:HDRAW"BM"+STR$(X(T))+","+STR$(Y(T))+A$:RETURN
49 Define variables.
50 N$(1)="BR3R3F3D4LU4H3LG3D4LU4E3BL2BD5R7":N$(2)="BRR7FD2GL6GD2R8ULDL8U2ER6EU2HBL6DLU":N$(3)="BRR7FDGFD2GL7HUBRDFBR5EU2HL3BR3EUHBL5GDBLUE":N$(4)="BR4R4D4R2L2D3LU7BL2G4R6BL7E4"
51 N$(5)="BR9L9D3RU3BD3R7FD2GL7HURDFBR5EU2H":N$(6)="BR9L8GD5FR7EU2HL6BLU2EBGBD2BRGD2FR5EU2H":N$(7)="R9DG6LE6UBL7DLU":N$(8)="BRR7FDGFD2GL7HU2EHUEBRGDFR5BL5GD2FBR5EU2HEUH":N$(9)="BRR7FD5GL8BR7EU2BLEU2HBL5GD2FR5BL5BLHU2E"
52 N$(10)="BR2RD7BR2L5BR2U6GLE2BR8R7FD5GL7HU5EBRGD5FBR5EU5H":N$(11)="BR4R5BL2D6GL5HURDFBR3EU6L2":N$(12)="R9D7L9U7BRD7BR7U7D6LF2R2UL2":N$(13)="R2D7LULDRU7LDRBRBD3E4R2GLG4BEF3R2HLH3"
53 C$(1)="BR4R2F3E3R2F4G8L2H8E4BL4":C$(2)="BR7R4FRF5G5LGL4HLH5E5REBR7":C$(3)="BR9RF8G3LH2L2D2FL4EU2L2G2LH3E8RBR":C$(4)="BR9F4G3R2E2RF3G3LH2L2D2FL4EU2L2G2LH3E3RF2R2H3E4BL9":RETURN
54 ' Shuffle the deck.
55 FORT=1TO52:CA(T)=T:NEXT:FORT=1TO52:R=RND(52):S=CA(R):CA(R)=CA(T):CA(T)=S:NEXT:SH=0:AC=CA(29):CA(0)=CA(29):RETURN
56 ' Draw cards on screen.
57 HCOLOR2:HDRAW"S8BM"+STR$(X(T)+16)+","+STR$(Y(T)+14)+C$(Q):HCOLORHC:HDRAW"S4BM"+STR$(X(T)+8)+","+STR$(Y(T)+4)+N$(W):HPAINT(X(T)+34,Y(T)+24),HC,2:RETURN
58 ' Compute suit and value of card.
59 W=CA(T)
60 IFW<=13THENQ=Q+1:GOTO61:ELSEW=W-13:Q=Q+1:GOTO60
61 IFQ<3THENHC=3ELSEHC=2
62 RETURN
63 ' ONBRKGOTO and Quit.
64 RGB:HSCREEN0:CLS3:POKE65496,.:ATTR3,2:POKE41598,3:STOP
65 POKE65496,.:POKE400,20:FORD=1TO10:EXEC:NEXT:POKE65497,.:POKE400,180:RETURN
66 'HPUT & HGET cards on screen.
67 HPUT(X(H),Y(H))-(X(H)+67,Y(H)+44),Z:RETURN
68 HGET(X(H),Y(H))-(X(H)+67,Y(H)+44),Z:RETURN
69 'Check to see if game is over. or won.
70 MO=0:TT=T:FORK=1TO28:IFF(K)=1 THENT=K:GOSUB59:Q=0:TC=W:T=0:GOSUB59:Q=0:EC=W:T=TT ELSE72
71 IFEC-TC=1 OR EC-TC=12 OR TC-EC=1 OR TC-EC=12 THENRETURN
72 NEXTK:GOSUB65:HCOLOR2:HPRINT(12,22),"GAME IS OVER YOU LOST.  PRESS SPACEBAR TO PLAY ANOTHER GAME":HPRINT(14,23),"PRESS DOWN ARROW TO PLAY SAME GAME.  PRESS <Q> TO QUIT"
73 P$=INKEY$:IFP$=" "THENSH=1:GOTO3ELSEIFP$=CHR$(10)THENSH=0:CA(0)=AC:GOTO3ELSEIFP$="Q"THEN64ELSE73
74 HCOLOR3:HPRINT(28,10),"WELL, YOU FINALLY DID IT.":HPRINT(32,12),"YOU WON THE GAME":HPRINT(32,14),"CONGRATULATIONS !":HPRINT(10,20),"PRESS SPACEBAR FOR ANOTHER GAME, DOWN ARROW TO PLAY SAME GAME":HPRINT(32,22),"PRESS <Q> TO QUIT."
75 PLAY"T2L5;O2BAGDO1DO2ABG":GOTO73
