0 ' COPYRIGHT 1989  FALSOFT,INC
10 '''''''''''''''''''''''''''''''''''
20 ' Lunar Lander Graphics Generator '
30 '         By: Jeff Donze          '
40 '         Copyright 1988          '
50 '''''''''''''''''''''''''''''''''''
60 ON BRK GOTO 1020
70 POKE 65497,0
80 HSCREEN 2
90 R=RND(-98765)
100 POKE &HE0D4,&H34
110 PI=3.14159
120 DEF FNR(X)=X/57.29577951
130 DEF FNS(X)=ATN(X/SQR(-X*X+1))
140 DEF FNE(X)=INT(X/2)*2
150 YO=15:XO=40:AO=-90
160 FOR AN=0 TO 10:AO=AO+15
170 YL=200:XL=200:RESTORE:HBUFF AN+1,684
180 READ A$:IF A$="*" THEN 450
190 IF A$="C" THEN READ C:HCOLOR C:GOTO 180
200 IF A$="L" THEN READ X1,Y1:GOSUB 1030:READ X2,Y2:GOSUB 1040:HLINE(X1,Y1)-(X2,Y2),PSET ELSE 230
210 IF X2<XL THEN XL=X2
220 IF Y2<YL THEN YL=Y2
230 IF A$="P" THEN READ X1,Y1,PC,BC:GOSUB 1030:HPAINT(X1,Y1),PC,BC
240 IF A$="-" THEN READ X1,Y1:GOSUB 1030:HLINE-(X1,Y1),PSET
250 IF X1<XL THEN XL=X1
260 IF Y1<YL THEN YL=Y1
270 GOTO 180
280 DATA C,1,L,0,13,3,6,L,1,10,9,11,L,9,13,9,7,L,9,8,14,8
290 DATA L,13,4,15,13,L,13,4,11,4,-,11,5,-,13,5
300 DATA L,8,4,8,5,-,9,5,-,9,4,-,8,4
310 DATA L,10,3,10,2,-,8,2,-,8,1,-,9,1,-,9,2
320 DATA L,6,1,5,1,-,5,0,-,4,0
330 DATA C,2,L,11,13,10,12,L,8,6,9,6,-,10,5,-,10,4,-,9,3,-,8,3
340 DATA C,3,L,5,10,8,10,L,3,9,8,9,L,3,8,8,8,L,4,7,8,7,L,4,6,7,6
350 DATA L,4,5,7,5,L,4,4,7,4,L,4,3,7,3,L,4,2,7,2,L,4,1,4,1
360 DATA L,8,13,5,13,-,6,12,-,8,12,L,10,13,10,13,C,4
370 DATA L,13,3,11,3,-,11,2,-,12,2,-,12,3
380 DATA L,10,11,10,9,-,13,9,-,13,10,-,10,10
390 DATA C,8,L,6,14,4,16,-,4,20,-,8,32,-,12,20,-,12,16,-,10,14,-,6,14
400 DATA P,8,18,8,8
410 DATA C,9,L,7,14,5,16,-,5,20,-,8,28,-,11,20,-,11,16,-,9,14,-,7,14,P,8,18,9,9
420 DATA C,10,L,8,14,6,16,-,6,19,-,8,25,-,10,19,-,10,16,-,8,14,P,8,18,10,10
430 DATA C,11,L,8,15,7,16,-,7,19,-,8,20,-,9,19,-,9,16,-,8,15,P,8,18,11,11
440 DATA L,8,15,8,20,*
450 HGET(FNE(XL),YL)-(FNE(XL)+35,YL+35),AN+1
460 HCLS:NEXT AN
470 ' Saturn
480 HCLS
490 POKE &HE0D4,&H37:LPOKE &H6E000,&HFF:LPOKE&H6E001,&HFF
500 HBUFF 1,1620
510 C(1,1)=0:C(1,2)=7:C(2,1)=7:C(2,2)=6
520 FOR RA=PI/2 TO 3*PI/2 STEP PI/90
530 IF RND(0)>.8 THEN HSET(100+COS(RA)*19,100+SIN(RA)*17,7)
540 NEXT RA
550 FOR R=6 TO 19 STEP 1.1:H=17
560 F=(R-5)/7:W=INT(F):F=F-W
570 FOR RA=PI/2 TO 3*PI/2 STEP PI/90
580 HSET (100-COS(RA)*R,100+SIN(RA)*H,C(W+1,1-(RND(0)<F)))
590 NEXT RA,R
600 A=0:FOR R=34 TO 42
610 HCIRCLE (100,100),R,6,.14,.85-A,.68
620 A=A+.0015:NEXT R
630 HCIRCLE (100,100),R,7,.15,.85-A,.69
640 HDRAW "C0BM82,95NR5DNR5DR5"
650 HGET (56,82)-(144,117),1
660 ' Mars
670 HCLS:HBUFF 2,1800
680 FOR RA=PI/2 TO 3*PI/2 STEP PI/90
690 IF RND(0)>.7 THEN HSET(160+COS(RA)*29,100+SIN(RA)*29,7)
700 NEXT RA:FOR R=2 TO 29
710 F=R/15:W=INT(F):F=F-W
720 FOR RA=PI/2 TO 3*PI/2 STEP PI/110
730 HSET (160-COS(RA)*R,100+SIN(RA)*29,C(W+1,1-(RND(0)<F)))
740 NEXT RA,R:HGET (130,70)-(188,129),2
750 ' Earth
760 HCLS:HBUFF 3,3200
770 FOR C=3 TO 1 STEP -1:READ D$,E$,R1,R2
780 HCIRCLE (300,100),41,C:HDRAW "BM300,60XD$;BM300,140XE$;"
790 HCIRCLE (285,90),R1,C,1.1:HPAINT (285,90),C,C
800 HCIRCLE (270,111),R2,C,.9:HPAINT (270,111),C,C
810 HPAINT (298,65),C,C:HPAINT (298,138),C,C:NEXT C
820 HCIRCLE (300,100),41,0
830 DATA "C3D18L15M-10,-4H4","U20L18M-10,+6",14,16
840 DATA "C2D15L15M-8,-3H2","U18L16M-11,+6",12,14
850 DATA "C1D13L14M-8,-5","U15L15M-10,+5",10,12
860 C(1,1)=0:C(1,2)=5:C(2,1)=5:C(2,2)=4
870 FOR RA=PI/2 TO 3*PI/2 STEP PI/45
880 IF RND(0)>.65 THEN HSET(160+COS(RA)*40,100+SIN(RA)*40,6-RND(2))
890 NEXT RA:H=40:FOR R=0 TO 40
900 F=R/41*2:W=INT(F):F=F-W:P=R/40
910 FOR RA=PI/2 TO 3*PI/2 STEP PI/127
920 XO=COS(RA)*R:YO=SIN(RA)*H
930 C=HPOINT(300+XO,100+YO)
940 IF C=0 OR RND(0)>P OR RND(0)>(4-C)/3 THEN C=C(W+1,1-(RND(0)<F)) ELSE C=1
950 HSET (160-XO,100+YO,C)
960 NEXT RA,R:HGET(120,60)-(198,139),3:POKE &HE0D4,&H34
970 POKE &HFFA2,&H34:POKE 65496,0
980 SAVEM "LANDER1",&H4000,&H5FFF,&HA027
990 POKE &HFFA2,&H37
1000 SAVEM "LANDER2",&H4000,&H5FFF,&HA027
1010 CLS:PRINT"DONE."
1020 POKE &HFFA2,&H3A:POKE 65496,0:END
1030 X2=X1:Y2=Y1:GOSUB1040:X1=X2:Y1=Y2:RETURN
1040 X2=X2-8:Y2=Y2-7:R=SQR(X2*X2+Y2*Y2)
1050 IF Y2<0 THEN A=FNS(-X2/R)+PI:GOTO 1080
1060 IF Y2>0 THEN A=FNS(X2/R):GOTO 1080
1070 IF X2>0 THEN A=FNR(90) ELSE IF X2<0 THEN A=FNR(270)
1080 A=A+FNR(AO):X2=XO+SIN(A)*R:Y2=YO+COS(A)*R:RETURN
