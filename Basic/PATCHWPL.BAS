6 SS=1:SF=1:FC=1:CD=7
50 IFQ=1 AND Z<>U AND L+4>W-1THENFL=1:GOTO175
62 IFSCI=1THEN960ELSEIFSCI=2 AND KS=1THEN2020ELSEIFSCI=2THEN2030
95 IFK=32THENZ=L+S:IFL+8<W THENLINE(L,T)-(L+7,T+D),PRESET,BF:L=L+S:GOTO45ELSELINE(L,T)-(L+1,T+D),PRESET,BF:L=U:IFT<P AND T<191-D*2THENT=T+1+D:GOTO45ELSEFL=0:GOTO2080
110 IFK=8THENLINE(L,T)-(L+1,T+D),PRESET,BF:IFL>1THENL=L-2:GOTO45ELSEL=0:GOTO45
151 IFK=95THENI=4:PUT(L,T)-(L+1,T+D),S:IFL>W*.5THENGET(U,T)-(W-I-1,T+D),G,G:PUT(U+I,T)-(W-1,T+D),G,PSETELSEGET(U+I,T)-(W-1,T+D),G,G:PUT(U,T)-(W-1-I,T+D),G,PSET
155 IFK<>95THENPUT(L,T)-(L+1,T+D),S:GOTO45ELSE45
165 IFQ=0 OR Z=U THENL=U:IFT<P AND T<191-D*2THENT=T+D+1:GOTO70ELSE70
170 FL=2
175 Z1=2*INT(.5*Z):Z=Z1
180 GET(Z,T)-(L,T+D),G,G:GOSUB197:L1=L-Z:L=U:Z=U:IFT<P AND T<191-D*2THENT=T+D+1ELSE2080
190 IFSCI<>2THENPUT(L,T)-(L+L1,T+D),G,PSET:L=L+L1+L2:L=2*INT(.5*L+.5):L2=0ELSEL=U:GOSUB2400:KS=KS+1:GOTO2030
193 N=FL+1:ON N GOTO45,55,70
197 IFCC=0THENPUT(Z,T)-(L,T+D),R,PSET:RETURNELSEPUT(Z,T)-(L,T+D),R,PRESET:RETURN
198 IFCC=0THENPUT(U,T)-(W-1,T+D),R,PSET:RETURNELSEPUT(U,T)-(W-1,T+D),R,PRESET:RETURN
199 IFCC=0THENPUT(18,20)-(113,170),R,PSET:RETURNELSEPUT(18,20)-(113,170),R,PRESET:RETURN
230 IFK$="I" OR K$="i"THEN3060
340 SCREEN1,C
341 DRAW"S"+STR$(4*SF)
342 GET(L,T)-(L+1,T+D),S:POKE&HFFD7,0:GOTO45
345 SCREEN1,C:GET(18,20)-(113,170),F,G:GOSUB199
355 Y=10:OPEN"I",#1,"FONTMENU"
365 FORI=0TO9:GOSUB440:LINEINPUT#1,A$:Y=Y+16:DRAW"S4BM24,"+STR$(Y)+A$:NEXT:CLOSE#1
490 CLS:PRINT@195,"DO YOU WANT TO CHANGE THE":PRINT"   BOTTOM MARGIN? (Y/N) ";
491 K$=INKEY$:IFK$=""THEN491ELSEIFK$="N" OR K$="n"THENL=U:T=V:RETURNELSEIFK$="Y" OR K$="y"THEN492ELSESOUND60,5:GOTO491
492 PRINT@323,"DO YOU WANT IT AT THE MOST":PRINT"   RECENT CURSOR POSITION?":PRINT"    (Y/N)":PRINT"   IF NOT, IT WILL BE SET TO":PRINT"   THE LOWEST POSSIBLE CURSOR":PRINT"   POSITION":IFV$="B" OR V$="b"THENGOSUB980
493 K$=INKEY$:IFK$=""THEN493ELSEIFK$="N" OR K$="n"THENGOSUB980:GOTO495ELSEIFK$="Y" OR K$="y"THENP=T:L=U:T=V:RETURNELSESOUND60,5:GOTO493
495 P=V+(D+1)*(-1+INT((192-V)/(D+1))):RETURN
551 PRINT" SHIFT ";CHR$(94);": MOVE CHAR-LINE TOWARD":PRINT"          CURSOR HALF OF SCREEN":PRINT
960 POKE&H23,A1:POKE&H24,A2:IFKS<=LEN(AC$)THENK$=MID$(AC$,KS,1):KS=KS+1:GOSUB970:GOTO70ELSESCI=0:PUT(L,T)-(L+1,T+D),S:U=UT:GOTO45
970 IFASC(K$)=94THENK$=CHR$(13):RETURNELSERETURN
980 V=192-(D+1)*INT(192/(D+1)):T=V:RETURN
2020 POKE&HFFD6,0:IFEOF(1)=-1THENCLOSE#1:POKE&HFFD7,0:SCI=0:PUT(L,T)-(L+1,T+D),S:U=UT:GOTO45ELSEGOSUB445:LINEINPUT#1,SK$:POKE&HFFD7,0
2025 IFSK=0THENSCI=0:U=UT:GOTO2200
2030 POKE&H23,A1:POKE&H24,A2:IFKS<=LEN(SK$)THENK$=MID$(SK$,KS,1)ELSE2100
2032 IFASC(K$)=91THENK$=CHR$(13):RS=1
2035 IFL>U AND KS=1 AND K$=" "THENPUT(L,T)-(L+1,T+D),S:L=U:IFT<P AND T<191-2*D THENT=T+1+D ELSESK=0:GOTO2025
2040 KS=KS+1:GOTO70
2080 IFSCI<>2THEN193ELSESK=0:GOTO2025
2100 IFSK$=""THENPUT(L,T)-(L+1,T+D),S:L=U ELSEKS=1:IFRS=1THENRS=0:GOTO2020ELSEIFL+S+8>W THEN3100ELSEK$=" ":GOTO70
2110 IFT<P AND T<191-2*D THENT=T+1+D:GOTO70ELSESK=0:GOTO2025
2200 T=V:CLS:PRINT@195,"SAVE REST OF ";FA$;":";ZA$:PRINT"   FOR LATER INPUT?   (Y/N)  ";
2220 K$=INKEY$:IFK$=""THEN2220
2230 IFK$="N" OR K$="n"THENCLOSE#1:GOTO280
2240 IFK$="Y" OR K$="y"THENPRINT@386,"THE REST WILL BE SAVED IN THE   FILE CALLED REST:";ZA$
2300 IFFA$="REST"THENRE$="TEMP"ELSERE$="REST
2301 POKE&HFFD6,0:OPEN"O",#2,RE$+":"+ZA$
2305 GOSUB2400:IFKS>=LEN(SK$)THEN2310
2307 PRINT#2,RIGHT$(SK$,LEN(SK$)-KS)
2310 IFEOF(1)=-1THENCLOSE#1:CLOSE#2:GOTO2330
2320 GOSUB445:LINEINPUT#1,SK$:PRINT#2,SK$:GOTO2310
2330 IFRE$="TEMP"THENKILL"REST/DAT:"+ZA$:RENAME"TEMP/DAT:"+ZA$ TO"REST/DAT:"+ZA$
2340 GOTO280
2400 KS=KS-1:IFKS=0THENRETURNELSEIFMID$(SK$,KS,1)<>" "THEN2400ELSERETURN
3040 GOSUB440:SK=6:KS=1:SCI=2:CLS:PRINT@200,"FILENAME: ";:LINEINPUTFA$:Z$=RIGHT$(FA$,2):ZA$="0":IFASC(Z$)=58THENZA$=RIGHT$(Z$,1):FA$=LEFT$(FA$,LEN(FA$)-2)
3050 POKE&HFFD6,0:OPEN"I",#1,FA$+":"+ZA$:RETURN
3060 GOSUB440:CLS:PRINT@200,"1: SCREEN FILE":PRINT@232,"2: ASCII FILE"
3070 K$=INKEY$:IFK$=""THEN3070ELSEIFK$="1"THENGOSUB20:GOTO200ELSEIFK$="2"THEN3080ELSESOUND60,5:GOTO200
3080 Q=1:UT=U:GOSUB3040:GOTO280
3100 PUT(L,T)-(L+1,T+D),S:L=U:IFT<P AND T<191-2*D THENT=T+D+1:GOTO2020ELSESK$="":GOTO2110
3600 CLOSE#1:FORI=0TO3000:NEXT:GOTO200
