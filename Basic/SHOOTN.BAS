10 '
20 '       Shoot'n Range
30 '     copyright (c) 1987
40 '            by
50 '       Albert  Marsh
60 '
70 POKE 65497,0
80 ON BRK GOTO 1850:ON ERR GOTO 1780
90 PALETTE 0,11:PALETTE 1,63
100 HSCREEN 2:HCLS 0
110 HCOLOR 1:HPRINT(2,12),"ARE YOU USING 1-RGB OR 2-COMPOSITE?"
120 I$=INKEY$:IF I$="1" THEN MN=1 ELSE IF I$="2" THEN MN=2 ELSE 110
130 GOSUB 880' SET-UP
140 PALETTE RGB:GOSUB 940' HGET EVERTHING
150 GOSUB 1150' TITLE CARD
160 GOSUB 1240' DRAW SCREEN
170 PRC$="1.00":SC=0:PO=5000:HI=1:AL=1:T=0:M=2:TT=2:F=50:R=1:PI=5000
180 PALETTE CMP:ON BRK GOTO 1680
190 GOSUB 1540' SET LEVEL
200 ' MAIN LOOP
210 JA=INT((JOYSTK(0)*5)/2)*2:JB=JOYSTK(1)*2
220 HPUT(316,JB+40)-(320,JB+40),1,NOT
230 IF JA<>X THEN HPUT(X,175)-(X+3,189),1,PSET:X=JA:HPUT(X,175)-(X+3,189),8,PSET
240 IF BUTTON(0)=1 OR BUTTON(1)=1 THEN IF PO>0 THEN GOSUB 330
250 IF NU>0 THEN FOR G=1 TO NU:T(G)=T(G)-1:IF T(G)=0 THEN GOSUB 780:NEXT G ELSE NEXT G
260 IF NU<M AND TNO<TT THEN IF RND(F)=1 THEN GOSUB 640:TNO=TNO+1
270 HPUT(316,JB+40)-(320,JB+40),1,NOT
280 IF NU=0 AND TNO=>TT THEN 300
290 GOTO 210
300 GOSUB 1370' ADVANCE LEVEL
310 GOTO 210
320 ' FIRE SHOT
330 FL=0:HCOLOR 0,2
340 FOR G=1 TO NU
350 IF X>X(G) AND X<X(G)+15 THEN IF JB+40<Y(G)+20 THEN FL=1:FP=G
360 NEXT G
370 IF FL=1 THEN Y=Y(FP) ELSE Y=JB+40
380 HGET(X,174)-(X,Y),9
390 HLINE(X,174)-(X,Y),PSET
400 PLAY"L255T255O3V15;1;V-;2;V-;3;V-;4;V-;5;V-;6;V-;7;V-;8;V-;9;V-;10;V-;11;V-;12"
410 HPUT(X,174)-(X,Y),9,PSET
420 HCOLOR 5:HPRINT(32,0),PO
430 PO=PO-(128-JB):IF PO<0 THEN PO=0
440 HCOLOR 0:HPRINT(32,0),PO
450 IF FL=0 THEN RETURN
460 ' HIT TARGET
470 HPUT(X(FP),Y(FP))-(X(FP)+15,Y(FP)+16),7,PSET
480 PLAY"L255T255O1V20AV-AV-AV-AV-AV-AV-AV-AV-AV-AV-AV-AV-AV-AV-AV-AV-AV-AV-AV-A"
490 FOR G=Y(FP) TO Y(FP)+16
500 HPUT(X(FP),G)-(X(FP)+15,Y(FP)+16),7,PSET
510 NEXT G
520 FOR G=FP TO NU
530 X(G)=X(G+1):Y(G)=Y(G+1):T(G)=T(G+1)
540 NEXT G
550 HI=HI+1:NU=NU-1
560 HCOLOR5:HPRINT(8,0),SC
570 HPRINT(21,0),PRC$
580 SC=SC+100
590 IF HI/TT=1 THEN PRC$="1.00" ELSE PRC$=LEFT$(STR$(HI/TT),4)
600 HCOLOR0:HPRINT(8,0),SC
610 HPRINT(21,0),PRC$
620 RETURN
630 ' ADD TARGET TO SCREEN
640 NU=NU+1
650 FL=0:X(NU)=INT((RND(290)+10)/2)*2:Y(NU)=RND(100)+40
660 IF NU<2 THEN 710
670 FOR G=1 TO NU-1
680 IF INT(X(NU)/20)=INT(X(G)/20) AND INT(Y(NU)/20)=INT(Y(G)/20) THEN FL=1
690 NEXT G
700 IF FL=1 THEN 650
710 PLAY"L255T255O3V0":P=0
720 FOR G=Y(NU)+16 TO Y(NU) STEP -1
730 HPUT(X(NU),G)-(X(NU)+15,Y(NU)+16),6,PSET
740 P=P+1:P$="V"+STR$(P)+"A":PLAY P$
750 NEXT G
760 T(NU)=T+RND(10):RETURN
770 ' TAKE TARGET FROM SCREEN
780 PLAY"L255T255O3V17":P=17
790 FOR Q=Y(G) TO Y(G)+16
800 HPUT(X(G),Q)-(X(G)+15,Y(G)+16),6,PSET
810 P=P-1:P$="V"+STR$(P)+"D":PLAY P$
820 NEXT Q
830 FOR Q=G TO NU
840 X(Q)=X(Q+1):Y(Q)=Y(Q+1):T(Q)=T(Q+1)
850 NEXT Q
860 NU=NU-1:RETURN
870 ' SET VARIBLES AND PALETTE
880 DIM X(16),Y(16),T(16)
890 P$(1)="6316180756080925370454544835000000000000000000000000000000000"
900 P$(2)="6302331632112743000300351906000000000000000000000000000000000"
910 P$=P$(MN):GOSUB 1630:PALETTE 15,0
920 RETURN
930 ' HGET EVERYTHING
940 HCLS 1:HBUFF 1,220:HGET(1,1)-(20,20),1
950 HCLS 2:HBUFF 2,220:HGET(1,1)-(20,20),2
960 HCLS 5:HBUFF 3,110:HGET(1,1)-(20,10),3
970 HCLS 6:HBUFF 4,110:HGET(1,1)-(20,10),4
980 HCLS 7:HBUFF 5,110:HGET(1,1)-(20,10),5
990 HCLS 2:HCOLOR 11:HLINE(0,1)-(15,16),PSET,BF
1000 HCOLOR 6:HCIRCLE(3,4),3:HCIRCLE(12,4),3
1010 HPAINT(3,4),0,6:HPAINT(12,4),0,6
1020 HCOLOR 9:HCIRCLE(7,10),5,,.75,0,.5
1030 HBUFF 6,200:HGET(0,0)-(15,16),6
1040 HCOLOR 12:HLINE(0,1)-(15,16),PSET,BF
1050 HCOLOR 6:HCIRCLE(3,4),3:HCIRCLE(12,4),3
1060 HPAINT(3,4),15,6:HPAINT(12,4),15,6
1070 HCOLOR 9:HCIRCLE(7,12),5,,.75,.5,0
1080 HBUFF 7,200:HGET(0,0)-(15,16),7
1090 HCLS 1:HCOLOR 3:HLINE(4,1)-(4,15),PSET
1100 HCOLOR 4:HLINE(5,5)-(5,15),PSET
1110 HCOLOR 9:HLINE(6,10)-(6,14),PSET:HLINE(7,11)-(7,14),PSET
1120 HBUFF 8,300:HGET(4,1)-(7,15),8
1130 HBUFF 9,400:RETURN
1140 ' TITLE SCREEN
1150 WIDTH 40:CLS 7
1160 LOCATE 0,3:ATTR 0,4
1170 READ I$:IF I$="999" THEN 1200
1180 L=40-LEN(I$):L=INT(L/2)
1190 PRINT TAB(L);I$:GOTO 1170
1200 ATTR 6,6:LOCATE 39,23:PALETTE CMP
1210 IF INKEY$="" THEN 1210
1220 PALETTE RGB:RETURN
1230 ' DRAW SCREEN
1240 HSCREEN 2:HCLS2
1250 FOR G=0 TO 320 STEP 20
1260 HPUT(G,0)-(G+19,10),3,PSET
1270 HPUT(G,11)-(G+19,21),4,PSET
1280 HPUT(G,22)-(G+19,32),5,PSET
1290 NEXT G
1300 HDRAW"C3;BM319,32;M0,32;M80,12;M160,30;M240,12;M319,32":HPAINT(80,20),3,3
1310 HDRAW"C4;BM80,32;M240,32;M160,12;M80,32":HPAINT(160,20),4,4
1320 HCOLOR0:HLINE(0,171)-(320,171),PSET
1330 FOR G=0 TO 320 STEP 20:HPUT(G,172)-(G+20,192),1,PSET:NEXT G
1340 HPRINT(3,0),"SCORE 0       PRC 1.00  POWER 5000"
1350 RETURN
1360 ' LEVEL ADVANCE
1370 HCOLOR 5:HPRINT(8,0),SC
1380 PB=INT((HI/TT)*500):SC=SC+PB
1390 HCOLOR 0:HPRINT(8,0),SC
1400 HCOLOR15:PB$=STR$(PB)+"pts."
1410 HPRINT(7,11),"POINTS BONUS-  "+PB$
1420 R=R+1:IF INT(R/10)<>R/10 THEN 1500
1430 HCOLOR 15:HPRINT(7,13),"POWER BONUS - "+STR$(PI)+" units"
1440 HCOLOR 5:HPRINT(32,0),PO:PO=PO+PI
1450 HCOLOR 0:HPRINT(32,0),PO
1460 PI=PI+2000
1470 FOR G=1 TO 10
1480 PLAY"L255T255V20O2;A;V+;B;V+;C;V+;D;V-;E;V-;F;V-;E;V+;F;V+;G"
1490 NEXT G
1500 FOR G=1 TO 500:NEXT G
1510 FOR G=40 TO 280 STEP 8
1520 HPUT(G,88)-(G+8,112),2,PSET:NEXT G
1530 IF HI/TT <.5 OR PO=0 THEN 1730
1540 NU=0:T=T-10:IF T<10 THEN T=55:TT=TT+2:M=M+2:IF M>10 THEN M=10
1550 F=F-1:IF F<5 THEN F=5
1560 HCOLOR 10:HPRINT(15,3),"ROUND":HPRINT(20,3),R
1570 FOR Q=1 TO M:GOSUB 640:NEXT Q
1580 FOR G=1 TO 200:NEXT G
1590 HCOLOR4:HPRINT(15,3),"ROUND":HPRINT(20,3),R
1600 TNO=M:HI=0:JA=X
1610 RETURN
1620 ' PALETTE SET-UP
1630 FOR G=0 TO 31
1640 P=VAL(MID$(P$,(G*2)+1,2))
1650 POKE G+58964,P
1660 NEXT G:RETURN
1670 ' PROGRAM ABORTED
1680 FOR G=32 TO 288 STEP 10:HPUT(G,88)-(G+10,112),2,PSET:NEXT G
1690 HCOLOR15:HPRINT(11,11),"-PROGRAM ABORTED-":HPRINT(4,13),"WOULD YOU LIKE TO RESTART(Y/N)?"
1700 ON BRK GOTO 1710
1710 I$=INKEY$:IF I$="Y" THEN PALETTE RGB:GOTO 160 ELSE IF I$="N" THEN 1850 ELSE 1710
1720 ' GAME OVER
1730 HCOLOR15:HPRINT(15,11),"GAME  OVER"
1740 HPRINT(3,13),"WOULD YOU LIKE TO PLAY AGAIN(Y/N)?"
1750 ON BRK GOTO 1760
1760 I$=INKEY$:IF I$="Y" THEN PALETTE RGB:GOTO 160 ELSE IF I$="N" THEN 1850 ELSE 1760
1770 ' ON ERR COMES HERE
1780 P$="1836110763310938001800630018003818540936632745380018006300180038"
1790 GOSUB 1630:PALETTE 15,38
1800 IF MN=1 THEN PALETTE RGB ELSE PALETTE CMP
1810 WIDTH 32:CLS
1820 PRINT "ERROR NUMBER - ";ERNO:PRINT "ERROR LINE - ";ERLIN
1830 POKE 65496,0:END
1840 ' END OF PROGRAM
1850 P$="1836110763310938001800630018003818540936632745380018006300180038"
1860 GOSUB 1630:PALETTE 15,38
1870 IF MN=1 THEN PALETTE RGB ELSE PALETTE CMP:WIDTH 32
1880 CLS1:POKE65496,0:END
1890 ' INSTRUCTIONS FOR TITLE
1900 '         SCREEN
1910 DATA SHOOT'N RANGE  by Albert Marsh
1920 DATA " "
1930 DATA " "
1940 DATA Welcome to the Shoot'n Range
1950 DATA " "
1960 DATA There are only a few short rules to
1970 DATA remember
1980 DATA " "
1990 DATA Use the right controller to play
2000 DATA " "
2010 DATA Use either button to fire
2020 DATA " "
2030 DATA You must keep your percentile above
2040 DATA 50% to continue playing
2050 DATA " "
2060 DATA You play untill your power runs out
2070 DATA " "
2080 DATA Press any key to start
2090 DATA 999
