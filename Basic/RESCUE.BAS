0 '******* LUNAR RESCUE *******
1 GOTO3
2 GOTO5
3 PCLEAR8:GOTO2
5 CLEAR500,&H7C83:CLS:INPUT"WHICH VERSION COLOR COMPUTER ARE YOU USING (1,2,OR 3)";C:IF C=3 THEN SP=65497:WIDTH32 ELSE INPUT"CAN YOUR COMPUTER USE THE       'SPEED-UP' POKE (Y/N)";P$:IF P$="Y" THEN SP=65495 ELSE SP=0
6 CLS:PRINT@108,"LUNAR":PRINT@144,"RESCUE":PRINT@239,"BY":PRINT@330,"CLYDE JOHNSON":PRINT@485,"PLEASE WAIT ONE MOMENT";
10 IF SP THEN POKE SP,0
20 X=RND(-TIMER)
25 FOR X=&H7C84 TO &H7FFE:READ P:POKEX,P:NEXT:EXEC&H7C84
27 GOSUB 6000
30 DIM V(24,16),C(24,16)
40 GOSUB7000:PMODE4,1:PCLS0
45 PRINT@0,"";
46 PRINT TAB(4)"CHOOSE SKILL LEVEL WITH":PRINTTAB(7)"RIGHT JOYSTICK AND":PRINTTAB(10)"PRESS 'FIRE'":PRINTTAB(12)"TO BEGIN"
47 SCREEN1,1
49 PRINT@203,"          "
50 L=INT(JOYSTK(0)/6.4)+1:PRINT@203,"LEVEL ";L
60 IF PEEK(&HFF00) AND 1 THEN 50
61 SCR=0
62 IF (PEEK(&HFF00) AND 1)-1 THEN 62
65 IF L>1 THEN BO=1 ELSE BO=0
70 Y3=RND(20)+10*L:Y4=RND(20)+10*L
80 A$="D3R3NU3L3":L$="C0":M$="C1":FOR X=1 TO 5:L$=L$+A$:M$=M$+A$:NEXT
90 ZZ=JOYSTK(0):IF JOYSTK(1)>35 THEN PRINT@262,"MOVE JOYSTICK TO TOP"
100 ZZ=JOYSTK(0):IF JOYSTK(1)>35 THEN 100
110 PRINT @262,"ONE MOMENT PLEASE..."
120 GOSUB7000
130 P$="L255;O1V31BV30FV29DV28GV27EV25CV23FV21CV19GV17BV15;L210;02;D#V13C#V11F#V9DV7AV5BV3EV1G"
140 PMODE4,1:COLOR0,1:PCLS
150 GET(7,5)-(23,16),C,G
160 DRAW"BM7,16;R2E2R4D2R2L4R2U2R4F2R2L2H2E2U2L12D2F2H2U2R3H2U1E2R6F2D1G2"
170 GET(7,5)-(23,16),V,G
180 PCLS:LINE(0,0)-(255,191),PSET,B:LINE(0,169)-(255,191),PSET,BF:X1=1:Y1=153:PRINT@448,"ALTITUDE","VELOCITY ","FUEL":PRINT@457,0;:PRINT@473,0;
190 YF=70+RND(21)*5:YC=YF+15
195 Y=RND(40)
200 LINE(0,168)-(35,168),PSET:LINE(220,168)-(255,168),PSET:DRAW"BM25,168":FOR X=65 TO 205 STEP 5
205 Y=Y+RND(30)*(RND(4)-2):IF Y<1 THEN Y=1 ELSE IF Y>120 THEN Y=120:Y=Y-RND(20)
210 IF X=YF+5 OR X=YF+10 OR X=YF+15 OR X=YF+20 OR X=YF+25 THEN Y=RND(5) ELSE IF X=YF THEN Y=Y3 ELSE IF X=YF+30 THEN Y=Y4
220 IF X=YF+15 THEN YM=Y
230 XM=X:IF X=YF+5 THEN XM=XM+RND(2) ELSE IF X=YF+25 THEN XM=XM-RND(2)
240 LINE-(XM,167-Y),PSET
250 NEXT
260 LINE-(230,168),PSET
270 DRAW"BM=YC;,"+STR$(167-YM)+";BL3E3NF3U2NR2NL2U2NR1NL1U1"
280 PAINT(128,167),0,0
290 SCREEN1,1
300 S=29:T=.7:M=100:G=1.635:X=1:FUEL=(10-L)*500+7500:FM=FUEL:Y=0:V=0:GH=0:TM=0:T2=0:Q=0:ML=1:LU=1
310 PRINT@489,INT(FUEL);
320 PUT(&H1,&H9D)-(&H11,&HA8),V,PSET
330 ZZ=JOYSTK(0):IF JOYSTK(1)<35 THEN 330 ELSE LINE(1,168)-(12,170),PRESET:LINE-(25,168),PRESET:LINE(1,168)-(24,168),PRESET:LINE(5,169)-(20,169),PRESET:S=30
340 PUT(1,157)-(17,168),C,PSET
350 ZZ=&H17-JOYSTK(&H0):ZZ=INT(ZZ*ABS(ZZ)/-330.75):F=31.5-JOYSTK(&H1):F=F*ABS(F)/-&H2:F=F*((F<&H0)+&H1)
360 IF ML AND LU THEN IF PEEK(&HFF00)AND &H1 THEN370ELSE TI=1:TIMER=0:PRINT@496,"TIME";:LU=0
370 FUEL=(FUEL-ABS(F/&H5)*T):FUEL=FUEL*((FUEL<&H0)+&H1):F=F*((FUEL<=&H0)+&H1)
380 IF FUEL THEN IF ZZ THEN FUEL=FUEL-&H3*ABS(ZZ):X=X+ZZ:IF X<&H1 THEN X=&H1 ELSE IF X>&HED THEN X=&H1
390 A=F/M:V=V-A*T+G*T:S=S-V*T:IF S<&H1D THEN 550
400 PRINT@&H1C9,INT(S-&H1D);:PRINT@&H1D9,INT(V):PRINT@&H1E9,INT(FUEL)
410 Y=&HA6-S*(&HA6/&H1F4):IFY<&H0 THENY=&H0
420 IF Y1>=&H1 THEN PUT(X1,Y1)-(X1+&H10,Y1+&HB),C,PSET:IF TI THEN DRAW"BM"+STR$(INT(X1)+&H7)+","+STR$(INT(Y1)+&HA)+";XM$;"
430 IF Y<&H1 THEN 470
440 IF PPOINT(X,Y+&HB)=&H0 OR PPOINT(X+&H9,Y+&HB)=&H0 OR PPOINT(X+&H10,Y+&HB)=&H0 THEN 490
450 PUT(X,Y)-(X+&H10,Y+&HB),V,PSET:IF TI THEN DRAW"BM"+STR$(INT(X)+&H7)+","+STR$(INT(Y)+&HA)+";XL$;"
460 IF ML THEN DRAW"BM=YC;,"+STR$(&HA7-YM)+";BL3E3NF3U2NR2NL2U2NR1NL1U1"
470 IF TI THEN GOSUB 1000
480 X1=X:Y1=Y:GOTO 350
490 GOTO3000
500 GOSUB 4000:PRINT@0,"YOU CRASHED..."
520 PRINT"TOTAL SCORE ";SCR
530 PRINT" PRESS FIRE BUTTON TO TRY AGAIN "
540 IF PEEK(&HFF00) AND 1 THEN 540
545 IF (PEEK(&HFF00) AND 1)-1 THEN 545 ELSE 40
550 IF X<220 THEN 490
555 IF S<29 THEN S=29
560 PRINT@457,INT(S-29);:PRINT@473,INT(V):PRINT@457+32,INT(FUEL)
570 V=INT(V)
580 IF V<=1 THEN PRINT@0,"PERFECT LANDING":GOTO2000
590 IF V<=5 THEN PRINT@0,"GOOD LANDING":GOTO2000
600 IF V<=9 THEN PRINT@0,"HARD LANDING":GOTO2000
610 GOSUB4000:PRINT@0,"YOU'RE DEAD":GOTO520
1000 IF TIMER/&H3C>&H1E THEN TI=0:PRINT@&H1F0,STRING$(&H10," ");:DRAW"BM"+STR$(INT(X)+&H7)+","+STR$(INT(Y)+&HA)+";"+M$+"C0":RETURN ELSE PRINT@&H1F5,INT((&H1E-TIMER/&H3C)*&HA)/&HA;"   ";
1010 IF X<YF+&H5 OR X>YF+&H1A THEN RETURN
1020 IF Y+&H18<(&HA7-YM) THEN RETURN ELSE TM=TM+&H1:IF TM >L THEN T2=&H1E-TIMER/&H3C:PRINT@&H1F0,STRING$(&H10," ");:PRINT@&H1F0,"GOT HIM";:GH=1:M=175:ML=0:TI=0 ELSE RETURN
1030 DRAW"BM"+STR$(INT(X)+7)+","+STR$(INT(Y)+10)+";"+M$
1040 DRAW"BM=YC;,"+STR$(167-YM)+";C1BL3E3NF3U2NR2NL2U2NR1NL1U1"
1050 RETURN
2000 ST=INT(250*T2+12000+FUEL-FM+(9-V)*500+2000*L)*GH:IF ST THEN BN=25000*BO*(L-1):BO=0 ELSE ST=-10000
2010 PRINT"PERFORMANCE SCORE ";ST
2020 IF BN THEN PRINT"***BONUS*** ";BN:ST=ST+BN:BN=0
2030 SCR=SCR+ST
2040 PRINT "TOTAL ";SCR
2050 IF GH THEN L=L+1:IF L>10 THEN L=10
2060 PRINT "LEVEL ";L
2070 FOR DL=1 TO 5000:NEXT:GOTO 70
3000 IF ML AND X>=YF+4 AND X<=YF+27 AND Y+24>(167-YM) THEN PRINT@496,"YOU KILLED HIM";:TI=0:DRAW"C1BM=YC;,"+STR$(167-YM)+";BL3E3NF3U2NR2NL2U2NR1NL1U1":ML=0:GOTO 450 ELSE GOTO 500
4000 IF SP THEN POKESP-1,0
4010 PLAY P$:IF SP THEN POKE SP,0
4020 FOR RA=1 TO 31 STEP 2:CIRCLE(X+8,Y+6),RA,0:NEXT:FOR RA=31 TO 1 STEP -2:CIRCLE(X+8,Y+6),RA,1:NEXT
4030 RETURN
5000 DATA 109,140,49,38,27,108,140,44,190,1
5010 DATA 104,175,140,39,48,140,104,191,1,104
5020 DATA 190,1,155,175,140,30,48,140,29,191
5030 DATA 1,155,57,109,140,16,39,250,111,140
5040 DATA 11,174,140,9,191,1,104,174,140,6
5050 DATA 32,233,0,130,115,0,130,185,52,7
5060 DATA 246,1,85,134,247,183,255,2,182,255
5070 DATA 0,138,128,129,247,39,4,202,8,32
5080 DATA 2,196,247,247,1,85,246,1,86,134
5090 DATA 239,183,255,2,182,255,0,138,128,129
5100 DATA 247,39,4,202,8,32,2,196,247,247
5110 DATA 1,86,53,7,50,98,28,175,126,173
5120 DATA 165,52,54,129,8,16,39,0,153,18
5130 DATA 18,18,18,18,18,18,18,18,18,18
5140 DATA 18,18,18,198,45,49,141,0,147,161
5150 DATA 160,39,48,49,39,90,38,247,198,36
5160 DATA 161,160,39,7,49,37,90,38,247,53
5170 DATA 182,141,34,198,1,231,141,0,57,198
5180 DATA 57,231,141,0,91,23,2,173,18,231
5190 DATA 141,0,43,198,167,231,141,0,77,32
5200 DATA 224,141,4,141,30,32,218,220,136,52
5210 DATA 4,68,86,84,84,84,84,134,12,61
5220 DATA 134,32,61,31,1,53,4,196,31,58
5230 DATA 220,188,48,139,57,198,3,79,18,18
5240 DATA 18,18,18,18,18,18,18,167,132,48
5250 DATA 136,32,90,38,248,198,7,166,160,18
5260 DATA 18,18,18,18,18,18,167,132,48,136
5270 DATA 32,90,38,239,134,0,167,132,167,136
5280 DATA 32,57,23,255,178,48,31,49,141,1
5290 DATA 38,141,198,22,255,129,65,24,60,102
5300 DATA 102,126,102,102,66,124,102,102,124,102
5310 DATA 102,124,67,60,102,96,96,96,102,60
5320 DATA 68,120,108,102,102,102,108,120,69,126
5330 DATA 96,96,124,96,96,126,70,126,96,96
5340 DATA 124,96,96,96,71,60,102,96,96,110
5350 DATA 102,60,72,102,102,102,126,102,102,102
5360 DATA 73,60,24,24,24,24,24,60,74,6
5370 DATA 6,6,6,6,102,60,75,102,102,108
5380 DATA 120,108,102,102,76,96,96,96,96,96
5390 DATA 96,126,77,102,126,126,102,102,102,102
5400 DATA 78,102,118,126,126,110,102,102,79,126
5410 DATA 102,102,102,102,102,126,80,124,102,102
5420 DATA 124,96,96,96,81,60,102,102,102,118
5430 DATA 108,58,82,124,102,102,124,108,102,102
5440 DATA 83,60,102,96,60,6,102,60,84,126
5450 DATA 24,24,24,24,24,24,85,102,102,102
5460 DATA 102,102,102,60,86,102,102,102,102,102
5470 DATA 60,24,87,102,102,102,102,126,126,102
5480 DATA 88,102,102,60,24,60,102,102,89,102
5490 DATA 102,60,24,24,24,24,90,126,6,12
5500 DATA 24,48,96,126,48,60,102,110,126,118
5510 DATA 102,60,49,24,56,24,24,24,24,60
5520 DATA 50,60,102,6,12,24,48,126,51,60
5530 DATA 102,6,28,6,102,60,52,14,30,54
5540 DATA 102,126,6,6,53,126,96,124,6,6
5550 DATA 102,60,54,60,102,96,124,102,102,60
5560 DATA 55,126,6,6,12,24,48,96,56,60
5570 DATA 102,102,60,102,102,60,57,60,102,102
5580 DATA 62,6,102,60,32,0,0,0,0,0
5590 DATA 0,0,37,48,74,52,8,44,82,12
5600 DATA 39,24,24,24,0,0,0,0,42,16
5610 DATA 84,56,56,84,16,0,58,0,24,24
5620 DATA 0,24,24,0,63,60,102,6,12,24
5630 DATA 0,24,45,0,0,0,126,0,0,0
5640 DATA 46,0,0,0,0,0,96,96,44,0
5650 DATA 0,0,0,8,24,48,97,48,72,120
5660 DATA 72,72,98,112,72,112,72,112,99,48
5670 DATA 72,64,72,48,100,112,40,40,40,112
5680 DATA 101,120,64,120,64,120,102,120,64,120
5690 DATA 64,64,103,48,72,64,88,48,104,72
5700 DATA 72,120,72,72,105,112,32,32,32,112
5710 DATA 106,8,8,8,72,48,107,72,80,96
5720 DATA 80,72,108,64,64,64,64,120,109,68
5730 DATA 108,84,68,68,110,72,104,88,72,72
5740 DATA 111,120,72,72,72,120,112,112,72,112
5750 DATA 64,64,113,48,72,72,88,52,114,112
5760 DATA 72,112,80,72,115,56,64,48,8,112
5770 DATA 116,124,16,16,16,16,117,72,72,72
5780 DATA 72,120,118,68,68,68,40,16,119,68
5790 DATA 68,68,84,108,120,68,40,16,40,68
5800 DATA 121,68,40,16,16,16,122,124,8,16
5810 DATA 32,124,47,48,72,72,72,48,33,16
5820 DATA 48,16,16,56,34,48,72,16,32,120
5830 DATA 35,48,72,16,72,48,36,24,40,120
5840 DATA 8,8,61,120,96,16,72,48,38,48
5850 DATA 64,112,72,48,43,120,8,8,16,32
5860 DATA 40,48,72,48,72,48,41,48,72,40
5870 DATA 8,48,18,198,5,231,141,253,145,23
5880 DATA 253,121,198,7,231,141,253,136,198,3
5890 DATA 57
6000 PMODE4,1:PCLS1:COLOR 0,1
6010 Y=191-RND(20)
6015 DRAW"BM0,191;"
6020 FOR X=5 TO 255 STEP 10
6030 Y=Y-RND(20)*(RND(4)-2)
6035 IF Y>190 THEN Y=190 ELSE IF Y<70 THEN Y=70:Y=Y+RND(60)
6040 LINE-(X,Y),PSET
6050 NEXT
6060 PAINT(128,191),0,0
6070 LINE(0,0)-(255,191),PSET,B
6080 PRINT@108,"LUNAR":PRINT@144,"RESCUE":PRINT@239,"BY":PRINT@330,"CLYDE JOHNSON"
6090 PRINT@483,"PRESS FIRE BUTTON TO BEGIN"
6100 SCREEN1,1
6110 IF PEEK(&HFF00) AND 1 THEN 6110
6120 IF (PEEK(&HFF00) AND 1)-1 THEN 6120
6130 RETURN
7000 FOR PA=1 TO 4:PCOPY PA TO PA+4:NEXT:PMODE4,5:SCREEN1,1:RETURN
