0 'THE DUPLICATOR COPYRIGHT (C)    1988 BY MARC CAMPBELL           COPYRIGHT 1989  FALSOFT, INC
1 POKE&H71,&H0:POKE&HF8,&H32:POKE&HF9,&H62:POKE&HFA,&H1C:POKE&HFB,&HAF:POKE&HFC,&H7E:POKE&HFD,&HAD:POKE&HFE,&HA5:POKE&H19A,&H39:POKE&H19B,&H0:POKE&H19C,&HF8:POKE&H19A,&H7E:FORQ=1TO2:NEXT
2 VERIFYON:CLS:PCLEAR8:A=0:B=4:PRINTSTRING$(32,128)TAB(9)"THE DUPLICATOR":PRINT"   FLOPPY DISK BACKUP UTILITY":PRINT"(C) MCMLXXXVIII BY MARC CAMPBELL"STRING$(32,128)
3 POKE&HA56A,&HB1:PRINT@192,"":PRINT@192,"SOURCE DRIVE (0-3)? ";:GOSUB16:SD=INT(VAL(A$)):IFSD<0ORSD>3THEN3ELSEPRINTSD
4 PRINT@224,"":PRINT@224,"DESTINATION DRIVE (0-3)? ";:GOSUB16:DD=INT(VAL(A$)):IFDD<0ORDD>3THEN4ELSEPRINTDD:PRINT:PRINTSTRING$(32,128):POKE&HA56A,&HC1
5 IFSD<>DD THENPRINT@453,"PRESS ANY KEY TO BEGIN":GOSUB16
6 FORP=1TO7:IFSD=DD THENPRINT@453,"INSERT SOURCE DISKETTE":GOSUB16
7 POKE234,2:POKE235,SD:X=3584:FORT=A TO B:FORS=1TO18:POKE236,T:POKE237,S:M=INT(X/256):N=X-M*256:POKE238,M:POKE239,N:X=X+256:IFX=15872THENX=21504
8 PRINT@352,"READING TRACK"T"SECTOR"S:EXEC55135:IFPEEK(240)=0THENNEXTS,T ELSEGOSUB14:NEXTS,T
9 IFSD=DD THENPRINT@452," INSERT DESTINATION DISK":GOSUB16
10 POKE234,3:POKE235,DD:Y=3584:FORT=A TO B:FORS=1TO18:POKE236,T:POKE237,S:M=INT(Y/256):N=Y-M*256:POKE238,M:POKE239,N:Y=Y+256:IFY=15872THENY=21504
11 PRINT@384,"WRITING TRACK"T"SECTOR"S:EXEC55135:IFPEEK(240)=0THENNEXTS,T ELSEGOSUB14:NEXTS,T
12 A=B+1:B=A+4:NEXTP
13 PRINT@448,"DISK IS BACKED UP; ANOTHER (Y/N)";:GOSUB16:IFA$="Y"ORA$="y"THENRUNELSEEXEC40999
14 PRINT@448,"":IFPEEK(240)=128THENPRINT@455,"INPUT/OUTPUT ERROR"ELSEIFPEEK(240)=64THENPRINT@454,"WRITE-PROTECTED DISK"ELSEPRINT@458,"SYSTEM ERROR"
15 PRINT@483,"(1) CONTINUE OR (2) RESTART";:GOSUB16:IFA$="1"THENPRINT@483,STRING$(27,32);:RETURNELSERUN
16 A$=INKEY$:IFA$=""THEN16ELSEIFA$=CHR$(3)THEN17ELSERETURN
17 POKE&HA56A,&HC1:PRINT@448,"":PRINT@452,"(1) RESTART OR (2) QUIT?":GOSUB16:IFA$="1"THENRUNELSEEXEC40999
