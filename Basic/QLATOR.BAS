1 REM***************************
2 REM*      CO CO Q-LATOR      *
3 REM*   KEYBOARD CALCULATOR   *
4 REM*     BY FRED B.SCERBO    *
5 REM*    COPYRIGHT (C) 1988   *
6 REM*      6O HARDING AVE     *
7 REM*   NORTH ADAMS,MA 01247  *
8 REM***************************
9 CLEAR2000
10 CLS0:PRINTSTRING$(64,188);
15 FORI=1TO 256 :READ A:PRINTCHR$(A+128);:NEXT
20 PRINTSTRING$(32,188);
25 PRINT@390," KEYBOARD CALCULATOR ";:PRINT@422,"  BY FRED B. SCERBO  ";:PRINT@454," COPYRIGHT  (C) 1988 ";
30 DATA30,28,26,30,28,26,37,44,44,44,45,32,32,100,110,96,96,101,108,108,106,110,109,108,106,110,108,109,101,108,108,109
35 DATA26,,16,26,,26,37,32,,,37,,32,,106,96,,101,,96,106,104,101,96,104,106,96,101,101,96,,101
40 DATA27,19,26,27,19,26,37,32,,,37,,32,16,106,96,,101,,96,106,96,101,,96,106,96,101,101,96,96,101
45 DATA19,19,18,19,19,18,37,32,,,37,68,76,64,106,96,,101,108,108,106,96,101,,96,106,96,101,101,108,109,108
50 DATA26,,24,26,,26,37,32,35,32,37,,32,,106,96,,101,,96,106,96,101,,96,106,96,101,101,96,100,106
55 DATA26,,18,26,,26,37,32,36,43,37,,32,,106,96,97,101,96,96,106,96,101,,96,106,96,101,101,96,,109
60 DATA28,28,24,28,28,24,36,44,44,44,47,32,32,100,108,108,108,100,96,96,104,96,108,104,96,108,108,108,100,104,96,100
65 DATA60,60,60,60,60,60,60,60,60,,36,40,,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60
70 X$=INKEY$:IFX$<>CHR$(13)THEN70
75 DIM S$(5),A$(11),A(9),B(9),N$(11)
80 FORI=0TO11:READA$(I):NEXT:FORI=1TO5:READS$(I):NEXT:FORI=0TO9:READA(I),B(I):NEXT
85 DATA U12L12D12NR12BL6,BL6U12NG2D12BL10,L12U6R12U6L12BD12BL6,NL12U6NL12U6L12BD12BL6,U12D6L12NU6BD6BL6,NL12U6L12U6NR12BD12BL6
90 DATA NU6L12U6NR12U6NR12D12BL6,U12L12D2BD10BL6,U12L12D6NR12D6NR12BL6,NL12U6NL12U6L12D6BD6BL6,BL6NL4U2L4D2BL8,BU6L12BD6BL6,BU6R12,BU6R6NU6ND6R6,E6NH6NE6F6,BU6R6NR8BU4NR2BD8R2,"BU10M+4,+10U10R12"
95 DATA 10,153,10,118,58,118,106,118,10,83,58,83,106,83,10,48,58,48,106,48
100 PMODE0,1:PCLS1:SCREEN1,1:PMODE0,4:PCLS0
105 LINE(10,8)-(244,42),PSET,BF
110 FORI=0TO230STEP48
115 FORY=0TO120STEP35
120 LINE(12+I,50+Y)-(48+I,76+Y),PSET,B:NEXTY,I
125 LINE(156,155)-(242,181),PSET,BF
130 FORI=158TO230STEP48:FORY=54TO126STEP35
135 PAINT(0+I,0+Y),1,1
140 NEXTY,I
145 PAINT(136,175),1,1
150 DRAW"BM160,172C0NR8U6NR8U6R8BR4ND12F12U12BR4R4ND12R4BR4NR8D6NR8D6R8BR4U12R8D6L8R2F6BR6BU4NR10BU4R10"
155 DRAW"BM160,140E8NF8NH8NE8BF10BR4BU6F4NE4NF4NG4BE10BR12R8NR10BU4NR2BD8R2BR10BD2R8D8L8R2U8"
160 DRAW"BM168,96NU10ND10NL10R10BD4BR4R8D4L8U4D8BE12BR14R18BR2BD4ND8F4E4D8"
165 DRAW"BM160,66NR10U12R10BR6D12R8BG4BL2NR4D4R4BR4NU4R4"
170 DRAW"BM208,66NR10U12R10BR6NR8D6NR8D6R8BG4D4R6U4"
175 DRAW"BM138,160L20D10M-4,-10BF10BR6R8G8R8"
180 DRAW"BM36,172C1"+A$(0)
185 DRAW"BM36,138"+A$(1)
190 DRAW"BM84,138"+A$(2)
195 DRAW"BM132,138"+A$(3)
200 DRAW"BM36,103"+A$(4)
205 DRAW"BM84,103"+A$(5)
210 DRAW"BM132,103"+A$(6)
215 DRAW"BM36,68"+A$(7)
220 DRAW"BM84,68"+A$(8)
225 DRAW"BM132,68"+A$(9)
230 DRAW"BM76,172R4U2L4"
235 PCOPY4TO1:PCOPY4TO3
240 PMODE0,1:DRAW"BM230,30C0"+A$(0):PMODE0,4
245 F$="":S$="":AN$="":D=0:E=0:GS=0:R=0:FORP=1TO10
250 GOSUB540
255 IFX$=CHR$(12)THEN235
260 N$(P)=CHR$(48+X)
265 DRAW"BM230,30C0"
270 FORQ=P TO 1STEP-1
275 PMODE0,3:QQ=ASC(N$(Q))-48:DRAW"C0"+ A$(QQ):NEXTQ:PCOPY3TO1
280 PCOPY4TO3
285 IFR>0THEN295
290 NEXTP:P=P-1:IFP=10THEN GS=1:GOSUB540
295 GOSUB700
300 FORI=1TOP:IF ASC(N$(I))=58THEN N$(I)="."
305 IF ASC(N$(I))=59THEN N$(I)="-"
310 F$=F$+N$(I):NEXTI
315 IF R=5 THEN 400
320 GOSUB700
325 D=0:E=0:FORP=1TO10
330 PCOPY4TO3:PMODE0,3
335 GOSUB635
340 IFX$=CHR$(12)THEN235
345 IFX$="U"THEN:PCOPY4TO1:PMODE0,1:DRAW"BM230,30C0"+A$(0):GOTO325
350 N$(P)=CHR$(48+X)
355 IFX$=CHR$(13)THEN385
360 DRAW"BM230,30C0"
365 FORQ=P TO 1STEP-1
370 PMODE0,3:QQ=ASC(N$(Q))-48:DRAW"C0"+ A$(QQ):NEXTQ:PCOPY3TO1
375 PCOPY4TO3
380 NEXTP
385 PCOPY4TO1:P=P-1:FORI=1TOP:IF ASC(N$(I))=58THEN N$(I)="."
390 IF ASC(N$(I))=59THEN N$(I)="-"
395 S$=S$+N$(I):NEXTI
400 F=VAL(F$):S=VAL(S$)
405 IF R=1 THEN AN=F-S:GOTO435
410 IF R=2 THEN AN=F+S:GOTO435
415 IF R=3 THEN AN=F*S:GOTO435
420 IF R=4 AND S=0 THEN 705
425 IF R=4 THEN AN=F/S
430 IF R=5 THEN AN=SQR(F)
435 PCOPY4TO3
440 AN$=STR$(AN):IF AN=>0 THEN P=LEN(AN$)-1:AN$=RIGHT$(AN$,P):ELSE P=LEN(AN$)
445 IF P>10THEN705
450 DRAW"BM230,30"
455 FORQ=P TO 1STEP-1
460 PMODE0,3:QQ=ASC(MID$(AN$,Q,1))-48:IF QQ=-2THENQQ=10
465 IF QQ=-3THENQQ=11
470 IFQQ=21THEN705
475 IFQQ=-5THEN705
480 DRAW"C0"+A$(QQ):NEXTQ:PCOPY3TO1
485 FORI=1TO10:N$(I)="":NEXT
490 F$=AN$:S$="":F=0:S=0
495 X$=INKEY$:IFX$=""THEN495
500 IFX$=CHR$(12)THEN235
505 IFX$="U"THEN235
510 IFX$="M"THEN R=1:GOTO320
515 IFX$="P"THEN R=2:GOTO320
520 IFX$="X"THEN R=3:GOTO320
525 IFX$="D"THEN R=4:GOTO320
530 IFX$="Z"THEN R=5:GOTO400
535 GOTO495
540 X$=INKEY$:IFX$=""THEN540
545 IFP=1THEN585
550 IFX$="M"THEN R=1:P=P-1:RETURN
555 IFX$="P"THEN R=2:P=P-1:RETURN
560 IFX$="X"THEN R=3:P=P-1:RETURN
565 IFX$="D"THEN R=4:P=P-1:RETURN
570 IFX$="Z"THEN R=5:P=P-1:RETURN
575 IFE=1THEN585
580 IFX$="-"AND P=1 THEN X=11:E=1:RETURN
585 IFX$=CHR$(12)THENRETURN
590 IF GS=1THEN540
595 IFD=1 AND X$="."THEN540
600 IFX$="."THEN X=10:D=1:RETURN
605 XX=ASC(X$):XX=XX-48
610 IFXX<0THEN540
615 IFXX>9THEN540
620 X=XX
625 PMODE0,1:LINE(A(X),B(X))-(A(X)+40,B(X)+30),PSET,B:PLAY"P36":LINE-(A(X),B(X)),PRESET,B:PMODE0,3
630 RETURN
635 X$=INKEY$:IFX$=""THEN635
640 IFX$=CHR$(12)THENRETURN
645 IFX$="U"THENRETURN
650 IFE=1THEN660
655 IFX$="-"AND P=1 THEN X=11:E=1:RETURN
660 IFD=1 AND X$="."THEN540
665 IFX$="."THEN X=10:D=1:RETURN
670 X=ASC(X$):X=X-48
675 IFX$=CHR$(13)THENRETURN
680 IFX<0THEN635
685 IFX>9THEN635
690 PMODE0,1:LINE(A(X),B(X))-(A(X)+40,B(X)+30),PSET,B:PLAY"P32":LINE-(A(X),B(X)),PRESET,B:PMODE0,3
695 RETURN
700 PMODE0,1:DRAW"BM24,30C0"+S$(R):RETURN
705 PMODE0,1:DRAW"BM56,30C0U12R12D12NL12BR6BU12M+6,+12M+6,-12BR6NR12D6NR12D6R12BR6U12R12D6L12R6F6BR6U6NR12U6R12BR6D12R12BR6U12R12D12NL12BR6NU12R6NU6R6U12"
710 X$=INKEY$:IFX$=""THEN710
715 IFX$=CHR$(12)THEN235
720 IFX$="U"THEN235
725 GOTO710
