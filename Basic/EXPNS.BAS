5  '*********EXPNS**********
10 '*********V1.01**********        ************************
15 '*****COPYRIGHT 1985*****        **BY LARRY ANDERSON*****
20 CLEAR5000:DIMA$(150),B$(150),C$(150)
25 Z$=CHR$(128):V$=STRING$(8,128)+"@escapes"+Z$+"to"+Z$+"menu"+STRING$(7,128)
30 U$="r e m e m b e r"+STRING$(17,128)
35 W$="<--LAST"+STRING$(5,128)+"Exit"+STRING$(5,128)+"NEXT-->"
40 GOTO430
45 CLS3:PRINT@0,U$;:PRINT@24,N$:PRINT@480,V$;:PRINT@233,Z$+Z$+"records"+Z$+"for"+Z$+Z$;:PRINT@265,Z$+"which"+Z$+"vehicle"+Z$;:POKE1535,128
50 PRINT@332,"        ";:PRINT@332,"";:LINEINPUT N1$:PRINT@340,STRING$(12,175);:IFN1$=""THEN65ELSEIFN1$="@"THEN70
55 TEMP$=N$:N$=N1$
60 ON A GOTO480,480,405
65 IFN$<>""THENN1$="":PRINT@332,N$;:ONA GOTO505,505,295:GOTO45
70 CLS3:PRINT@0,U$;:PRINT@24,N$:PRINT@200,"Review";CHR$(128);"items";:PRINT@264,"Update";CHR$(128);"items";:PRINT@328,"Main";CHR$(128);"menu";STRING$(3,128);
75 F1$="DATE- ":F2$="AMOUNT- $":F3$="DETAILS- "
80 GOSUB555
85 B$="RUM":A=INSTR(B$,A$)
90 ONA GOTO45,45,405:GOTO80
95 '*****
100 CLS3:PRINT@0,U$;:PRINT@24,N$
105 PRINT@232,"Add"+Z$+"records";STRING$(3,128);
110 PRINT@296,"Remove"+Z$+"records";
120 GOSUB555
125 B$="AR@":W=INSTR(B$,A$)
130 CLS:ONW GOTO140,210,70:GOTO120
135 '*****
140 RC=RC+1
145 CLS:PRINTU$+STRING$(3,128);:PRINT@19," ADD# ";RC
150 PRINT@32,STRING$(3,143);:PRINT@48-LEN(N$)/2,N$
155 PRINT@480,STRING$(11,128);"@"+Z$+"escapes";STRING$(11,128);:POKE1535,128:PRINT@64,"";
160 PRINTF1$;:LINEINPUTA$(RC)
165 IFA$(RC)="@"THENA$(RC)="":GOTO290
170 PRINTF2$;:LINEINPUTB$(RC)
175 IFB$(RC)="@"THENB$(RC)="":A$(RC)="":GOTO290
180 PRINTF3$;:LINEINPUTC$(RC)
185 IFC$(RC)="@"THENC$(RC)="":A$(RC)="":B$(RC)="":GOTO290
190 PRINT@480,STRING$(5,128);"ok"+Z$+"to"+Z$+"enter"+Z$+"Yes No";STRING$(8,128);:POKE1524,47:POKE1535,128
195 GOSUB555
200 B$="YN":W=INSTR(B$,A$)
205 ONW GOTO135,145:GOTO195
210 CLS(7):PRINT@0,U$;:PRINT@480,V$;:POKE1535,128
215 PRINT@32,"record"+Z$+"removal";STRING$(4,128);
220 PRINT@50,"REC.#:";:LINEINPUTQ$
225 IFQ$="@" THEN 70ELSE230
230 Q=VAL(Q$):IFQ>RC OR Q<1THEN210
235 PRINT@64,F1$;A$(Q):PRINTF2$;B$(Q):PRINTF3$;C$(Q)
240 PRINT@480,STRING$(6,128);"remove";STRING$(4,128);"Yes"+Z$+"or"+Z$+"No";STRING$(6,128);:POKE1535,128
245 GOSUB555
250 B$="YN@":W=INSTR(B$,A$)
255 ONW GOTO260,210,70:GOTO245
260 A$(Q)=A$(0):B$(Q)=B$(0):C$(Q)=C$(0)
265 FORN=Q TO RCD
270 A$(N)=A$(N+1):B$(N)=B$(N+1):C$(N)=C$(N+1)
275 NEXTN
280 RCD=RCD-1:IF RCD<1THENRCD=0
285 GOTO295
290 RC=RC-1
295 CLS0:L1=LEN(N$)/2:C=207-L1:PRINT@171," SAVING  ";:PRINT@203,"         ";:PRINT@C,N$;:PRINT@235,"DATA FILE";
300 PRINT@299,RCD;"RECORDS";
305 OPEN"O",#1,N$+"/DTL"
310 FORQ=1TO 150:IFA$(Q)=""THEN325
315 WRITE#1,A$(Q),B$(Q),C$(Q)
320 NEXTQ
325 CLOSE#1
330 GOTO70
335 '*****
340 CLS3:FORQ=1TO RC
345 CLS:PRINT@0,U$:PRINT@15,STRING$(5,128);Q"OF"RC:PRINT@80-LEN(N$)/2,N$
350 PRINT:PRINTF1$;A$(Q)
355 PRINTF2$;B$(Q)
360 PRINTF3$;C$(Q)
365 PRINT@482,W$;
370 GOSUB555
375 IFASC(A$)=9THEN395
380 IFA$="E"THEN70
385 IFASC(A$)=8THENQ=Q-1:IFQ<1THENQ=RC
390 GOTO345
395 CLS3:NEXTQ
400 GOTO340
405 OPEN"O",#1,"CRNT/NDX"
410 WRITE#1,N$
415 CLOSE#1
420 LOAD"MAIN",R
425 '*****
430 OPEN"I",#1,"VEH/NDX"
435 FORQ=1TO5:INPUT#1,N$(Q)
440 IFEOF(1)=-1THEN450
445 NEXTQ
450 CLOSE#1
455 OPEN"I",#1,"CRNT/NDX"
460 INPUT#1,N$
465 CLOSE#1
470 GOTO70
475 '*****
480 FOR N=1TO5:IFN$(N)=N$ THEN500
485 IFN$(N)="" THENCLS3:PRINT@0,U$;:PRINT@260,"NO VEHICLE BY THAT NAME";:SOUND200,5:SOUND150,10:FORT=1TO300:NEXT T:N$=TEMP$:GOTO45
490 NEXT N
495 CLS3:PRINT@260,"NO VEHICLE BY THAT NAME";:SOUND200,5:SOUND150,10:FORT=1TO300:NEXTT:TEMP$=N$:GOTO45
500 ONA GOTO505,505,405
505 IFN1$=""ANDA$(1)<>""THEN550ELSEFORQ=1TO150:A$(Q)="":B$(Q)="":C$(Q)="":NEXTQ
510 OPEN"I",#1,N$+"/DTL"
515 FORQ=1TO150
520 IFEOF(1)=-1THEN540
525 INPUT#1,A$(Q),B$(Q),C$(Q)
530 IFA$(Q)=""THEN540
535 NEXTQ
540 RC=Q-1
545 CLOSE #1
550 ONA GOTO335,95,295
555 A$=INKEY$:IFA$=""THEN555ELSERETURN
