1 '****************************
2 '*      THE BLUE VOID       *
3 '*   COPYRIGHT (C)  1987    *
4 '*   BY  GAY D. CRAWFORD    *
5 '****************************
6 '
10 CLEAR400
20 DIM A(216),WY(64),D1(16),N$(9)
30 RGB:POKE &HFFD9,0:HSCREEN2
40 CLS:B=44:GOSUB1480
50 HDRAW"BM13,13C5G12R122E12L122"
60 HPAINT(15,14),5,5
70 HDRAW"BM14,14C1G10R118E10L118"
80 HPAINT(32,16),1,1
90 ONBRKGOTO2500:ONERRGOTO2500
100 FORL=1 TO 216:A(L)=0:NEXTL
110 HCOLOR0
120 HPRINT(2,2),"The Blue Void"
130 FORL=1 TO 64:WY(L)=L:NEXTL
140 FORJ=1 TO 4
150 FORK=1 TO 4
160 FORL=1 TO 4
170 A(B)=1:B=B+1:NEXTL
180 B=B+2:NEXTK:B=B+12:NEXTJ
190 HCOLOR1
200 HPRINT(1,23),"Copyright (c)                     1987"
210 FORL=1TO 16:READ D1(L):NEXTL
220 A$="by Gay Crawford":Y=3
230 FORL=1 TO LEN(A$)
240 H$=MID$(A$,L,1)
250 HPRINT(38,Y),H$:Y=Y+1
260 NEXTL
270 N$(0)="L3G4R3E4"
280 N$(4)="G2NG2L3E2"
290 N$(1)="BL2LRG4"
300 N$(2)="NL3G2L3G2R3"
310 N$(3)="NL3G2NL2G2L3"
320 N$(5)="L3G2R3G2L3"
330 N$(6)="BL3G4R3E2L3"
340 N$(7)="BL3R3G4"
350 N$(8)="L3G4R3E2NL3E2"
360 N$(9)="BG4E4L3G2R3"
370 P$="L120G40R40ND5R80E40D46"
380 E$="C0L16G8DR15D6RE8U6"
390 DP$="L16G8ND2R16D6NLE8U6"
400 DW$="L16G8D6R16E8U6"
410 HDRAW"BM292,12C1XP$;XP$;XP$;L120G40R120E40"
420 'lay tiles
430 FORL=1TO63:BN=L:GOSUB2310
440 F=INT(S/16)+3
450 H$="BM"+STR$(X)+","+STR$(Y)
460 GOSUB1810
470 NEXT
480 HPRINT(2,6),"The object of"
490 HPRINT(1,7),"the game is to"
500 HPRINT(1,8),"unscramble the"
510 HPRINT(1,9),"colored tiles."
520 HPRINT(2,11),"Use the arrow"
530 HPRINT(1,12),"keys, as  well"
540 HPRINT(1,13),"as the F1 & F2"
550 HPRINT(1,14),"to move a tile"
560 HPRINT(1,15),"into the empty"
570 HPRINT(1,16),"space, or the"
580 HPRINT(1,17),"Blue Void."
590 L=1
600 IFINKEY$<>""THEN620
610 L=L+1:IFL=1000 THEN620 ELSE600
620 HCOLOR0:HLINE(0,32)-(128,144),PSET,BF
630 'start to play
640 HCOLOR9:B=173:VP=64:LM=0:SV=0
650 HPRINT(1,7),"How many tiles"
660 HPRINT(1,8),"would you like"
670 HPRINT(1,9),"scrambled?"
680 HCOLOR1:X=7:S$=""
690 I$=INKEY$:IFI$=""THEN690
700 IFI$=CHR$(13) THEN 800
710 IFI$=CHR$(8) THEN 770
720 IFI$<"0"ORI$>"9"THEN690
730 IFX>9 THEN690
740 S$=S$+I$
750 HCOLOR1:HPRINT(X,11),I$
760 X=X+1:GOTO690
770 IFLEN(S$)=0 THEN S$="" ELSES$=LEFT$(S$,(LEN(S$)-1)):X=X-1
780 HCOLOR0:HLINE(X*8,87)-(X*8+7,95),PSET,BF
790 GOTO690
800 IFVAL(S$)<1 THEN620
810 SS=VAL(S$):HCOLOR0
820 HLINE(8,56)-(118,96),PSET,BF
830 FORSL=1TOSS
840 R=RND(6)
850 ONR GOSUB1660,1670,1680,1690,1700,1710
860 IF A(B+V)=0 THEN 840
870 IF WY(VP+M)=LM THEN 840
880 GOSUB1550
890 NEXTSL
900 HDRAW"BM58,68C9R8U16L16D16R8D16R8D16L8D16R8D16L32U16R8NR16U16L8U16R8U16R8"
910 HPAINT(50,71),10,9
920 HPAINT(38,119),2,9
930 HPAINT(56,56),8,9
940 HDRAW"BM58,84C9L8NL8D16NL8NR8BD16D16"
950 HDRAW"BM50,73C9NG2NF2D6BD13BL4L6NE2NF2BR14R6NH2NG2BL10BD13D6NH2NE2"
960 HDRAW"BM40,126C9U2NR2U2R2BR2RD4BR10U2NR2U2R2BR2R2D2L2D2R2"
970 HPRINT(9,7),"Quit"
980 HPRINT(8,9),"Backward"
990 HPRINT(0,11),"Left     Right"
1000 HPRINT(8,13),"Forward"
1010 HPRINT(2,15),"Up     Down"
1020 'make moves
1030 K$=CHR$(10)+CHR$(8)+CHR$(94)+CHR$(9)+CHR$(4)+CHR$(103)
1040 ONBRK GOTO1230
1050 I$=INKEY$:IFI$=""THEN1050
1060 K=INSTR(K$,I$)
1070 IFK=0 THEN1050
1080 ONK GOSUB1660,1670,1680,1690,1700,1710
1090 IF A(B+V)=0 THENSOUND120,1:GOTO1050
1100 GOSUB1550
1110 WC=64
1120 IFWY(WC)<>WC THEN GOTO1050
1130 WC=WC-1:IF WC=0 THEN 1140 ELSE 1120
1140 HCOLOR8:SV=1
1150 HPRINT(1,5),"Congratulations"
1160 ONBRKGOTO2500
1170 FORL=1TO12
1180 FORK=3TO6:PALETTEK,RND(63)
1190 PLAY"L16T16O4CG":NEXTK,L
1200 GOSUB1480:HCOLOR0
1210 HLINE(0,50)-(128,132),PSET,BF
1220 HCOLOR9
1230 HCOLOR0:HLINE(0,40)-(126,132),PSET,BF
1240 HCOLOR9
1250 HPRINT(1,7),"Would you like"
1260 HPRINT(1,8),"to play another"
1270 HPRINT(1,9),"game?  (Y/N)"
1280 I$=INKEY$:IFI$=""THEN1280
1290 IFI$="N"THENGOTO2500
1300 IFI$<>"Y"THEN1280
1310 'reset tiles
1320 HCOLOR0:HLINE(8,40)-(126,80),PSET,BF
1330 IFSV=1 THEN640
1340 IFWY(64)=64 THEN1370
1350 L=64:GOSUB2310
1360 GOSUB2100:WY(64)=64
1370 FORL=63 TO 1 STEP-1
1380 IFWY(L)<>L THENGOSUB1400
1390 NEXTL:GOTO640
1400 BN=L:GOSUB2310
1410 F=S/16+3:WY(L)=L
1420 H$="BM"+STR$(X)+","+STR$(Y)
1430 V=0:R=D1(D)
1440 ON R GOSUB 1730,1730,1810,1730,1730,1810
1450 RETURN
1460 'end of main routine
1470 'subroutines
1480 PALETTE0,29:PALETTE1,8
1490 PALETTE2,63:PALETTE3,38
1500 PALETTE4,43:PALETTE5,52
1510 PALETTE6,16:PALETTE7,63
1520 PALETTE8,36:PALETTE10,62
1530 PALETTE9,0:RETURN
1540 'swap tile
1550 WY(VP)=WY(VP+M):BN=WY(VP):LM=WY(VP):B=B+V
1560 L=VP+M:GOSUB2310:R=D1(D)
1570 F=HPOINT(X-1,Y+2)'get color
1580 ON R GOSUB1870,1920,1970,2020,2070,2100'erase & recnstr
1590 L=VP:GOSUB2310:R=D1(D)
1600 H$="BM"+STR$(X)+","+STR$(Y)
1610 ON R GOSUB 1730,1730,1810,1730,1730,1810'draw whl or partl
1620 PLAY"L16T16O4AB"
1630 VP=VP+M:WY(VP)=64
1640 RETURN
1650 'pick a direction
1660 V=-1:M=-1:RETURN
1670 V=6:M=4:RETURN
1680 V=1:M=1:RETURN
1690 V=-6:M=-4:RETURN
1700 V=-36:M=-16:RETURN
1710 V=36:M=16:RETURN
1720 'draw partial tile
1730 IF V=1 THEN GOSUB1810:RETURN
1740 HDRAW"XH$;C7XDP$;"
1750 HPAINT(X-2,Y+2),F,7
1760 HDRAW"XH$;C2XDP$;G8"
1770 HPAINT(X-9,Y+13),F,2
1780 GOSUB2400
1790 RETURN
1800 'draw whole tile
1810 HDRAW"XH$;C7XDW$;"
1820 HPAINT(X-4,Y+2),F,7
1830 HDRAW"XH$;C2XDW$;G8NL16D6"
1840 GOSUB2400
1850 RETURN
1860 'rear left corner d=1
1870 GOSUB2130
1880 H$="BM"+STR$(X+1)+","+STR$(Y+5)
1890 IF L=1 THEN HDRAW"XH$;C1L19G4" ELSE HDRAW"XH$;C1L19NU5G4"
1900 RETURN
1910 'side tile d=2
1920 GOSUB2130:IF V<>1 THENGOSUB2240
1930 H$="BM"+STR$(X)+","+STR$(Y)
1940 IF V=-1 THEN HDRAW"XH$;C1BL13BG2G9" ELSE HDRAW"XH$;C1BL13BG2G7"
1950 RETURN
1960 'front left corner d=3
1970 GOSUB2190:GOSUB2240
1980 H$="BM"+STR$(X+1)+","+STR$(Y+2)
1990 IF V=1 THEN HDRAW"XH$;C1BL16NE2G10" ELSE HDRAW"XH$;C1BL16G10"
2000 RETURN
2010 'rear tile d=4
2020 GOSUB2130
2030 H$="BM"+STR$(X+1)+","+STR$(Y+5)
2040 HDRAW"XH$;C1L22"
2050 RETURN
2060 'middle tile d=5
2070 GOSUB2130:GOSUB2240
2080 RETURN
2090 'front tile d=6
2100 GOSUB2190:GOSUB2240
2110 RETURN
2120 'erase partial tile
2130 IF V=-1 THEN GOSUB2190:RETURN
2140 H$="BM"+STR$(X)+","+STR$(Y)
2150 HDRAW"XH$;XE$;"
2160 HPAINT(X-2,Y+2),0,0
2170 RETURN
2180 'erase whole tile
2190 H$="BM"+STR$(X)+","+STR$(Y)
2200 HDRAW"XH$;C0L16G8D6R16E8U6"
2210 HPAINT(X-2,Y+2),0,0
2220 RETURN
2230 'redraw rear tile
2240 IF V=1 THEN RETURN
2250 C=HPOINT(X-2,Y-3)
2260 H$="BM"+STR$(X+2)+","+STR$(Y-1)
2270 HDRAW"XH$;C2D5L16U5"
2280 HPAINT(X,Y),C,2
2290 RETURN
2300 'calculate x,y for each tile
2310 S=L-1
2320 X1=(S/4-INT(S/4))*-40+190
2330 X2=INT(((S/16)-INT(S/16))*4)
2340 X2=X2*32:X=X1+X2
2350 Y1=(S/4-INT(S/4))*40+7
2360 Y2=INT(S/16):Y=Y1+(Y2*46)
2370 D=((S/16-INT(S/16))*16)+1
2380 RETURN
2390 'draw numbers
2400 L$=STR$(BN):DL=LEN(L$)-1
2410 D=VAL(RIGHT$(L$,1))
2420 D$=N$(D)
2430 HDRAW"XH$;C9BL6BD2XD$;"
2440 D$=MID$(L$,DL,1)
2450 IFD$=" "THEN2480 ELSE D=VAL(D$)
2460 D$=N$(D)
2470 HDRAW"XH$;C9BL12BD2XD$;"
2480 RETURN
2490 DATA 1,2,2,3,4,5,5,6,4,5,5,6,4,5,5,6
2500 WIDTH40:HSCREEN0
2510 POKE&HFFD8,0:CLS0
2520 LOCATE9,10
2530 ATTR 1,0
2540 PRINT"Thanks for playing"
2550 LOCATE12,12
2560 PRINT"The Blue Void"
2570 FORL=1TO2000:NEXTL:WIDTH32:RGB
