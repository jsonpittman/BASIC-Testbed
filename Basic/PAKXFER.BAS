10 WIDTH 32
20 PMODE 0:PCLEAR1:CLEAR 200,16000
30 CLS
40 PRINT STRING$(32,"*");
50 PRINT "COCO 3 ROM FIX AND ROM PATCH"
60 PRINT "BY DAVID LIONELL DAWSON"
70 PRINT "COCO 1/2 CODE BY R. ESPOSITO"
80 PRINT STRING$(32,"*")
90 PRINT:PRINT
100 PRINT "MODE:"
110 PRINT "  A:PATCH 'ROMFIXED' DISK FILE"
120 PRINT "  B:PATCH ROM CODE ON TAPE"
130 INPUT "*****WHICH";A$
140 IF A$<>"A" AND A$<>"B" THEN 100
150 IF A$="B" THEN 220
160 INPUT "DISK FILE NAME";FA$
170 LOADM FA$
180 IF PEEK(&H3F9A)<>&H0F THEN CLS:PRINT"SORRY NOT CORRECT FORMAT":END
190 GOSUB 300:'ADD PATCH
200 INPUT "SAVE <A>8K OR <B>16K ON DISK";A$:IF A$="A" THEN SAVEM FA$,16200,24577,16200 ELSE SAVEM FA$,16200,32751,16200
210 PRINT:PRINT"PATCHED VERSION ON DISK":END
220 INPUT "TAPE FILE NAME";FA$
230 CLOADM FA$,&H8000
240 GOSUB 300:'COCO3 PATCH
250 GOSUB 410:'COCO1&2 PATCH
260 INPUT"DISK FILE NAME";FA$:FA$=LEFT$(FA$,8)
270 INPUT "SAVE <A> 8K OR <B> 16K";A$:IF A$="A" THEN SAVEM FA$,16200,24577,16200 ELSE SAVEM FA$,16200,32751,16200
280 END
290 'COCO3 PATCH
300 FOR I=&H3F48 TO &H3F6A
310 READ A$
320 POKE I,VAL("&H"+A$)
330 NEXT I
340 DATA B6,80,FD,81,32,27,03,7E
350 DATA 3F,9A,1A,50,86,7A,B7,FF
360 DATA A6,86,7B,B7,FF,A7,86,70
370 DATA B7,FF,A2,86,71,B7,FF,A3
380 DATA 7E,C0,00
390 RETURN
400 'COCO1/2 PATCH
410 FOR I=&H3F9A TO &H3FFE
420 READ A$
430 POKE I,VAL("&H"+A$)
440 NEXT I
450 DATA 0F,71,1A,50,8E,80,0,A6,84,B7,FF,DF,A7,80
460 DATA B7,FF,DE,8C,C0,0,26,F1,B7,FF,DF,86,7E,B7
470 DATA A0,51,CC,A0,72,FD,A0,52,CC,8E,9F,FD,A0,84
480 DATA CC,FE,7E,FD,A0,86,CC,A0,93,FD,A0,88,7F,80
490 DATA 00,0F,71,86,7E,B7,A0,CB,CC,3F,E3,FD,A0,CC
500 DATA 7E,A0,27,CC,C0,00,97,45,CC,DF,FF,DD,41,CC
510 DATA 40,00,DD,47,CC,5F,FF,DD,43,BD,AC,20,1C,AF
520 DATA 7E,C0,00
530 RETURN
