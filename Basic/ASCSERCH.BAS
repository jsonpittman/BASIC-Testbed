0 'ASCSERCH.BAS
1 '*****************************
2 '**   ASCII   FILE SEARCH   **
3 '**   VERSION 2.0  APR/88   **
4 '**   BY:  STEPHEN MILLER   **
5 '**  (C) 1989  FALSOFT,INC  **
6 '*****************************   
11 CLEAR20,&H7F00:CLEAR5000:DIMZ$(20):CLS:PRINTTAB(6)"ASCII PROGRAM SEARCH":D$=INKEY$
12 PRINT@64,"PRINTER (Y/N) ? ";:D$=INKEY$:IFD$=""THEN12ELSEIFD$="Y"THENPRINT"YES":D=-2ELSEPRINT"NO":D=0
13 PRINT:LINEINPUT" FILENAME.EXT OF 'ASC' PROGRAM:  ";N$:IFN$=""THENFORT=1TO12:N$=N$+CHR$(PEEK(&H7F00+T)):NEXT:PRINT@161,N$:GOTO16
14 A=A+1:IFMID$(N$,A,1)<>"."THEN14ELSEN1$=LEFT$(N$,A-1):N2$=RIGHT$(N$,3)
15 IFLEN(N1$)<8THENN1$=N1$+" ":GOTO15ELSEN$=N1$+"."+N2$:FORT=1TO12:POKE&H7F00+T,ASC(MID$(N$,T,1)):NEXT
16 PRINT@224,"";:LINEINPUT"ENTER TARGET LETTERS (WORDS)    >";T$:L=LEN(T$):IFL<1THEN16
17 PRINT@320,"DO YOU WANT 'PAUSE' (Y/N) ? ";:P$=INKEY$:IFP$=""THEN17ELSEIFP$="Y"THENPRINT"YES"ELSEPRINT"NO"
18 IFD$="Y"THENPRINT#D,"ASCII FILESEARCH":PRINT#D,"SEARCHING FOR ";CHR$(34)T$CHR$(34):PRINT#D,"FILENAME:- "N$
19 OPEN"I",#1,N$
20 LINEINPUT#1,A$:NT=NT+1:CLS:PRINTA$
21 FORT=1TOLEN(A$):IFMID$(A$,T,L)=T$THENSOUND225,2:GOSUB25:GOSUB26:TN=TN+1:IFLEN(Z$(W))>200THENW=W+1:IFTN>1000THENPRINT"THERE ARE FAR TOO MANY OCCURANCEOF "CHR$(34)T$;CHR$(34)" TO CONTINUE.":GOTO23
22 NEXT:IFEOF(1)THEN23ELSE20
23 CLOSE#1:PRINT"<<finished>>":PRINT#D:PRINT#D,"YOUR PROGRAM USES"NT-1"LINES":PRINT#D,"THERE WERE"TN"OCCURANCES":PRINT#D,"IN LINES ";:FORT=0TOW:IFT=1THENPRINT"  <ENTER> TO LIST MORE...":EXEC44539:NEXTELSEPRINT#D,Z$(T):NEXT
24 PRINT"OF "CHR$(34)T$CHR$(34):PRINT"IN YOUR "N$" PROGRAM":PRINT"  <L>IST AGAIN   OR   <R>UN";:EXEC44539:N$=CHR$(PEEK(135)):IFN$="L"THEN23ELSERUN
25 FORR=1TO6:Y$=MID$(A$,R,1):IFY$=" "THEN Z$(W)=Z$(W)+",":RETURNELSEZ$(W)=Z$(W)+Y$:NEXT:RETURN
26 IFP$="Y"THENPOKE1024+(T-1),ASC(LEFT$(T$,1)):FORV=1TO50:NEXT:IFINKEY$=""THENPOKE1024+(T-1),(ASC(LEFT$(T$,1))-64):FORV=1TO50:NEXT:IFINKEY$=""THEN26
27 RETURN:ENDend
