0 '*****************************
1 '       < HURRTRAK >
2 '
3 '            BY
4 '     H. G. WILLIAMSON
5 '    67 PLANTATION ROAD
6 '  MYRTLE BEACH, SC 29577
7 '    COPYRIGHT OCT 1986
8 '*****************************
9 'POKE149,0:POKE150,18:'2400BAUD
10 GOTO 640
15 CLS6:DIM D$(25,5),D1(25),D2(25):R=57.29577951
20 TM=3550:MH=60:U=-1:DEFUSR0=31913:'PRINT MAP
25 PRINT@160," ENTER NAME OF HURRICANE":PRINT" ";:LINEINPUTHN$:PRINT:PRINT" ENTER DATE  [MM/DD/YR]":PRINT@302,"";:LINEINPUTDA$
30 SOUND150,1:CLS:PRINTTAB(5)"** INSTRUCTIONS **":PRINT:PRINT"  1. LINES 20,530,540 MUST BE":PRINT"     EDITED FOR YOUR PRINTER":PRINT"     AND SCREEN DUMP PROGRAM.":PRINT"  2. WHEN MAP IS DISPLAYED"
35 PRINT"     TYPE THE LETTER IN THE":PRINT"     PARENTHESES TO:":PRINT"       (U)PDATE DATA":PRINT"       (P)RINT MAP":PRINT"       (R)EVIEW DATA ENTERED":PRINT"       (I)DENTIFY LANDMARK":PRINT"       (Q)UIT":PRINT:PRINT"   **** PRESS ANY KEY ****"
40 GOSUB655:GOSUB210
45 TIMER=0
50 A$=INKEY$
55 CIRCLE(X,Y),4,0,.8:CIRCLE(X,Y),8,0,.8:IF A$<>""THEN425
60 FORT=1TO20:NEXT
65 CIRCLE(X,Y),4,1,.8:CIRCLE(X,Y),8,1,.8
70 IFTIMER>TM THENMI=MI+1:IFMI<MH THEN45ELSEMI=0:GOSUB155:GOSUB115:GOTO45
75 FORT=1TO200:NEXT:GOTO50
80 '
85 '** ADJUST MIN  **
90 MI=MI+INT(TIMER/3550+.5):PMODE4,1:SCREEN1,1:GOTO45
95 '
100 '****** SUBROUTINES *******
105 '
110 '*** UPDATE HOUR ***
115 H=VAL(HR$)+1:MI$="00":IFH=25THENH=1
120 H$=STR$(H):IFH<10 THEN HR$="0"+RIGHT$(H$,1)ELSE HR$=RIGHT$(H$,2)
125 U$(1)=HR$+MI$
130 X$=STR$(INT(10*(100-(X/5)))/10):U$(2)=RIGHT$(X$,LEN(X$)-1)
135 X$=STR$(INT(10*(40-(Y/5)))/10):U$(3)=RIGHT$(X$,LEN(X$)-1):X$=""
140 B=20:X$="":UD=1:FORN=1TO3:D$=U$(N):GOSUB310:NEXTN:UD=0
145 '
150 '*** MOVE EYE/HR ***
155 SOUND150,1:SOUND150,1
160 IF X<1 OR Y<1 THEN 175 ELSE X=X+COS(AN/R)*(S/13):Y=Y+SIN(AN/R)*(S/13)
165 IFX>200ORX<1ORY>150ORY<1THEN180
170 RETURN
175 IFX<1THENX=1ELSEIFY<1THENY=1
180 CIRCLE(X,Y),4,0:CIRCLE(X,Y),8,0
185 '
190 '*** END TRAP ***
195 SOUND150,1:FORT=1TO100:NEXT:GOTO195
200 '
205 '**  INPUT DATA  **
210 CLS:U=U+1:PRINT@32,"HURRICANE NAME: ";HN$:PRINT"DATE          : ";DA$:SOUND150,1:LINEINPUT" TIME  <2400> : ";D$(U,0):HR$=LEFT$(D$(U,0),2):MI=VAL(RIGHT$(D$(U,0),2)):TI=MI:L=4
215 L=L+1:SOUND150,1:LINEINPUT" W LONGITUDE  : ";D$(U,1):X=VAL(D$(U,1)):IFX>99ORX<55THEN215ELSEX=5*(100-X):D1(U)=X:XD=X
220 L=L+1:SOUND150,1:LINEINPUT" N LATITUDE   : ";D$(U,2):Y=VAL(D$(U,2)):IFY>39ORY<10THEN220ELSEY=5*(40-Y):D2(U)=Y:YD=Y
225 GX=0:FORN=0TO15:PRINT@(GX*32)+27,C$(N);:GX=GX+1:NEXT:PRINT@256,"";
230 PRINT@32*L,"";:SOUND150,1:LINEINPUT" DIRECTION    : ";D$(U,3):FORN=27TO507STEP32:PRINT@N,"   ";:NEXT:PRINT@32*(L+1),"";
235 FORN=0TO15:IFC$(N)=D$(U,3)THENAN=270-(N*22.5):GOTO245
240 NEXTN:D$(U,3)="UNK":AN=225
245 SOUND150,1:LINEINPUT" SPEED    MPH : ";D$(U,4):S=VAL(D$(U,4)):IFS=0THENS=1
250 SOUND150,1:LINEINPUT" WINDS    MPH : ";D$(U,5)
255 SOUND150,1:PRINT"    <E>RROR ?"
260 X$=INKEY$:IFX$=""THEN260ELSEIFX$="E"THENCLS:GOTO210
265 CLS1:X$=STR$(S*24):MD$=RIGHT$(X$,LEN(X$)-1):X$=""
270 '
275 '*** TRACK FROM START ***
280 PMODE4,5:SCREEN1,1:IF U>0 THEN COLOR0:FORN=0TOU-1:LINE(D1(N),D2(N))-(D1(N+1),D2(N+1)),PSET:CIRCLE(D1(N),D2(N)),3,0:NEXTN:CIRCLE(D1(N+1),D2(N+1)),3,0
285 PMODE4,1:PCLS1:SCREEN1,1:FORN=1 TO 4: PCOPY N+4 TO N:NEXT
290 '
295 '*** DRAW DATA ***
300 PMODE4,1:SCREEN1,1:B=20:X$=""
305 FORN=0TO5:D$=D$(U,N)
310 L=LEN(D$)
315 IFVAL(D$)>0THEN345
320 FORZ=1TOL
325 Z$=MID$(D$,Z,1)
330 FORQ=1TO26:IFMID$(W$,Q,1)=Z$THENX$=X$+L$(Q):GOTO340
335 NEXTQ
340 NEXTZ:GOTO355
345 FORZ=1TOL:Z$=MID$(D$,Z,1):IFZ$="."THENW=10ELSE W=VAL(Z$)
350 X$=X$+N$(W):NEXTZ
355 COLOR1:LINE(214,B-7)-(248,B+1),PSET,BF:COLOR0:DRAW"S4C0BM220,"+STR$(B)+X$:X$="":B=B+24:X$=""
360 IF UD=1 THEN RETURN
365 NEXTN:DRAW"C0BM220,164":FOR N=1 TO LEN(MD$):DRAW N$(VAL(MID$(MD$,N,1))):NEXT N
370 '
375 '*** PREDICT COURSE ***
380 D=6:DD=D
385 FORCR=AN+22.5TOAN-22.5STEP-22.5:IFAN=CR THENKJ=8ELSEKJ=5
390 FORN=1TOKJ:PSET(XD,YD,CL):A=INT(COS(CR/R)*DD)+XD:B=INT(SIN(CR/R)*DD)+YD
395 IFA<0ORB<0THEN155
400 PSET(A,B,CL):DD=DD+D
405 NEXT N:DD=D:NEXTCR:IFCL=0THEN RETURN ELSE CL=0:GOTO380
410 '
415 '
420 '*** SCREEN OPTIONS ***
425 IFA$="R"THEN475
430 IFA$="P" AND PM=1 THEN 540 ELSE IF A$="P" THEN PM=1:GOTO530
435 IFA$="I"GOSUB555:GOSUB380:GOTO90
440 IFA$="U"THEN GOSUB210:GOTO90
445 IFA$<>"Q"THEN65
450 CLS:T=0:PRINT@71,"READY TO SHUT DOWN":PRINT@99,"SELECT ONE OR MORE NUMBERS":PRINT:PRINT"   0. RETURN":PRINT"   1. PRINT WEATH/BULL DATA":PRINT"   2. PRINT LANDMARKS":PRINT"   3. PRINT MAP":PRINT"   4. RECORD ON TAPE":PRINT"   5. SHUT DOWN"
455 A$=INKEY$:IFA$=""THEN455ELSEQT=VAL(A$):IF A$="0"THEN 90 ELSE IF QT>5 THEN 455
460 ON QT GOSUB 505,530,540,625,195:GOTO 450
465 '
470 '*** REVIEW ***
475 CLS:PRINT"HURRICANE "+HN$:PRINT"DATE: ";DA$:PRINT"TIME  LONG LAT   DIR  VEL  WIND"
480 FOR N=0 TO U
485 PRINTD$(N,0)TAB(6)D$(N,2);TAB(11)D$(N,2);TAB(17)D$(N,3);TAB(22)D$(N,4);TAB(27)D$(N,5)
490 NEXT:PRINT:PRINT"PRINT COPY? <Y/N>"
495 A$=INKEY$:IFA$=""THEN495ELSECLS:IFA$<>"Y"THEN90
500 '
505 PRINT#-2,TAB(10)"HURRICANE "+HN$+"    DATE: "+DA$
510 PRINT#-2,TAB(10)"TIME";TAB(20)"LONG";TAB(30)"LAT";TAB(40)"DIR";TAB(50)"VEL";TAB(60)"WINDS"
515 FORN=0TOU:FORM=0TO5:PRINT#-2,TAB(M*10+10)D$(N,M);:NEXTM:PRINT#-2:NEXTN:PRINT#-2,TAB(10)"** END **":PRINT#-2:IF QT>0 THEN RETURN ELSE GOTO90
520 '
525 '*** PRINT MAP ***
530 PRINT#-2,CHR$(27)CHR$(14)TAB(15)"LANDMARKS";CHR$(27)CHR$(15):PRINT#-2:FORT=27TO60STEP33:PRINT#-2,TAB(T)"LONG  LAT";:NEXT:PRINT#-2:FORN=1TO113STEP8:C=(N+7)/8:X$(1)=I$(C):X$(2)=I$(C+15):Y$(1)=MID$(LC$,N,8):Y$(2)=MID$(LC$,N+120,8)
535 A=10:FORZ=1TO2:PRINT#-2,TAB(A)X$(Z)TAB(A+17)LEFT$(Y$(Z),4)TAB(A+23)RIGHT$(Y$(Z),4);:A=A+33:NEXTZ:PRINT#-2:NEXTN:IFQT>0THENRETURN
540 PRINT#-2,CHR$(18):POKE32431,255:P=USR(0):PRINT#-2,CHR$(30):FORN=1TO10:PRINT#-2:NEXT:IF QT>0THEN RETURN ELSE GOTO90
545 '
550 '*** IDENT ***
555 LO$="BABEBIBRCACOCUDOGAGCGRHAHOJAJMKEMIMOMYNANENINOPEPUSATATRWIYU"
560 CLS1:K$="":FORN=1TO29STEP2:PRINTI$(N),I$(N+1):NEXT
565 IFJ>0THENCOLOR1:LINE(IX,IY)-(I,J),PSET
570 A$=INKEY$:IFA$=""THEN570ELSEIFASC(A$)=13THEN90
575 K$=K$+A$:IFLEN(K$)<2THEN570
580 CLS1:FORN=1TO59STEP2:Z$=MID$(LO$,N,2):Q=(N+1)/2:IFZ$=K$THENGOTO 590
585 NEXT:IFK$=""THEN90ELSE560
590 P$=MID$(LC$,(8*Q)-7,8):I=VAL(LEFT$(P$,4)):J=VAL(RIGHT$(P$,4)):P$=""
595 I=5*(100-I):J=5*(40-J)
600 SCREEN1,1:COLOR0:LINE(I,J)-(X,Y),PSET:IX=X:IY=Y:DX=ABS(I-X):DY=ABS(J-Y):H=SQR(DX^2+DY^2):V=11.3*H:C$=STR$(INT(V)):L=LEN(C$):C$=RIGHT$(C$,L-1):L=L-1:LX$=C$:GOSUB380
605 COLOR1:LINE(130,8)-(210,26),PSET,BF:DRAW"C0BM130,15":FORZ=1TOL:DRAWN$(VAL(MID$(C$,Z,1))):NEXT:DRAW"BR3"+L$(13)+L$(9)+"BR6"
610 LC=INT(VAL(LX$)/S+.5):LX$=STR$(LC):L=LEN(LX$)-1:LX$=RIGHT$(LX$,L):Y$="":FORZ=1TOL:DRAW N$(VAL(MID$(LX$,Z,1))):NEXT:DRAW"BR3"+L$(8):N=ASC(LEFT$(K$,1))-64:W=ASC(RIGHT$(K$,1))-64:DRAW"C0BM155,25"+L$(N)+L$(W):RETURN
615 '
620 '**  RECORD ON TAPE  **
625 CLS:PRINT@160," READY TO SAVE ON TAPE ":PRINT" PRESS ANY KEY WHEN READY":EXEC44539
630 OPEN"O",#1,"HURRDATA":WRITE#1,U:FORN=0TOU:WRITE#1,D1(N),D2(N):FORW=0TO5:WRITE#1,D$(N,W):NEXTW,N:CLOSE#1:RETURN
635 '
640 CLEAR650:PCLEAR8:GOTO 15
645 '
650 '*** LETTERS ***
655 DIML$(28):FORN=1TO28:READL$(N):NEXT
660 DATA U4E2F2D2L4R4D2BR3
665 DATA U6R3F1D1G1L3R3F1D1G1L3BR7
670 DATA BR4 BU1G1L2H1U4E1R2F1BD5BR3
675 DATA U6L1R4F1D4G1L4BR8
680 DATA BR4L4U3R3L3U3R4BD6BR3
685 DATA U3R3L3U3R4BD6BR3
690 DATA BE4BU1H1L2G1D4F1R2E1U2L1R2BD3BR3
695 DATA U6D3R4U3D6BR3
700 DATA U6BR3BD6
705 DATA BU1F1R2E1U5BR3BD6
710 DATA U6D4E4G3F3BR3
715 DATA U6D6R4BR3
720 DATA U6D1F3E3U1D6BR3
725 DATA U6F5U5D6BR3
730 DATA BR1H1U4E1R2F1D4G1L2BR6
735 DATA U6R3F1D2G1L3BR7BD2
740 DATA BR1H1U4E1R2F1D4G1H1F2H1L2BR6BD1
745 DATA U6R3F1D2G1L3R2F2BR3
750 DATA BU1F1R2E1U1H1L2H1U1E1R2F1BD5BR3
755 DATA BR2U6L2R4BD6BR3
760 DATA BU6D5F1R2E1U5BR3BD6
765 DATA BU6D4F2E2U4BR3BD6
770 DATA BU6D5F1R1E1U5D5F1R1E1U5BR3BD6
775 DATA U1E4U1BL4D1F4D1BR3
780 DATA BU6D2F2D2U2E2U2BR3BD6
785 DATA BU6R4D1G4D1R4BR3
790 DATA BR1H1U4E1BD6BR3
795 DATA E1U4H1BR5BD6
800 '***** NUMBERS
805 DIMN$(10):FORN=0TO10:READN$(N):NEXT
810 DATA BR1H1U4E1R2F1D4G1L2BR6
815 DATA BU5E1D6BR3
820 DATA BU4U1E1R2F1D1G4R4BR3
825 DATA BU6R4G2L1R2F1D2G1L2H1BD1BR7
830 DATA BR4U6G4R5BD2BR3
835 DATA BU1F1R2E1U2H1L3U2R4BD6BR3
840 DATA BE4BU1H1L2G1D4F1R2E1U1H1L2G1BD2BR7
845 DATA BR1U1E4U1L5BD6BR8
850 DATA BE3E1U1H1L2G1D1F1R2F1D1G1L2H1U1E1BD3BR6
855 DATA BU1F1R2E1U4H1L2G1D1F1R2E1BD4BR3
860 DATA U1R1D1BR3
865 '
870 '***** TITLES
875 DIMT$(12):FORN=1TO12:READT$(N):NEXT
880 DATA 20091305,12151407,120120,040918,1916050504,2309140419,131604,2721281604012005,2718280522090523,27092804051420,27162818091420,271728210920
885 '
890 '***** DIRECTIONS
895 DIMC$(15):FORN=0TO15:READC$(N):NEXT
900 DATA N,NNW,NW,WNW,W,WSW,SW,SSW,S,SSE,SE,ESE,E,ENE,NE,NNE
905 '
910 '***** LOCATE ID
915 DIM I$(30):FORN=1TO30:READI$(N):NEXT
920 DATA (BA)RBADOS,(BE)RMUDA,(BI)LOXI,(BR)OWNSVILLE,(CA)PE HATTERAS,(CO)RPUS CHR,(CU)BA,(DO)M REPUBLIC,(GA)LVESTON,(GC)AYMEN IS,(GR)ANADA,(HA)ITI,(HO)NDURAS,(JA)CKSONVILLE,(JM)AICA
925 DATA (KE)Y WEST,(MI)AMI,(MO)BILE,(MY)RTLE BEACH,(NA)SSAU,(NE)W ORLEANS,(NI)CARAGUA,(NO)RFOLK,(PE)NSACOLA,(PU)ERTO RICO,(SA)VANNAH,(TA)MPA,(TR)INIDAD,(WI)LMINGTON,(YU)CATAN PEN
930 LC$="59.513.464.632.488.730.697.226.075.335.597.327.979.022.070.019.094.729.581.219.561.612.372.218.786.015.081.530.377.018.081.824.780.025.887.831.079.033.579.225.290.030.085.013.076.036.887.030.666.518.581.032.082.028.061.310.878.034.188.021.0
935 '***** W$ STRING
940 FORN=1TO28:READA$:W$=W$+A$:NEXTN
945 DATAA,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,[,]
950 '
955 '**  TEST SQUARES  **
960 EXEC44539:PMODE4,1:PCLS1:SCREEN1,1:Z$="2308090308XX0315121518":DRAW"C0BM95,80":FORN=1TO21STEP2:X$=MID$(Z$,N,2):X=VAL(X$):IFX=0THENL$(X)="BR8"
965 DRAWL$(X):NEXT:Z$="":COLOR0:LINE(115,90)-(125,100),PSET,B:POKE178,1:PAINT(120,95),,0:COLOR0:LINE(136,90)-(146,100),PSET,B:POKE178,2:PAINT(140,95),,0:DRAW"C0BM119,115"+N$(1):DRAW"C0BM+16,0"+N$(2):SOUND150,1
970 A$=INKEY$:IFA$=""THEN970ELSE PC=VAL(A$):IF PC<1 OR PC>2 THEN 970
975 '
980 '*** INPUT RECORDED DATA ***
985 CLS:PRINT@194,"INPUT SAVED DATA?  <Y/N>"
990 A$=INKEY$:IFA$=""THEN990ELSE IF A$="N"THEN 1015
1000 OPEN"I",#1,"HURRDATA":INPUT#1,U:FORN=0TOU:INPUT#1,D1(N),D2(N):FOR W=0 TO 5: INPUT#1,D$(N,W):NEXTW,N:CLOSE#1
1010 '**  DRAW MAP  **
1015 PMODE4,5:PCLS1:SCREEN1,1:COLOR0:IF RS=1 GOSUB280:RS=0:U=-1
1020 READA,B,C,D:LINE(A,B)-(C,D),PSET
1025 READC,D:IFC=0THEN1020ELSEIFC=-1THEN1030ELSELINE-(C,D),PSET:GOTO 1025
1030 FORN=1TO3:READA,B,C,D:LINE(A,B)-(C,D),PSET:NEXT
1035 POKE178,PC
1040 FORN=1TO7:READ C,D:PAINT(C,D),,0:NEXT:PSET(192,139,0)
1045 DATA130,0,126,5,125,5,125,4,123,2,123,4,125,7,122,15,121,15,121,8,120,8,120,3,119,3,119,13,120,17
1050 DATA121,20,111,25,111,30,108,30,100,35,95,40,94,46,94,50,96,54,98,58,100,65,100,74,99,74,96,75,93,71
1055 DATA92,71,88,62,89,60,87,61,87,56,81,50,75,52,70,48,62,48,61,46,61,48,55,48,50,47,49,48,55,50
1060 DATA53,53,56,54,55,55,52,54,50,55,45,52,37,51,32,51,26,53,20,56,14,61,14,70,13,89,20,105,30,110
1065 DATA42,106,43,107,45,106,44,105,48,102,48,97,51,95,57,94,63,93,66,92,67,94,67,95,64,100,60,115,59,117
1070 DATA59,119,61,120,80,120,82,121,85,125,85,127,83,131,83,145,85,150,95,154,103,151,109,152,115,161,117,162,120,160
1075 DATA122,159,124,146,126,143,132,143,140,137,143,136,144,137,143,139,141,141,142,145,140,150,142,152,143,152,144,149,142,146
1080 DATA143,144,152,141,158,143,161,146,170,146,173,149,180,145,189,145,189,146,185,147,195,151,195,155,198,156,200,155,203,160
1085 DATA205,165,0,0,0,114,2,115,20,120,27,118,33,120,40,125,45,130,50,130,60,134,61,133,63,134,61,135,71,143
1090 DATA71,148,75,151,76,150,74,148,82,154,82,155,98,159,100,159,103,157,104,157,105,158,113,165,0,0,176,38,177,38
1095 DATA177,39,176,39,176,38,0,0,78,90,81,85,90,83,100,85,104,88,106,88,115,91,120,93,122,95,125,96,128,97
1100 DATA128,98,130,98,125,100,124,99,105,100,113,99,115,97,109,95,108,93,106,94,102,92,95,90,90,88,92,87,88,87
1105 DATA83,89,82,88,79,91,78,90,0,0,93,103,95,103,95,104,93,104,93,103,0,0,107,108,116,107,119,109,119,110
1110 DATA110,110,107,109,107,108,0,0,129,107,137,107,136,102,133,101,137,107,136,102,133,101,137,100,150,100,153,104,155,105,159,107,158,108,152,107
1115 DATA149,109,147,107,143,111,140,111,140,109,130,109,129,107,0,0,164,106,170,106,172,107,172,108,169,109,164,109,164,106
1120 DATA 0,0,91,77,93,77,92,78,91,78,91,77,0,0,110,74,111,74,113,81,112,81,111,79,109,77,109,76,110,74
1125 DATA0,0,123,22,124,22,124,23,123,23,123,22,0,0,191,145,196,145,195,146,195,148,194,149,191,149,192,148,192,146
1130 DATA191,145,0,0,202,133,203,133,203,134,202,134,202,133,-1,-1,0,115,0,0,0,0,130,0,112,165,205,165,5,5,100,87,140,105,167,108,110,109,111,77,194,147
1135 '**  DRAW TITLES  **
1140 COLOR0:FORN=0TO144STEP24:LINE(212,N)-(250,N+24),PSET,B:NEXT
1145 B=10:X$="":FORN=1TO7
1150 L=LEN(T$(N))
1155 FORZ=1TOL-1STEP2
1160 Z$=MID$(T$(N),Z,2):W=VAL(Z$):X$=X$+L$(W)
1165 NEXTZ:DRAW"C0BM215,"+STR$(B)+X$:X$="":B=B+24:NEXTN
1170 DRAW"S4C0BM0,185":FORN=8TO12:X$="":L=LEN(T$(N)):FORZ=1TOL-1STEP2:Z$=MID$(T$(N),Z,2):W=VAL(Z$):X$=X$+L$(W):NEXTZ:X$=X$+"BR5":DRAW"C0BM+4,185"+X$:NEXTN:H$="082118180903011405":X$=""
1175 DRAW"S4C0BM0,150":FORN=1TO17STEP2:W=VAL(MID$(H$,N,2)):DRAWL$(W):NEXT
1180 DRAW"S8C0BM0,170":FORN=1TOLEN(HN$):N$=MID$(HN$,N,1):FORZ=1TO26:IFMID$(W$,Z,1)=N$THENDRAWL$(Z):GOTO1190
1185 NEXTZ
1190 NEXTN:FORT=1 TO 500:NEXT T:RETURN
1195 '
1200 'END*****
