5 ' tape doctor                    COPYRIGHT (C) 1985              BY MARK NELSON
9 CLS:PRINT:PRINT:PRINT"          tape doctor  ":PRINT:PRINT"      COPYRIGHT (C) 1985":PRINT"        BY MARK NELSON"
10 CLEAR 999
20 DATA 26,80,190,128,0,183,255,222,166,128,183,255,223,167,31,140,224,0,37,241,57
40 FOR I=1 TO 21:READ A:A$=A$+CHR$(A):NEXT I
50 P=VARPTR(A$)+1
60 POKE P,126
70 EXEC P
75 FOR X=0 TO 9:POKE &H9D00+X,PEEK(&HA7E9+X):NEXTX:'relocate motor off routine
80 POKE &HA7E9,&H7E:POKE&HA7EA,&H9D:POKE&HA7EB,&H00:'branch to reset counter on motor off
82 DATA 9F,76,9E,F3,86,9F,A7,80,9F,F3,9E,76,39:FORX=0 TO 12:READ R$:POKE&H9F00+X,(VAL("&H"+R$)):NEXT:'routine to put white square
85 POKE &H9E00,&H9F:POKE &H9E01,&H76:POKE &H9E02,&H9E:POKE &H9E03,&HF3:POKE &H9E04,&H86:POKE &H9E05,&H80:POKE &H9E06,&HA7:POKE &H9E07,&H80:POKE &H9E08,&H9F:POKE &H9E09,&HF3:POKE &H9E0A,&H9E:POKE &H9E0B,&H76:POKE &H9E0C,&H39:'black
86 POKE &HA740,4:POKE &HA745,&H7E:POKE&HA746,&H9F:POKE&HA747,0:POKE&HA741,&H7E:POKE&HA742,&H9E:POKE&HA743,0:' branch to routines to put square
88 POKE &H9D0A,&H8E:POKE&H9D0B,&H04:POKE&H9D0C,&HC0:POKE&H9D0D,&H9F:POKE &H9D0E,&HF3:POKE &H9D0F,&H39:'routine to reset counter on motor off
90 POKE &HF3,&H04:POKE &HF4,&HC0:POKE &HA531,&H12:POKE &HA532,&H12:POKE&HA4E3,&H12:POKE&HA434,&H12
1000 PRINT:PRINT"       THE DOCTOR IS in"
1010 NEW
1020 '      tape doctor                 COPYRIGHT (C) 1985                BY MARK NELSON
