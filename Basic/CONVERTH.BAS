10 CLEAR3000
20 WIDTH40:ATTRO,4:CLS:LOCATE16,6:PRINT"CONVERTH":LOCATE11,8:PRINT"BY H. ALLEN CURTIS":LOCATE13,9:PRINT"COPYRIGHT 1988
30 LOCATE5,12:PRINT"DO YOU NEED INSTRUCTIONS ABOUT":LOCATE5,13:PRINT"WHAT THIS PROGRAM DOES & WHAT":LOCATE5,14:PRINT"ITS REQUIREMENTS ARE?  (Y/N)":LOCATE7,16
40 K$=INKEY$:IFK$=""THEN40ELSEPRINTK$;:IFK$="N"THEN380ELSEIFK$<>"Y"THEN40
50 DIMA$(25)
60 A$(0)="   THIS PROGRAM CONVERTS A
70 A$(1)="WORD PROCESSOR FILE TO ANOTHER
80 A$(2)="DISK FILE WITH A STRUCTURE
90 A$(3)="COMPATIBLE WITH DESKTOPH
100 A$(4)="USAGE.
110 A$(5)="   THE WORD PROCESSOR FILE
120 A$(6)="MUST BE A "+CHR$(34)+"PURE"+CHR$(34)+" ASCII FILE:
130 A$(7)="NO IMBEDDED CODES, NO PRINTER
140 A$(8)="CODES, NO HYPHEN ENDING LINES,
150 A$(9)="AND NO CHARACTERS NOT IN THE
160 A$(10)="CHARACTER SET OF DESKTOPH.
170 A$(11)="   THE WORD PROCESSOR FILE
180 A$(12)="MUST ALSO BE MODIFIED AS
190 A$(13)="FOLLOWS:
200 A$(14)="1. YOU MUST APPEND THE
210 A$(15)="CHARACTER [ TO THE END OF ANY
220 A$(16)="LINE THAT ENDS WITH MORE
230 A$(17)="SPACES THAN THE NUMBER OF
240 A$(18)="CHARACTERS IN THE FIRST WORD
250 A$(19)="OF THE NEXT LINE IF THAT NEXT
260 A$(20)="LINE DOES NOT START WITH ONE
270 A$(21)="OR MORE SPACES.
280 A$(22)="2. YOU MUST APPEND THE
290 A$(23)="CHARACTER ] TO THE END OF THE
300 A$(24)="LAST LINE OF THE DOCUMENT.
310 WIDTH40:ATTR0,4
320 CLS:PRINT:PRINT:PRINT:PRINT:FOR I=0TO13
330 PRINT"    ";A$(I):NEXT:PRINT:PRINT:PRINT:PRINT"        ";:ATTR7,4,B:PRINT"HIT SPACE TO CONTINUE";:ATTR0,4
340 K$=INKEY$:IFK$=""THEN340
350 CLS:PRINT:PRINT:PRINT:PRINT:FORI=14TO24:PRINT"    ";A$(I):NEXT
360 ATTR7,4:LOCATE5,18:PRINT"DO YOU HAVE A SUITABLE FILE":LOCATE5,19:PRINT"READY? (Y/N)  ";:ATTR0,4
370 K$=INKEY$:IFK$=""THEN370ELSEIFK$="Y"THEN380ELSEEND
380 CLS:LOCATE5,9:PRINT"ENTER FILENAME OF ASCII FILE.":LOCATE5,10:PRINT"INCLUDE THE EXTENSION.":LOCATE12,12:LINEINPUTF$
390 N=INSTR(F$,"/"):IFN=0THEN380ELSEG$=LEFT$(F$,N)+"DAT"
400 IFRIGHT$(F$,3)="DAT"THENRENAMEF$ TO LEFT$(F$,N)+"TXT"
410 CLS:LOCATE15,10:PRINT"CONVERTING ";
420 OPEN"D",#1,F$:FIELD#1,128 AS A$,128 AS B$
430 OPEN"O",#2,G$
440 IFDONE=1THENCLOSE#1:PRINT".";:PRINT#2,Q$:CLOSE#2:PRINT:PRINT"                     DONE":ENDSTOPELSENO=NO+1:GET#1,NO:Q$=A$
450 M$="]":A=INSTR(A$,M$):B=INSTR(B$,M$):IFA>0 OR B>0THENDONE=1:IFB>0THENB$=LEFT$(B$,B-1)ELSEQ$=LEFT$(Q$,A-1):B$=""
460 N=INSTR(Q$,CHR$(13))
470 IFN>0THENGOSUB620:PRINT".";:Q$=RIGHT$(Q$,LEN(Q$)-N):IFQ$=""THENQ$=B$:GOTO530ELSE460
480 I=1
490 IFLEN(Q$)=I THENK=0:GOTO520
500 K=INSTR(LEN(Q$)+1-I,Q$," "):IFK=0THENI=I+1:GOTO490
510 PRINT#2,LEFT$(Q$,K-1):PRINT".";
520 Q$=RIGHT$(Q$,LEN(Q$)-K)+B$
530 N=INSTR(Q$,CHR$(13))
540 IFN>0THENGOSUB620:PRINT".";:Q$=RIGHT$(Q$,LEN(Q$)-N):IFQ$=""THEN440ELSE530
550 I=1
560 IFLEN(Q$)=I THENK=0:GOTO590
570 K=INSTR(LEN(Q$)+1-I,Q$," "):IFK=0THENI=I+1:GOTO560
580 PRINT#2,LEFT$(Q$,K-1):PRINT".";
590 Q$=RIGHT$(Q$,LEN(Q$)-K)
600 IFDONE=1THENCLOSE#1:PRINT".";:PRINT#2,Q$:CLOSE#2:PRINT:PRINT"                  DONE":ENDELSENO=NO+1:GET#1,NO:Q$=Q$+A$
610 GOTO450
620 IFLEFT$(Q$,N)=CHR$(13)THENPRINT#2," [":RETURNELSEPRINT#2,LEFT$(Q$,N-1):RETURN
